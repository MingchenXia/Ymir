\input{preamble}
\title{Ymir}
\begin{document}
\maketitle
\tableofcontents

\chapter*{Global properties of complex analytic spaces}\label{chap-CGlobalProperty}

\section{Introduction}\label{sec-introduction-CGlobalProperty}

\section{Topological properties of complex analytic spaces}

\begin{proposition}\label{prop-paracompactanalyticspace}
    Let $X$ be a Hausdorff complex analytic space. Then the following are equivalent:
    \begin{enumerate}
        \item $X$ is paracompact;
        \item Each connected component of $X$ is $\sigma$-compact;
        \item Each connected component of $X$ is LindelÃ¶f;
        \item $X$ admits a compact exhaustion.
    \end{enumerate}
\end{proposition}
\begin{proof}
    (1) $\Leftrightarrow$ (2): This follows from \cref{Topology-prop-paracptrefinement} in \nameref{Topology-chap-topology}.
    
    (2) $\Leftrightarrow$ (3): This follows from \cref{Topology-prop-qcptexhaustion} in \nameref{Topology-chap-topology}.

    (3) $\Leftrightarrow$ (4): This follows from \cref{Topology-prop-qcptexhaustion} in \nameref{Topology-chap-topology}.
\end{proof}

\begin{lemma}\label{lma-paracompactpropersurjimage}
    Let $f:X\rightarrow Y$ be a proper surjective morphism of complex analytic spaces. Then the following are equivalent:
    \begin{enumerate}
        \item $X$ is paracompact and Hausdorff;
        \item $Y$ is paracompact and Hausdorff.
    \end{enumerate}
\end{lemma}
\begin{proof}
    (1) $\implies$ (2): This follows from \cref{Topology-thm-Michael} in \nameref{Topology-chap-topology}.

    (2) $\implies$ (1): We may assume that $Y$ is connected. Then $X$ is Hausdorff as $f$ is separated. By \cref{prop-paracompactanalyticspace}, $Y$ is $\sigma$-compact. It follows that $X$ is also $\sigma$-compact. In particular, each connected component of $X$ is also $\sigma$-compact. In particular, $X$ is paracompact.
\end{proof}


\section{Holomorphically convex hulls}

\begin{definition}
    Let $X$ be a complex analytic space and $M$ be a subset of $X$, we define the \emph{holomorphically convex hull} of $M$ in $X$ as
    \[
        \hat{M}^X:=  \left\{ x\in X: |f(x)|\leq \sup_{y\in M}|f(y)|\text{ for all }f\in \mathcal{O}_X(X) \right\}.  
    \]
\end{definition}

\begin{proposition}\label{prop-convexhullprop}
    Let $X$ be a complex analytic space and $M$ be a subset of $X$. Then the following properties hold:
    \begin{enumerate}
        \item $\hat{M}^X$ is closed in $X$;
        \item $M\subseteq \hat{M}^X$ and $\widehat{\hat{M}^X}^X=\hat{M}^X$;
        \item If $M'$ is another subset of $X$ containing $M$, then $\hat{M}^X\subseteq \hat{M'}^X$;
        \item If $f:Y\rightarrow X$ is a morphism of complex analytic spaces, then
             \[ 
                \widehat{f^{-1}(M)}^Y\subseteq f^{-1}(\hat{M}^X);
             \]
        \item If $X'$ is another complex analytic space and $M'$ is a subset of $X'$, then
            \[
                \widehat{M\times M'}^{X\times X'}\subseteq \hat{M}^X\times \hat{M'}^{X'};  
            \]
        \item If $M'$ is another subset of $X$ and $\hat{M}^X=M$, $\hat{M'}^X=M'$, then
            \[
                \widehat{M\cap M'}^X=M\cap M'.    
            \]
    \end{enumerate}
\end{proposition}
\begin{proof}
    (1), (2), (3), (4), (5) are obvious by definition.

    (6) is a consequence of (3).
\end{proof}

\begin{example}\label{ex-tubeholhull}
    Let $Q$ be a compact cube in $\mathbb{C}^n$ for some $n\in \mathbb{N}$, then $\hat{Q}^{\mathbb{C}^n}=Q$.

    In fact, by \cref{prop-convexhullprop}(5), we may assume that $n=1$. Given $p\in \mathbb{C}\setminus Q$, we can take a closed disk $T\subseteq \mathbb{C}$ centered at $a\in \mathbb{C}$ such that $Q\subseteq T$ while $p\not\in T$. Consider $z-a\in \mathcal{O}_{\mathbb{C}}(\mathbb{C})$, then
    \[
        |f(p)|>\sup_{q\in Q}|f(q)|.  
    \]
    So $p\not\in \hat{Q}^{\mathbb{C}}$.
\end{example}

\section{Stones}

\begin{definition}\label{def-stone}
    Let $X$ be a complex analytic space. A \emph{stone} in $X$ is a pair $(P,\pi)$ consisting of 
    \begin{enumerate}
        \item a non-empty compact set $P$ in $X$ and
        \item a morphism $\pi:X\rightarrow \mathbb{C}^n$ for some $n \in \mathbb{N}$
    \end{enumerate}
    such that there is a compact tube $Q$ in $\mathbb{C}^n$ and an open set $W$ in $X$ such that $P=\pi^{-1}(Q)\cap W$.

    We call $P^0:=\pi^{-1}(\Int Q)\cap W$ the \emph{analytic interior} of the stone $(P,\pi)$. It clearly does not depend on the choice of $W$.
\end{definition}
We observe that $\hat{P}^X\cap W=P$. In fact, $P\subseteq \pi^{-1}(Q)$, so
\[
    \hat{P}^X\subseteq \pi^{-1}(\hat{Q}^{\mathbb{C}^n})=\pi^{-1}(Q)=P\cap W=P.  
\]
Here we applied \cref{prop-convexhullprop} and \cref{ex-tubeholhull}.

In general, $P^0\subseteq \Int P$, but they can be different.

\begin{thm}\label{thm-fixedcptsethullloccpt}
    Let $X$ be a Hausdorff complex analytic space and $K\subseteq X$ be a compact subset. Then the following are equivalent:
    \begin{enumerate}
        \item There is an open neighbourhood $W$ of $K$ in $X$ such that $\hat{K}^X\cap W$ is compact;
        \item There is an open relative compact neighbourhood $W$ of $K$ in $X$ such that $\partial W\cap \hat{K}=\emptyset$;
        \item There is a stone $(P,\pi)$ in $X$ with $K\subseteq P^0$.
    \end{enumerate}
\end{thm}
\begin{proof}
    (1) $\implies$ (2): This is trivial, in fact, we may assume that $W$ in (1) is relatively compact in $X$.

    (2) $\implies$ (3): As $\hat{K}^X$ is closed by \cref{prop-convexhullprop}(1) and $\partial W\cap \hat{K}^X=\emptyset$, given $p\in \partial W$, we can find $h\in \mathcal{O}_X(X)$ such that
    \[
        \sup_{x\in K}|h(x)|<1<|h(p)|.
    \]
    We will denote the left-hand side by $|h|_K$.
    Up to raising $h$ to a power, we may assume that 
    \[
        \max\{|\Real h(p)|,|\Imag h(p)| \}>1. 
    \]
    As $\partial W$ is compact, we can find finitely many sections $h_1,\ldots,h_m\in \mathcal{O}_X(X)$ so that
    \[
        \max_{j=1,\ldots,m} \{|\Real h_j|_K,|\Imag h_j|_K\}<1,\quad \max_{j=1,\ldots,m} \{|\Real h_j(p)|,|\Imag h_j(p)|\}>1.  
    \]
    Let 
    \[
        Q:=\left\{ (z_1,\ldots,z_m)\in \mathbb{C}^m: |\Real z_i|\leq 1, |\Imag z_i|\leq 1\text{ for all }i=1,\ldots,m \right\}.  
    \]
    The sections $h_1,\ldots,h_m$ defines a homomorphism $\pi:X\rightarrow \mathbb{C}^m$ by \cref{Complex-thm-hCnidentification} in \nameref{Complex-chap-complex}. Obviously, $P=\pi^{-1}(Q)\cap W$ satisfies our assumptions.

    (3) $\implies$ (1): Let $W$ be the open set as in \cref{def-stone}. As $\hat{P}^X\cap W=P$ and $K\subseteq P$, we have
    \[
        \hat{K}\cap W\subseteq P\cap W=P.  
    \]
    As $P$ is compact, so is $\hat{K}\cap W$.
\end{proof}

\begin{thm}\label{thm-stonelocallyproper}
    Let $X$ be a Hausdorff complex analytic space and $(P,\pi:X\rightarrow \mathbb{C}^n)$ be a stone in $X$. Let $Q$ be the tube in $\mathbb{C}^m$ as in \cref{def-stone}. Then there are open neighbourhoods $U$ and $V$ of $P$ and $Q$ in $X$ and $\mathbb{C}^n$ respectively with $\pi(U)\subseteq V$ and $P=\pi^{-1}(Q)\cap U$ such that $\pi|_U:U\rightarrow V$ is proper.
\end{thm}
%Recall that a map between topological spaces is quasi-proper if the inverse image of each quasi-compact set is quasi-compact.

\begin{proof}
    Let $W\subseteq X$ be the open set as in \cref{def-stone}. We may assume that $W$ is relatively compact. Then $\partial W$ and $\pi(\partial W)$ are also compact. As $\partial W\cap \pi^{-1}(Q)$ is empty, we know that $V:=\mathbb{C}^n\setminus \pi(\partial W)$ is an open neighbourhood of $Q$. The set $U:=W\cap \pi^{-1}(V)=W\setminus \pi^{-1}(\pi(\partial W))$ is open in $X$ and $\pi(U)\subseteq V$. Observe that $\pi|_U:U\rightarrow V$ is proper by \cref{Topology-lma-qcpttoHausdorffproper} in \nameref{Topology-chap-topology}.
    
    Furthermore,
    \[
        \pi^{-1}(Q)\cap U=\pi^{-1}(Q)\cap \left( W\setminus \left(\pi^{-1}(Q)\cap \pi^{-1}\pi(\partial W)\right) \right).  
    \]
    But $\pi^{-1}Q\cap \pi^{-1}\pi(\partial W)$ is empty as $Q\cap \pi(\partial W)$ is. It follows that $\pi^{-1}(Q)\cap U=P$ and hence $U$ is a neighbourhood of $P$.
\end{proof}

\begin{definition}
    Let $X$ be a complex analytic space.
    Let $(P,\pi:X\rightarrow \mathbb{C}^{n})$, $(P',\pi':X\rightarrow \mathbb{C}^{n'})$ be two stones on $X$. We say $(P,\pi)$ \emph{is contained in} $(P',\pi')$ if the following conditions are satisfied:
    \begin{enumerate}
        \item $P$ lies in the analytic interior of $P'$;
        \item $n'\geq n$ and there is $q\in \mathbb{C}^{n'-n}$ such that if $Q\subseteq \mathbb{C}^n$, $\mathbb{Q}'\subseteq \mathbb{C}^{n'}$ be the tubes as in \cref{def-stone}, then
            \[
                Q\times\{q\}\subseteq Q'.
            \]
        \item There is a morphism $\varphi:X\rightarrow \mathbb{C}^{n'-n}$ such that 
            \[
                \pi'=(\pi,\varphi).
            \]
    \end{enumerate}
    We formally write $(P,\pi)\subseteq (P',\pi')$ in this case. Clearly, this defines a partial order on the set of stones on $X$.
\end{definition}

\begin{definition}
    Let $X$ be a complex analytic space. An \emph{exhaustion of $X$ by stones} is a sequence $(P_i,\pi_i)_{i\in \mathbb{Z}_{>0}}$ of stones such that 
    \begin{enumerate}
        \item $(P_i,\pi_i)\subseteq (P_{i+1},\pi_{i+1})$ for all $i\in \mathbb{Z}_{>0}$;
        \item 
            \[
                X=\bigcup_{i=1}^{\infty} P_i^0.
            \]
    \end{enumerate}
    We say $X$ is \emph{weakly holomorphically convex} if it there is an exhaustion of $X$ by stones.
\end{definition}

\begin{thm}\label{thm-weaklyholconvchar}
    Let $X$ be a Hausdorff complex analytic space. Consider the following conditions:
    \begin{enumerate}
        \item $X$ is weakly holomorphically convex;
        \item For any compact subset $K\subseteq X$, there is an open set $W\subseteq X$ such that $\hat{K}^X\cap W$ is compact.
    \end{enumerate}
    Then (1) $\implies$ (2). If $X$ is paracompact, then (2) $\implies$ (1).
\end{thm}
\begin{proof}
    (1) $\implies$ (2): It suffices to observe that $K\subseteq P_j^0$ when $j$ is large enough and apply \cref{thm-fixedcptsethullloccpt}.

    Assume that $X$ is paracompact.
    (2) $\implies$ (1): 
    Let $(K_i)$ a compact exhaustion of $X$. We construcct the stones $(P_i,\pi_i)_{i\in \mathbb{Z}_{>0}}$ so that 
    \[
        K_i\subseteq P_i^0
    \] 
    for all $i\in \mathbb{Z}_{>0}$
    inductively. Let $P_1$ be an arbitrary stone in $X$ such that $K_1\subseteq P_1^0$. The existence of $P_1$ is guaranteed by \cref{thm-fixedcptsethullloccpt}.

    Assume that we have constructed $(P_{i-1},\pi_{i-1}:X\rightarrow  \mathbb{C}^{n_{i-1}})$ for $i\geq 2$. Let $Q_{i-1}\subseteq \mathbb{C}^{n_{i-1}}$ be the associated tube. By   \cref{thm-fixedcptsethullloccpt} again, take a stone $(P_i,\pi_i^*:X\rightarrow \mathbb{C}^n)$ with $K_i\cup P_{i-1}\subseteq P_i^0$. Let $Q_i^*\subseteq \mathbb{C}^n$ be the associated tube. Let $W$ be an open subset of $X$ with 
    \[
        P_i=\pi_i^{*,-1}(Q_i^*)\cap W.  
    \]
    Choose a tube $Q_i'\subseteq \mathbb{C}^{n_{i-1}}$ with $Q_{i-1}\subseteq \Int Q_i'$ so that 
    \[
        \pi_{i-1}(P_i)\subseteq \Int Q_i'.
    \]
    Let $\pi_i:=(\pi_{i-1},\pi_i^*):X\rightarrow \mathbb{C}^{n_{i-1}+n}$ and $Q_i:=Q_i'\times Q_i^*$. Then $(P_i,\pi_i)$ is a stone and $(P_{i-1},\pi_{i-1})\subseteq (P_i,\pi_i)$.
\end{proof}


\section{Holomorphical separable spaces}
\begin{definition}
    Let $X$ be a complex analytic space. We say $X$ is \emph{holomorphically separable} if for any $x,y\in X$ with $x\neq y$, there is $f\in \mathcal{O}_X(X)$ with $f(x)\neq f(y)$.
\end{definition}
Here we regard $f$ as a continuous function $X\rightarrow \mathbb{C}$. In particular, a holomorphically separable space is Hausdorff.


\iffalse
\begin{thm}[Grauert]
    Let $X$ be a holomorphically spreadable complex analytic space. Then there is $n\in \mathbb{N}$ a quasi-finite morphism $f:X\rightarrow \mathbb{C}^n$.
\end{thm}
\begin{proof}
    
\end{proof}
\fi


\begin{definition}
    Let $X$ be a complex analytic space. We say $X$ is \emph{holomorphically convex} if $|X|$ is Hausdorff and for any compact set $K\subseteq X$, $\hat{K}^X$.

    We say $X$ is \emph{weakly holomorphically convex} if for any quasi-compact set $K\subseteq X$, the connected components of $\hat{K}^X$ are all quasi-compact.
\end{definition}

\begin{proposition}
    Let $X$ be a holomorphically convex complex analytic space. Then $X^{\Red}$ is holomorphically convex.
\end{proposition}
\begin{proof}
    This follows immediately from the definition.
\end{proof}

\begin{proposition}\label{prop-holoconvchar}
    Let $X$ be a Hausdorff complex analytic space. Consider the following conditions:
    \begin{enumerate}
        \item $X$ is holomorphically convex;
        \item For any sequence $x_i\in X$ ($i\in \mathbb{Z}_{>0}$) without accumulation points, there is $f\in \mathcal{O}_X(X)$ such that $|f(x_i)|$ is unbounded.
    \end{enumerate}
    Then (2) $\implies$ (1) if $X$ is paracompact.
\end{proposition}
\begin{proof}
    (2) $\implies$ (1): By \cref{prop-paracompactanalyticspace}, each connected component of $X$ is LindelÃ¶f.
    For a LindelÃ¶f Hausdorff space, sequential compactness implies compactness. 

    %Recall that a complex analytic space is always first countable. For a first countable Hausdorff space, compactness implies sequential compactness.
\end{proof}

\begin{corollary}
    Let $n\in \mathbb{N}$ and $\Omega$ be a domain in $\mathbb{C}^n$. Assume that for each $p\in \partial \Omega$, there is a holomorphic function $f$ on an open neighbourhood $U$ of $\bar{\Omega}$ such that $f(p)=0$ and $f$ is non-zero on $\Omega$. Then $\Omega$ is holomorphically convex.
\end{corollary}
\begin{proof}
    Let $x_i\in \Omega$ ($i\in \mathbb{Z}_{>0}$) be a sequence without accumulation points in $\Omega$. We need to construct $f\in \mathcal{O}_{\Omega}(\Omega)$ such that $(|f(x_i)|)_{i\in \mathbb{Z}_{>0}}$ is unbounded. This is clear if $x_i$ itself is unbounded. Assume that $x_i$ is bounded. Then up to passing to a subsequence, we may assume that $x_i\to p\in \partial \Omega$ as $i\to\infty$. The inverse of the function $f$ in our assumption of the corollary works.
\end{proof}




\section{Stein sets}


\begin{definition}
    Let $X$ be a complex analytic space and $P$ be a closed subset of $X$. We say $P$ is a \emph{Stein set} in $X$ if for any coherent $\mathcal{O}_U$-module $\mathcal{F}$ for some open neighbourhood $U$ of $P$ in $X$, we have
    \[
        H^i(P,\mathcal{F})=0\quad \text{for all }i\in \mathbb{Z}_{>0}.  
    \]

    A \emph{coherent $\mathcal{O}_P$-module} is a coherent $\mathcal{O}_U$-module for some open neighbourhood $U$ of $P$ in $X$. Two coherent $\mathcal{O}_P$-modules are isomorphic if there is a small enough open neighbourhood $V$ of $P$ in $X$ such that they are isomorphic when restricted to $V$. In particular, $\mathcal{O}_P$ denotes the coherent $\mathcal{O}_P$-module defined by $\mathcal{O}_X$ on $X$.
    
    The germ-wise notions obviously make sense for coherent $\mathcal{O}_P$-modules.
\end{definition}

The given condition is usually known as \emph{Cartan's Theorem~B}. It implies \emph{Cartan's Theorem~A}:
\begin{thm}[Cartan's Theorem~A]\label{thm-CartanA}
    Let $X$ be a complex analytic space and $P$ be a Stein set in $X$. Let $\mathcal{F}$ be a coherent $\mathcal{O}_U$-module for some open neighbourhood $U$ of $P$ in $X$. Then $H^0(P,\mathcal{F})$ generates $\mathcal{F}_x$ for each $x\in P$.
\end{thm}
\begin{proof}
    Fix $x\in P$. Let $\mathcal{M}$ be the coherent ideal sheaf on $U$ consisting of holomorphic functions vanishing at $x$. Then $\mathcal{F}\mathcal{M}$ is a coherent $\mathcal{O}_U$-module. It follows from Theorem~B that
    \[
        H^0(P,\mathcal{F})\rightarrow H^0(P,\mathcal{F}/\mathcal{F}\mathcal{M})
    \]   
    is surjective. Note that we can identify this map with the natural map
    \[
        H^0(P,\mathcal{F})\rightarrow   \mathcal{F}_x/\mathfrak{m}_x \mathcal{F}_x.
    \]

    Let $e_1,\ldots,e_m$ be a basis of $\mathcal{F}_x/\mathfrak{m}_x \mathcal{F}_x$. Lift them to $s_1,\ldots,s_m\in H^0(P,\mathcal{F})$. By Nakayama's lemma, $s_{1x},\ldots,s_{mx}$ generate the $\mathcal{O}_{X,x}$-module $\mathcal{F}_x$.
\end{proof}


\begin{corollary}\label{cor-thmacohsheafquotient}
    Let $X$ be a complex analytic space and $P$ be a quasi-compact Stein set in $X$.  Let $\mathcal{F}$ be a coherent $\mathcal{O}_P$-module.
    Then there is $n\in \mathbb{Z}_{>0}$ and an epimorphism
    \[
        \mathcal{O}_P^n\rightarrow \mathcal{F}.  
    \]
\end{corollary}
\begin{proof}
    By \cref{thm-CartanA}, we can find an open covering $\{U_i\}_{i\in I}$ of $P$ such that there are homomorphisms
    \[
        h_i:\mathcal{O}_P^{n_i}\rightarrow \mathcal{F}  
    \]
    for some $n_i\in \mathbb{Z}_{>0}$, which is surjective on $U_i$ for each $i\in I$. By the quasi-compactness of $P$, we may assume that $I$ is a finite set. Then it suffices to set $n=\sum_{i\in I}n_i$ and consider the epimorphism $\mathcal{O}_P^n\rightarrow \mathcal{F}$ induced by the $h_i$'s.
\end{proof}

\begin{thm}\label{thm-blocktostein}
    Let $X$ be a complex analytic space and $P\subseteq X$ be a set with the following properties:
    \begin{enumerate}
        \item there is an open neighbourhood $U$ of $P$ in $X$, a domain $V$ in $\mathbb{C}^m$ for some $m\in \mathbb{N}$ and a finite holomorphic morphism $\tau:U\rightarrow V$;
        \item There exists a compact tube in $\mathbb{C}^m$ contained in $V$ such that $P=\tau^{-1}(Q)$.
    \end{enumerate}
    Then $P$ is a compact Stein set in $X$.
\end{thm}
\begin{proof}
    As $P=\tau^{-1}(Q)$ and $\tau$ is proper, we see that $P$ is compact.
    
    It remains to show that $P$ is a Stein set in $X$. Let $\mathcal{F}$ be a coherent $\mathcal{O}_P$-module.

    \textbf{Step~1}. We first reduce to the case where $\mathcal{F}$ is defined by a coherent $\mathcal{O}_U$-module.

    Take an open neighbourhood $U'$ of $P$ in $X$ contained in $U$ such that $\mathcal{F}$ is defined by a coherent $\mathcal{O}_{U'}$-module. By \cref{Topology-lma-opennhfiberclosedmap} in \nameref{Topology-chap-topology}, we can take an open neighbourhood $V'$ of $Q$ in $V$ such that $\tau^{-1}(V')\subseteq U'$. The restriction of $\tau$ to $\tau^{-1}(V')\rightarrow V'$ is again finite.

    \textbf{Step~2}. By Leray spectral sequence,
    \[
        H^i(P,\mathcal{F})\cong H^i(Q,(\tau|_P)_*\mathcal{F})
    \]
    for all $i\geq 0$. By \cref{Morphisms-cor-finitepushcoh}  in \nameref{Morphisms-chap-morphismscomplex}, $(\tau|_P)_*\mathcal{F}$ is a coherent $\mathcal{O}_Q$-module, so we are reduced to show that $Q$ is a Stein set in $\mathbb{C}^m$, which is well-known.
\end{proof}




\begin{definition}\label{def-Steinexhaus}
    Let $X$ be a Hausdorff complex analytic space and $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module. 
    A \emph{Stein exhaustion of $X$ relative to $\mathcal{F}$} is a compact exhaustion $(P_i)_{i\in \mathbb{Z}_{>0}}$ such that the following conditions are satisfied:
    \begin{enumerate}
        \item  $P_i$ is a Stein set in $X$ for each $i\in \mathbb{Z}_{>0}$;
        \item the $\mathbb{C}$-vector space $H^0(P_i,\mathcal{F})$ admits a semi-norm $|\bullet|_i$ such that the restriction map 
        \[
            H^0(X,\mathcal{F})\rightarrow H^0(P_i,\mathcal{F})
        \] 
        has dense image with respect to the topological defined by $|\bullet|_i$ for each $i\in \mathbb{Z}_{>0}$;
        \item The restriction map
            \[
                H^0(P_{i+1},\mathcal{F})\rightarrow H^0(P_i,\mathcal{F})
            \]
            is bounded for each $i\in \mathbb{Z}_{>0}$;
        \item Let $i\in \mathbb{Z}_{\geq 2}$. Suppose that $(s_j)_{j\in \mathbb{Z}_{>0}}$ is a Cauchy sequence in $H^0(P_i,\mathcal{F})$, then the restricted sequence $s_j|_{P_{i-1}}$ has a limit in $H^0(P_{i-1},\mathcal{F})$;
        \item Let $i\in \mathbb{Z}_{\geq 2}$. If $s\in H^0(P_i,\mathcal{F})$ and $|s|_i=0$, then $s|_{P_{i-1}}=0$.
    \end{enumerate}

    A \emph{Stein exhaustion of $X$} is a compact exhaustion of $X$ that is a Stein exhaustion of $X$ relative to any coherent $\mathcal{O}_X$-module.
\end{definition}

\begin{thm}\label{thm-Steinexhcohvan}
    Let $X$ be a Hausdorff complex analytic space and $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module. Assume that $(P_i)_{i\in \mathbb{Z}_{>0}}$ is a Stein exhaustion of $X$ relative to $\mathcal{F}$. Then
    \[
        H^q(X,\mathcal{F})=0\quad \text{for any }q\in \mathbb{Z}_{>0}.  
    \]
\end{thm}
\begin{proof}
    When $q\geq 2$, this follows from the general facts proved in \cref{Topology-lma-exhaustioncoh} in \nameref{Topology-chap-topology}. We will assume that $q=1$.

    We may assume that $X$ is connected.
    First observe that $X$ is necessarily paracompact. This follows from \cref{Topology-prop-paracptrefinement} in \nameref{Topology-chap-topology}. In particular, we can take a flabby resolution
    \[
        0\rightarrow \mathcal{F}\rightarrow \mathcal{G}^0\rightarrow \mathcal{G}^1\rightarrow \cdots.  
    \]
    Taking global sections, we get a complex
    \[
        0\rightarrow H^0(X,\mathcal{F})\xrightarrow{i} H^0(X,\mathcal{G}^0)\xrightarrow{d_0} H^0(X,\mathcal{G}^1)\xrightarrow{d_1}H^0(X,\mathcal{G}^2)\xrightarrow{d_2} \cdots.  
    \]
    We need to show that $\ker d_1=\Img d_0$. Let $\alpha\in \ker d_1$. We need to construct $\beta\in H^0(X,\mathcal{G}^0)$ with $d_0 \beta=\alpha$.

    We take semi-norms $|\bullet|_i$ on $H^0(P_i,\mathcal{F})$ for each $i\in \mathbb{Z}_{>0}$ satisfying the conditions in \cref{def-Steinexhaus}. We may furthermore assume that the restriction $H^0(P_{i+1},\mathcal{F})\rightarrow H^0(P_i,\mathcal{F})$ is a contraction for each $i\in \mathbb{Z}_{>0}$.

    For each $j\in \mathbb{Z}_{\geq 2}$, we will construct $\beta_j\in H^0(P_j,\mathcal{G}^0)$ and $\delta_j\in H^0(P_{j-1},\mathcal{F})$ such that
    \begin{enumerate}
        \item $(d_0|_{P_j})\beta_j=\alpha|_{P_j}$;
        \item $(\beta_{j+1}+\delta_{j+1})|_{P_{j-1}}=(\beta_{j}+\delta_{j})|_{P_{j-1}}$.
    \end{enumerate}
    It suffices to take $\beta\in H^0(X,\mathcal{G}^0)$ as the section defined by the $\beta_j+\delta_j$'s.

    We first construct $\beta_j$. Choose a sequence $\beta_j'\in H^0(P_j,\mathcal{G}^0)$ with 
    \[
        (d_0|_{P_j})\beta_j'=\alpha|_{P_j}  
    \]
    for each $j\in \mathbb{Z}_{>0}$. This is possible because $P_j$ is Stein. We define $\beta_j$ satisfying Condition~(1) for $j\in \mathbb{Z}_{>0}$ inductively. We begin with $\beta_1=\beta_1'$. Assume that $\beta_1,\ldots,\beta_j$ have been constructed. Let
    \[
        \gamma_j':=\beta'_{j+1}|_{P_j}-\beta_j. 
    \]
    Then
    \[
        (d_0|_{P_j})\gamma_j'=0.        
    \]
     It follows that $\gamma_j'\in H^0(P_j,\mathcal{F})$. Take $\gamma_j\in H^0(X,\mathcal{F})$ with 
    \[
        |\gamma_j'-\gamma_j|_{P_j}|_j\leq 2^{-j}.  
    \]
    Define
    \[
        \beta_{j+1}=\beta'_{j+1}-\gamma_i|_{P_{j+1}}. 
    \]
    Then clearly $\beta_{j+1}$ satisfies (1).

    Next we construct the sequence $\delta_j$.

    We observe that for each $j\in \mathbb{Z}_{>0}$,
    \[
        \left|\beta_{j+1}|_{P_j}-\beta_j  \right|_j\leq 2^{-j}.
    \]
    Let
    \[
        s^j_{k}:=\beta_{j+k}|_{P_j}-\beta_j  \in H^0(P_j,\mathcal{F})
    \]
    for all $j\in \mathbb{Z}_{>0}$ and $k\in \mathbb{N}$.
    By definition,
    \[
        s^j_k-s^{j+1}_{k-1}|_{P_j}  =\beta_{j+1}|_{P_j}-\beta_j
    \]
    for all $j\in \mathbb{Z}_{>0}$ and $k\in \mathbb{Z}_{>0}$.

    We claim that $(s^j_k|_{P_{j-1}})_k$ converges in $H^0(P_{j-1},\mathcal{F})$ as $k\to\infty$. 
    By our assumption, it suffices to show that $(s^j_k)_k$ is a Cauchy sequence in $H^0(P_j,\mathcal{F})$ for each $j\in \mathbb{Z}_{>1}$.
    We first compute
    \[
        \left|\beta_{j+l}|_{P_j}-\beta_{j+l-1}|_{P_j}\right|_j\leq   \left|\beta_{j+l}|_{P_{j+l-1}}-\beta_{j+l-1}\right|_{j+l-1}\leq 2^{1-j-l}
    \]
    for all $l\in \mathbb{Z}_{>0}$ and $j\in \mathbb{Z}_{>0}$. As a consequence for $k'>k\geq 1$, we have
    \[
        |s^j_k-s^j_{k'}|_j\leq \sum_{l=k+1}^k 2^{1-j-l}\leq 2^{1-j+k}.  
    \]
    So we conclude our claim.

    Let $\delta_j$ be the limit of $s^j_k|_{P_{j-1}}$ as $k\to\infty$ for each $j\in \mathbb{Z}_{\geq 2}$. 
    Then
    \[
        \lim_{k\to\infty}\left(s^j_k-s^{j+1}_{k-1}\right)|_{P_{j-1}}=\left(\delta_j-\delta_{j+1}\right)|_{P_{j-1}}  
    \]
    for each $j\in \mathbb{Z}_{\geq 2}$.
    The desired identity is clear.
\end{proof}


\section{Analytic blocks}

\begin{definition}\label{def-anablock}
    Let $X$ be a Hausdorff complex analytic space. A stone $(P,\pi:X\rightarrow \mathbb{C}^n)$ on $X$ is an \emph{analytic block} in $X$ if there are open neighbourhoods $U$ and $V$ of $P$ and $Q$ in $X$ and $Y$ respectively, where $Q\subseteq \mathbb{C}^n$ denotes the tube associated with the stone, such that
    \begin{enumerate}
        \item $\pi(U)\subseteq V$;
        \item $P=\pi^{-1}(Q)\cap U$;
        \item $U\rightarrow V$ induced by $\pi$ is a finite morphism.
    \end{enumerate}
\end{definition}
Recall that by \cref{thm-stonelocallyproper}, we can always assume that $U\rightarrow V$ is proper.

\begin{proposition}
    Let $X$ be a Hausdorff complex analytic space and $(P,\pi)$ be an analytic block in $X$. Then $P$ is a compact Stein set in $X$.
\end{proposition}
\begin{proof}
    This follows from \cref{thm-blocktostein} applied to $U\rightarrow V$ in \cref{def-anablock}.
\end{proof}

\begin{proposition}\label{prop-stoneisblockunderass}
    Let $X$ be a complex analytic space such that each compact analytic set in $X$ is finite, then every stone in $X$ is an analytic block in $X$.
\end{proposition}
\begin{proof}
    Let $(P,\pi:X\rightarrow \mathbb{C}^n)$ be a stone in $X$.
    We consider the proper morphism $\tau:U\rightarrow V$ as in \cref{thm-stonelocallyproper}. Each fiber of $\tau$ is a compact subset of $U$ and hence a compact subset of $X$. By our assumption, it is finite. It suffices to apply \cref{Topology-prop-topfinitechar} in \nameref{Topology-chap-topology} to conclude that $\tau$ is finite.
\end{proof}

\section{Holomorphically spreadable spaces}
\begin{definition}
    Let $X$ be a complex analytic space. We say $X$ is \emph{holomorphically spreadable} if $|X|$ is Hausdorff and for any $x\in X$, we can find an open neighbourhood $U$ of $x$ in $X$ such that
    \[
        \left\{y\in U:f(x)=f(y)\text{ for all }f\in \mathcal{O}_X(X) \right\} =\{x\}.
    \]
\end{definition}
A holomorphically separable space is clearly holomorphically spreadable.



\begin{proposition}\label{prop-holspreadablelocallyisopt}
    Let $X$ be a holomorphically spreadable complex analytic space and $x\in X$. Then there exist finitely many $f_1,\ldots,f_n\in \mathcal{O}_X(X)$ such that $x$ is an isolated point of $W(f_1,\ldots,f_n)$.
\end{proposition}
\begin{proof}
    By induction on $\dim_x X$, it suffices to prove the following claim: if $A$ is an analytic set in $X$ and $a\in A$ such that $\dim_a A\geq 1$. Then there is $f\in \mathcal{O}_X(X)$ such that $\dim_a (A\cap W(f))=\dim_a A-1$.

    To prove the claim, let $A_1,\ldots,A_k$ be the irreducible components of $A$. We may assume that all of them contain $a$. Choose $a_j\in A_j$ for each $j=1,\ldots,k$ so that $a,a_1,\ldots,a_k$ are pairwise different. Then there is a function $f\in \mathcal{O}_X(X)$ with $f(a)=0$ while $f(a_j)\neq 0$ for $j=1,\ldots,k$. Then $a\in W(f)$ while $f|_{A_j}$ is not identically $0$. By Krulls Hauptidealsatz, $\dim_a (A_j\cap W(f))=\dim_a A_j-1$ for all $j=1,\ldots,k$. Observe that $A\cap W(f)$ and $\bigcup_{j=1}^k (A_j\cap W(f))$ coincide near $a$, so
    \[
        \dim_a (A\cap W(f))=\max_{j=1,\ldots,k} \dim_a (A_j\cap W(f))=\max_{j=1,\ldots,k}(\dim_a A_j-1)=\dim_a A-1.
    \] 
\end{proof}

\begin{proposition}
    Let $X$ be an irreducible holomorphically spreadable complex analytic space. Then $X$ has countable basis.
\end{proposition}
The statement of this proposition in \cite[Proposition~0.37]{Fis76} is clearly wrong. I do not understand the argument of either \cite{Jur59} or \cite{Gra55}, where they claim that this result holds for connected holomorphically spreadable complex analytic spaces.
\begin{proof}
    We may assume that $X$ is connected. Recall that by \cref{PropertyComplex-cor-caslocallyconnected} in \nameref{PropertyComplex-chap-propcomplex}, $X$ is locally connected.
    Let $F:X\rightarrow \mathbb{C}^{\mathcal{O}_X(X)}$ be the map sending $x\in X$ to $(f(x))_{f\in \mathcal{O}_X(X)}$. By our assumption, $F$ is continuous and has discrete fibers.     
    In particular, for each $x\in X$, we may assume take finitely many $f_1,\ldots,f_n\in \mathcal{O}_X(X)$ so that the induced morphism $F':X\rightarrow \mathbb{C}^n$ is quasi-finite at $x$. By \cref{Analytic-cor-quasifinitelocuscoana} in \nameref{Analytic-chap-AS}, we can find a nowhere dense analytic set $A$ in $X$ such that the map $X\setminus A\rightarrow \mathbb{C}^n$ induced by $F'$ is quasi-finite. Now we endow $\mathcal{O}_X(X)$ with the compact-open topology. It is a metric space. By \cref{Topology-prop-fiberdiscountablebasisinh} in \nameref{Topology-chap-topology}, $X\setminus A$ has countable basis. It follows that $\mathcal{O}_X(X\setminus A)$ is a separable metric space. Hence, so it $\mathcal{O}_X(X)$. In particular, there is a continous map with discrete fibers
    \[
        X\rightarrow  \mathbb{C}^{\omega}.  
    \]
    It follows again from \cref{Topology-prop-fiberdiscountablebasisinh} in \nameref{Topology-chap-topology} that $X$ has countable basis.
\end{proof}

\begin{proposition}\label{prop-cptanainspreadablefinite}
    Let $X$ be a holomorphically spreadable complex analytic space. Then any compact analytic set $A$ in $X$ is finite.
\end{proposition}
\begin{proof}
    Let $B$ be a connected component of $A$ and $p\in B$. We need to show that $B=\{p\}$. Take finitely many $f_1,\ldots,f_n\in \mathcal{O}_X(X)$ so that $p$ is an isolated point of $W(f_1,\ldots,f_n)$. This is possible by \cref{prop-holspreadablelocallyisopt}.
    As $f_i$ vanishes on $B$ for each $i=1,\ldots,n$, we have $B=\{p\}$.
\end{proof}
\begin{corollary}\label{cor-anasetinblockcptimplfinite}
    Let $X$ be a complex analytic space and $A$ be a compact analytic subset of $X$. Suppose that there exists an analytic block $(P,\pi:X\rightarrow \mathbb{C}^n)$ in $X$ with $A\subseteq P$, then $A$ is finite.
\end{corollary}
\begin{proof}
    Take $U\subseteq X,V\subseteq \mathbb{C}^n$ as in \cref{def-anablock} so that $U\rightarrow V$ is finite. Then $U$ is clearly holomorphically spreadable. By \cref{prop-cptanainspreadablefinite}, $A$ is finite.
\end{proof}

\section{Holomorphically complete spacs}

\begin{definition}
    Let $X$ be a complex analytic space. An \emph{exhaustion of $X$ by analytic blocks} is an exhaustion of $X$ by stones $(P_i,\pi_i)_{i\in \mathbb{Z}_{>0}}$ such that $(P_i,\pi_i)$ is an analytic block for each $i\in \mathbb{Z}_{>0}$.

    We say $X$ is \emph{holomorphically complete} if $X$ is Hausdorff and there is an exhaustion of $X$ by analytic stones.
\end{definition}
\begin{thm}\label{thm-holcomchar}
    Let $X$ be a Hausdorff complex analytic space. Then the following are equivalent:
    \begin{enumerate}
        \item $X$ is holomorphically complete;
        \item $X$ is weakly holomorphically convex and every compact analytic subset of $X$ is finite.
    \end{enumerate}
\end{thm}
\begin{proof}
    (1) $\implies$ (2): $X$ is weakly holomorphically convex by definition. Each compact analytic subset $A$ of $X$ is contained in some analytic block, hence finite by \cref{cor-anasetinblockcptimplfinite}.

    (2) $\implies$ (1): This follows from \cref{prop-stoneisblockunderass}.
\end{proof}

\begin{lemma}\label{lma-coherentsheafclosed}
    Let $X$ be a complex manifold and $\mathcal{I}$ be a coherent subsheaf of $\mathcal{O}_X^l$ for some $l\in \mathbb{Z}_{>0}$. Then $\mathcal{I}(X)$ is a closed subspace of $\mathcal{O}_X(X)^l$ endowed with the compact-open topology.
\end{lemma}
\begin{proof}
   Let $(f_j\in \mathcal{I}(X))_{j\in \mathbb{Z}_{>0}}$ be a sequence with a limit $f\in \mathcal{O}^l_X(X)$. Let $x\in X$. It suffices to show that $f_x\in \mathcal{I}_x$. Observe that $f_x$ is the limit of $f_{jx}$ as $j\to\infty$. As $\mathcal{O}_{X,x}$ is noetherian, the submodule $\mathcal{I}_x$ of $\mathcal{O}_x^l$ is closed by \cref{Banach-cor-idealclosed} in \nameref{Banach-chap-Banach}. We conclude.
\end{proof}


\begin{definition}\label{def-goodseminorm}
    Let $X$ be a complex analytic space and $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module.
Let $(P,\pi:X\rightarrow \mathbb{C}^n)$ be an analytic block on $X$ with a non-zero associated tube $Q\subseteq \mathbb{C}^n$. 

Choose $U\subseteq X,V\subseteq \mathbb{C}^n$ as in \cref{def-anablock} so that $\tau:U\rightarrow V$ induced by $\pi$ is finite. Then $\mathcal{G}:=\tau_*(\mathcal{F}|_U)$  is a coherent $\mathcal{O}_V$-module. By \cref{cor-thmacohsheafquotient}, we can find $l\in \mathbb{Z}_{>0}$ and an epimorphism $\mathcal{O}_Q^l\rightarrow \mathcal{G}|_Q$. It induces an epimorphism $\epsilon:H^0(Q,\mathcal{O}_{\mathbb{C}^n})^l\rightarrow H^0(Q,\mathcal{G})\cn H^0(P,\mathcal{F})$. We define a semi-norm $|\bullet|$ on $H^0(P,\mathcal{F})$ as the quotient semi-norm induced by the sup seminorm on $H^0(Q,\mathcal{O}_{\mathbb{C}^n})^l$. 

A seminorm on  $H^0(P,\mathcal{F})$ defined in this way is called a \emph{good semi-norm} on  $H^0(P,\mathcal{F})$ with respect to $(P,\pi)$.
\end{definition}
\begin{lemma}\label{lma-goodseminormmetric}
    Let $X$ be a complex analytic space and $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module.
Let $(P,\pi)$ be an analytic block on $X$. A good semi-norm on  $H^0(P,\mathcal{F})$ induces a metric on $H^0(P^0,\mathcal{F})$.
\end{lemma}
\begin{proof}
We need to show that if $|s|=0$ for some $s\in H^0(P,\mathcal{F})$, then $s|_{P^0}=0$, where $P^0$ is the analytic interior of $P$. 

We use the same notations as in \cref{def-goodseminorm}.
We can take $h\in H^0(Q,\mathcal{O}_{\mathbb{C}^n})^l$ and $h_j\in \ker \epsilon$ for each $j\in \mathbb{Z}_{>0}$ so that $\epsilon(h)=s$ and $\|h_j-h\|_{L^{\infty}}\to 0$. So $h_j|_Q\to h|_Q$ with respect to the compact-open topology. From  \cref{lma-coherentsheafclosed}, we conclude that the image of $h|_{\Int Q}$ is $0$. Namely, $s$ vanishes on $P^0=\tau^{-1}(\Int Q)$.
\end{proof}


\begin{lemma}\label{lma-comptopologies1}
    Let $X$ be a complex analytic space and $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module.
Let $(P,\pi:X\rightarrow \mathbb{C}^n)$ be an analytic block on $X$ with a non-zero associated tube $Q\subseteq \mathbb{C}^n$. Consider the epimorphism of sheaves 
\[
    \mathcal{O}_Q^l\rightarrow \pi_*(\mathcal{F}|_P)
\]
as in \cref{def-goodseminorm} and endow $H^0(P^0,\mathcal{F})$ with the metric induced by the corresponding good semi-norm. Let 
\[
    Q_1\subseteq Q_2\subseteq \cdots
\]
be a compact exhaustion of $\Int Q$ by tubes with the same centers in $\mathbb{C}^n$. We get an induced map
\[
    \epsilon_j:H^0(Q_j,\mathcal{O}_{\mathbb{C}^n}^l) \rightarrow \pi_*(\mathcal{F}|_P)(Q_j) 
\]
for each $j\in \mathbb{Q}_{>0}$. We therefore get good semi-norms $|\bullet|_j$ on $H^0(P^0, \mathcal{F})$ for each $j\in \mathbb{Z}_{>0}$. Let
\[
    d(s_1,s_2):=\sum_{j=1}^{\infty}  2^{-j}\frac{|s_1-s_2|_j}{1+|s_1-s_2|_j}
\]
for each $s_1,s_2\in H^0(P^0, \mathcal{F})$. Then $d$ is a metric on  $H^0(P^0, \mathcal{F})$ and $H^0(P^0, \mathcal{F})$ is a FrÃ©chet space with respect to this topology.

Moreover, the topology does not depend on the choice of $\pi$, $\epsilon$ and the exhaustion.
\end{lemma}
\begin{proof}
By \cref{lma-goodseminormmetric}, each $|\bullet|_{\nu}$ is a norm on $H^0(P^0, \mathcal{F})$. It follows that $d$ is a metric. Next we show that $H^0(P^0, \mathcal{F})$ is FrÃ©chet. 
Let $(s_j)_{j\in \mathbb{Z}_{>0}}$ be a Cauchy sequence in $H^0(P^0, \mathcal{F})$. We can find bounded sequences $(f_{jk}\in H^0(Q_k,\mathcal{O}^l_{\mathbb{C}^n}))_{k\in \mathbb{Z}_{>0}}$ so that $\epsilon_k(f_{jk})=s_j|_{\pi^{-1}(Q_k)\cap P}$ ($k\in \mathbb{Z}_{>0}$) for each $j\mathbb{Z}_{>0}$. By Montel's theorem, there is a subsequence of $(f_{jk})_j$ which converges uniformly on $Q_{k-1}$ to $f_k\in H^0(Q_{k-1},\mathcal{O}_{\mathbb{C}^n}^l)$. Then $\epsilon_{k-1}(f_{k+1})|_{\Int Q_{k-1}}=\epsilon_{k-1}(f_k)|_{\Int Q_{k-1}}$ for each $k\in \mathbb{Z}_{\geq 2}$. So we can glue the $f_k$'s to $s\in H^0(P^0,\mathcal{F})$. Clearly, $s_k\to s$ as $k\to\infty$.

Next we show that the topology is independent of the choice of $\pi$, $\epsilon$ and the exhaustion. 
The independence of the exhaustion is obvious. We prove the other two independence.
Let $(P,\pi':X\rightarrow \mathbb{C}^{n'})$ be another analytic block with $\pi'=(\pi,\varphi):X\rightarrow \mathbb{C}^n\times \mathbb{C}^m$, $n'=n+m$. Let $Q^*\subseteq \mathbb{C}^m$ be a tube such that $\varphi(P)\subseteq Q^*$. Then $P=\pi'^{-1}(Q\times Q^*)\cap U$. We can find an open neighbourhood $U'$ of $P$ in $X$ and $V'$ of $Q\times Q^*$ in $\mathbb{C}^{n'}$ for which the induced map $\tau':U'\rightarrow V'$ is finite by \cref{def-anablock}. Fix an epimorphism $\mathcal{O}_{\mathbb{C}^{n'}}^{l'}|_{Q\times Q^*}\rightarrow \pi'_*(\mathcal{F}|_P)$ for some $l'\in \mathbb{Z}_{>0}$. Construct an exhanstion of $\Int Q\times \Int Q^*$ of the product type: $(Q_j\times Q_j^*)_{j\in \mathbb{Z}_{>0}}$ as in the lemma. Let $d'$ denote the induced metric on $H^0(\Int P,\mathcal{F})$.


We will show that $d'$ and $d$ induce the same topology. Let $e_1,\ldots,e_l\in H^0(Q,\mathcal{O}_{\mathbb{C}^n}^l)$ be the standard basis.  Let $e_1',\ldots,e_l'$ be the preimages of $\epsilon(e_1),\ldots,\epsilon(e_l)\in \pi_* (\mathcal{F}|P)(Q)=\pi'_*(\mathcal{F}|_P)(Q\times Q^*)$ in $\mathcal{O}_{\mathbb{C}^{n'}}(Q\times Q^*)^{l'}$ under $\epsilon'$. Further, for $f\in \mathcal{O}_{\mathbb{C}^n}(Q_j)$, we denote by $f'\in\mathcal{O}_{\mathbb{C}^{n'}}(Q_j\times Q_j^*)$ the holomorphic extension of $f$ to $Q_j\times Q_j^*$ constant along $\{q\}\times Q_j^*$ for each $q\in Q_j$  for each $j\in \mathbb{Z}_{>0}$. The norms of 
\[
\mathcal{O}_{\mathbb{C}^n}(Q_j)^l\rightarrow \mathcal{O}_{\mathbb{C}^{n'}}(Q_j\times Q_j^*)^l,\quad \sum_{i=1}^l f_i e_i\mapsto \sum_{i=1}^l f_i' e_i'    
\]
for $j\in \mathbb{Z}_{>0}$ are bounded by a constant independent of $j$. Therefore, the identity map 
\[
  (H^0(P^0,\mathcal{F}),d)  \rightarrow (H^0(P^0,\mathcal{F}),d')
\] 
is continuous. By open mapping theorem, the map is a homeomorphism.
\end{proof}

\begin{thm}\label{thm-compseminor2}
    Let $X$ be a complex analytic space and $(P,\pi)\subseteq (P',\pi')$ be two analytic blocks on $X$ and $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module, then the restriction map
    \[
        H^0(P',\mathcal{F}) \rightarrow H^0(P,\mathcal{F}) 
    \]
    with respect to any good semi-norms.
\end{thm}
\begin{proof}
    We claim that there exists an analytic block $(P_1,\pi)$ such that
    \[
        (P,\pi)\subseteq (P_1,\pi)\subseteq (P',\pi').  
    \]
    Assume this claim, then we have a decomposition of the restriction map
    \[
        H^0(P',\mathcal{F}) \rightarrow H^0(P_1^0,\mathcal{F})\rightarrow H^0(P,\mathcal{F}).
    \]
    The first map is continuous if we endow $H^0(P_1^0,\mathcal{F})$ with the topology induced by $\pi'$, the second is continuous if we endow $H^0(P_1^0,\mathcal{F})$ with the topology induced by $\pi$. These topologies are identical by \cref{lma-comptopologies1}.
    Our assertion follows.

    To argue the claim, let us write $\pi:X\rightarrow \mathbb{C}^n$ and $\pi'=(\pi,\varphi):X\rightarrow \mathbb{C}^n\times \mathbb{C}^m$. Take $q\in \mathbb{C}^m$ with $Q\times\{q\}\subseteq \Int Q'$. Let $Q'':=Q'\cap (\mathbb{C}^n\times \{q\})$ and identify it with a subset of $\mathbb{C}^n$. Let $Q^*$ be the image of $Q'$ under the projection $\mathbb{C}^{n+m}\rightarrow \mathbb{C}^m$. 

    Choose open neighbourhoods $U\subseteq P'^0$, $V\subseteq Q'$ of $P$ and $Q$ respectively such that $\tau:U\rightarrow V$ is finite and $U\cap \pi^{-1}(Q)=P$. Take a tube $Q_1\subseteq \mathbb{C}^n$ such that
    \[
        Q\subseteq \Int Q_1\subseteq Q_1\subseteq \Int Q''.  
    \]
    Now it suffices to set $P_1:=\pi^{-1}(Q_1)\cap U$.
\end{proof}

\begin{corollary}\label{cor-convthm}
    Let $X$ be a complex analytic space and $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module. Let
    $(P,\pi)\subseteq (P',\pi')$ be analytic blocks in $X$. Then for any Cauchy sequence $(s_j)_{j\in \mathbb{Z}_{>0}}$ in $H^0(P',\mathcal{F})$, the restriction sequence $(s_j|_P)_{j\in \mathbb{Z}_{>0}}$ has a limit in $H^0(P,\mathcal{F})$.
\end{corollary}
\begin{proof}
    Choose an analytic block $(P_1,\pi)$ such that
    \[
        (P,\pi)\subseteq (P_1,\pi)\subseteq (P',\pi').  
    \]
    The existence of the block $(P_1,\pi)$ is argued in the proof of \cref{thm-compseminor2}. We have a decomposition of the restriction map
    \[
        H^0(P',\mathcal{F}) \rightarrow H^0(P_1^0,\mathcal{F})\rightarrow H^0(P,\mathcal{F}).
    \]
    The first map is bounded, so the images of $(s_j)_{j\in \mathbb{Z}_{>0}}$ in $H^0(P_1^0,\mathcal{F})$ is a Cauchy sequence. As we have shown that $H^0(P_1^0,\mathcal{F})$ is a FrÃ©chet space in \cref{lma-comptopologies1}, the sequence converges. As the second map is also continuous, it follows that $(s_j|_P)_{j\in \mathbb{Z}_{>0}}$ has a limit in $H^0(P,\mathcal{F})$.
\end{proof}

\begin{lemma}\label{lma-denseimage}
    Let $X$ be a complex analytic space and $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module. Let
    $(P,\pi:X\rightarrow  \mathbb{C}^n)\subseteq (P',\pi':X\rightarrow \mathbb{C}^n\times \mathbb{C}^m)$ be analytic blocks in $X$ with tubes $Q$ and $Q'$. Choose $U'\subseteq X$ and $V'\subseteq \mathbb{C}^{n+m}$ of $P'$ and $Q'$ respectively as in \cref{def-anablock} such that $U'\rightarrow V'$ is finite. Set
    \[
        Q_1:=(Q\times \mathbb{C}^m)\cap Q',\quad P_1=\pi'^{-1}(Q_1)\cap U'.  
    \]
    Then $(P_1.\pi')$ is an analytic block in $X$ with block $Q_1$ and 
    $H^0(P',\mathcal{F})\rightarrow H^0(P_1,\mathcal{F})$ has dense image. Here we take an epsimorphism 
    \[
        \mathcal{O}_{\mathbb{C}^{n+m}}^{l'}|_{Q'}\rightarrow \left(\tau' (\mathcal{F}|_{U'}) \right)_{Q'} 
    \]
    and it induces 
    \[
        \mathcal{O}_{\mathbb{C}^{n+m}}^{l'}|_{Q_1}\rightarrow \left(\tau' (\mathcal{F}|_{U'}) \right)_{Q_1},
    \]
    which in turn induces a good semi-norm on $H^0(P_1,\mathcal{F})$. This is the semi-norm we are using.

    Moreover, there is a compact set $\tilde{P}\subseteq X$ disjoint from $P$ such that
    \[
        P_1=P\cup \tilde{P}.  
    \]
\end{lemma}
\begin{proof}
    We have a commutative diagram in the category of topological linear spaces:
    \[
        \begin{tikzcd}
            {H^0(Q',\mathcal{O}_{\mathbb{C}^{m+n}}^l)} \arrow[r] \arrow[d] & {H^0(P',\mathcal{F})} \arrow[d] \\
            {H^0(Q_1,\mathcal{O}_{\mathbb{C}^{m+n}}^l)} \arrow[r]          & {H^0(P_1,\mathcal{F})}         
        \end{tikzcd}.
    \]
    In order to show that the right vertical map has dense image, it is enough to show that the map on the left-hand side has dense images, which is the Runge approximation.

    For the last assertion, as $Q_1=(Q\times \mathbb{C}^m)\cap Q'$, we have
    \[
        P_1=\pi^{-1}(Q)\cap P'.  
    \]
    As $P\subseteq P'$ and $P\subseteq \pi^{-1}(Q)$, it follows that $P\subseteq P_1$. But there is an open neighbourhood $U$ of $P$ in $X$ so that $P=\pi^{-1}(Q)\cap U$. Hence, $\tilde{P}=P_1\setminus P$ is compact.
\end{proof}

\begin{thm}[Runge approximation]\label{thm-Rungapp}
    Let $X$ be a complex analytic space and $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module. Let
    $(P,\pi:X\rightarrow  \mathbb{C}^n)\subseteq (P',\pi':X\rightarrow \mathbb{C}^n\times \mathbb{C}^m)$ be analytic blocks in $X$ with tubes $Q$ and $Q'$. Then the map 
    \[
        H^0(P',\mathcal{F})\rightarrow H^0(P,\mathcal{F})  
    \]
    has dense image with respect to a good semi-norm.
\end{thm}
\begin{proof}
    We use the notations of \cref{lma-denseimage}. We extend $Q,Q_1,Q'$ to tubes $\hat{Q},\hat{Q}_1,\hat{Q}'$ and get $\hat{P},\hat{P_1},\hat{P'}$ corresponding to the original $P,P_1,P'$. The restriction map
    \[
        H^0(\hat{P_1}^0,\mathcal{F})\rightarrow H^0(\hat{P}^0,\mathcal{F})
    \]
    is a continuous morphism of FrÃ©chet spaces.

    Let $s\in H^0(P,\mathcal{F})$ be a section. Lift $s$ to $s_1\in H^0(P_1,\mathcal{F})$. Up to a suitable modification of the tubes, we can extend $s_1$ to $\hat{s_1}\in H^0(\hat{P_1},\mathcal{F})$. Then there is a sequence $(s^j\in H^0(\hat{P'},\mathcal{F}))_{j\in \mathbb{Z}_{>0}}$ such that $s^j|_{\hat{P_1}}\rightarrow \hat{s_1}$ as $j\to\infty$ in $H^0(\hat{P_1},\mathcal{F})$. It follows that $s^j|_{\hat{P}^0}\to \hat{s}_1|_{\hat{P}^0}$ in $H^0(\hat{P}^0,\mathcal{F})$. It follows that $s^j|_P\to s_1|_P=s$ sa $j\to\infty$.
\end{proof}

\begin{thm}\label{thm-AllanalybloexhisStein}
    Let $X$ be a complex analytic space.
    Each exhaustion of $X$ by analytic blocks is a Stein exhaustion.
\end{thm}
\begin{proof}
    Let $(P_i,\pi_i)_{i\in \mathbb{Z}_{>0}}$ be an exhaustion of $X$ by analytic blocks. Take a coherent $\mathcal{O}_X$-module $\mathcal{F}$.

    We verify the conditions in \cref{def-Steinexhaus}.
    By \cref{thm-blocktostein}, $P_i$ is a compact Stein set for each $i\in \mathbb{Z}_{>0}$. So (1) is satisfied.
    
    On $H^0(P_i,\mathcal{F})$, we fix a good semi-norm $|\bullet|_i$ for each $i\in \mathbb{Z}_{>0}$. We may assume that $H^0(P_{i+1},\mathcal{F})\rightarrow H^0(P_i,\mathcal{F})$ is contractive for $i\in \mathbb{Z}_{>0}$.

    We have already verified (3), (4) and (5).

    We verify (2). It suffices to show that
    \[
        H^0(X,\mathcal{F})\rightarrow H^0(P_1,\mathcal{F})  
    \]
    has dense image. Let $s\in H^0(P_1,\mathcal{F})$ and $\delta>0$. By \cref{thm-Rungapp}, we can find $s_i\in H^0(P_i,\mathcal{F})$ for $i\in \mathbb{Z}_{>0}$ such that $s_1=s$, 
    \[
        \left| s_{i+1}|_{P_i}-s_i \right|_i<2^{-i}\delta
    \]
    for $i\in \mathbb{Z}_{>0}$. By \cref{cor-convthm}, $(s_j|_{P_i})_{j\in \mathbb{Z}_{>0}}$ has a limit $t_i\in H^0(P_i,\mathcal{F})$ for each $i\in \mathbb{Z}_{>0}$. As $H^0(P_{i+1},\mathcal{F})\rightarrow H^0(P_{i},\mathcal{F})$ is continuous for $i\in \mathbb{Z}_{>0}$, the $t_{i+1}|_{P_i}$'s are compatible and defines $t\in H^0(X,\mathcal{F})$. It is easy to see that $|t|_{P_1}-s|_1<\delta$. Thus condition (2) is satisfied.
\end{proof}


\section{Stein spaces}

\begin{definition}
    Let $X$ be a complex analytic space. We say that $X$ is a Stein space if $X$ is a Stein set in $X$ and $|X|$ is paracompact and Hausdorff.
\end{definition}

\begin{definition}
    Let $X$ be a complex analytic space. An \emph{effective formal $0$-cycle} on $X$ consists of 
    \begin{enumerate}
        \item A disrete set $D\subseteq X$;
        \item An integer $n_x$ for each $x\in D$.
    \end{enumerate}
    We write the effective formal $0$-cycle as $\sum_{x\in D}n_x x$. We define the \emph{ideal sheaf} $\mathcal{O}_X(-\sum_{x\in D}n_x x)$ of an effective formal $0$-cycle as $\sum_{x\in D}n_x x$ as 
    \[
        \mathcal{O}_X(-\sum_{x\in D}n_x x)(U)=\left\{f\in H^0(U,\mathcal{O}_X): f_x\in \mathfrak{m}_x^{n_x}\text{ for each }x\in D\cap U \right\}
    \]
    for each open subset $U\subseteq X$.
\end{definition}
Observe that $\mathcal{O}_X(-\sum_{x\in D}n_x x)$ is a coherent $\mathcal{O}_X$-module. In fact, the problem is local, so we may assume that $D$ is finite. In this case, $D$ is an effective $0$-cycle and the result is clear.

\begin{lemma}\label{lma-localassigngerm}
    Let $X$ be a complex analytic space and $\sum_{x\in D}n_x x$ be an effective formal $0$-cycle on $X$. Assume that 
    \[
        H^0(X,\mathcal{O}_X)\rightarrow   H^0(X,\mathcal{O}_X/\mathcal{O}_X(-\sum_{x\in D}n_x x))
    \]
    is surjective. Suppose that for each $x\in D$, we assign $g_x\in \mathcal{O}_{X,x}$. Then there is $f\in H^0(X,\mathcal{O}_X)$ such that
    \[
        f_x-g_x\in \mathfrak{m}_x^{n_x}  
    \]
    for all $x\in D$.
\end{lemma}
\begin{proof}
    We define $s\in H^0(X,\mathcal{O}_X/\mathcal{O}_X(-\sum_{x\in D}n_x x))$ by $s_x=g_x$ for each $x\in D$. Lift $s$ to $f\in H^0(X,\mathcal{O}_X)$. Then $f$ clearly satisfies the required properties.
\end{proof}

\begin{proposition}\label{prop-assignvalue}
    Let $X$ be a complex analytic space. Assume that $H^1(X,\mathcal{I})=0$ for each coherent ideal sheaf $\mathcal{I}$ on $X$. Let $(x_i\in X)_{i\in \mathbb{Z}_{>0}}$ be a sequence without accumulation points and $(c_i)_{i\in \mathbb{Z}_{>0}}$ be a sequence in $\mathbb{C}$. Then there is $f\in \mathcal{O}_X(X)$ with $f(x_i)=c_i$ for each $i\in \mathbb{Z}_{>0}$.
\end{proposition}
\begin{proof}
    Consider the formal cycle $\sum_{i=1}^{\infty} x_i$. Apply \cref{lma-localassigngerm} with $g_{x_i}=c_i$.
\end{proof}




\begin{thm}\label{thm-Steinchar}
    Let $X$ be a paracompact Hausdorff complex analytic space. Then the following are equivalent:
    \begin{enumerate}
        \item $X$ is a Stein space;
        \item For any coherent ideal sheaf $\mathcal{I}$ on $X$, we have $H^1(X,\mathcal{I})=0$;
        \item $X$ is holomorphically separable and holomorphically convex;
        \item $X$ is holomorphically spreadable and weakly holomorphically convex; %and for each $x\in X$, there are $e=\dim_{\mathbb{C}}\mathfrak{m}_X/\mathfrak{m}_X^2$ functions $f_1,\ldots,f_e\in H^0(X,\mathcal{O}_X)$ such that $f_{1x},\ldots,f_{ex}$ generate $\mathfrak{m}_x$ as an $\mathcal{O}_{X,x}$-module;
        \item $X$ is holomorphically complete;
        \item $X$ is weakly holomorphically convex and every compact analytic subset of $X$ is finite.
    \end{enumerate}
\end{thm}
\begin{proof}
    (1) $\implies$ (2): This is trivial.

    (2) $\implies$ (3): $X$ is holomorphicaly convex by \cref{prop-assignvalue} and \cref{prop-holoconvchar}.
    $X$ is holomorphically separable by \cref{prop-assignvalue}.

    (3) $\implies$ (4): $X$ is holomorphically spreadable and weakly holomorphically convex by definition. %Let $h_1,\ldots,h_e\in \mathfrak{m}_x$ be some generators of $\mathfrak{m}_x$, whose existence is guaranteed by Nakayama's lemma. Applying  \cref{lma-localassigngerm} to the cycle $2x$, we get $f_1,\ldots,f_e\in H^0(X,\mathcal{O}_X)$ with $f_{ix}-h_i\in\mathfrak{m}_x^2$ for each $i=1,\ldots,e$. Then $f_1,\ldots,f_e$ satisfy the required properties.

    (4) $\implies$ (5): This follows from \cref{thm-holcomchar} and \cref{prop-cptanainspreadablefinite}.

    (5) $\implies$ (1): This follows from \cref{thm-AllanalybloexhisStein} and \cref{thm-Steinexhcohvan}.

    (5) $\Leftrightarrow$ (6): This is just \cref{thm-holcomchar}.
\end{proof}

\begin{lemma}\label{lma-branchedcovstein}
    Let $b\in \mathbb{Z}_{>0}$ and  $f:X\rightarrow Y$ be a $b$-sheeted branched covering of complex analytic spaces. Assume that $Y$ is normal. Then the following are equivalent:
    \begin{enumerate}
        \item $X$ is Stein;
        \item $Y$ is Stein.
    \end{enumerate}
\end{lemma}
The corresponding statement in Narasimhan is not correct. It is not clear to me if this holds for a general finite surjective morphism between paracompact normal Hausdorff complex analytic spaces.
\begin{proof}
    By \cref{lma-paracompactpropersurjimage}, $X$ is paracompact and Hausdorff if and only if $Y$ is paracompact and Hausdorff.

    (2) $\implies$ (1): This follows from Leray's spectral sequence.

    (1) $\implies$ (2): We may assume that $X$ is connected. 
    By \cref{thm-Steinchar}, it suffices to verify that $Y$ is holomorphically convex and every analytic set in $Y$ is finite.
    
    Let $(y_i\in Y)_{i\in \mathbb{Z}_{>0}}$ be a sequence without accumulation points. We can lift the sequence to $(x_i\in X)_{i\in \mathbb{Z}_{>0}}$ without accumulation points. By \cref{prop-assignvalue}, we can find $g\in \mathcal{O}_X(X)$ such that $(|g(x_i)|)_{i\in \mathbb{Z}_{>0}}$ is unbounded. Let $\chi_g\in \mathcal{O}_Y(Y)[w]$ be the characteristic polynomial of $g$. As $\chi_g(g)=0$, it follows that at least one coefficient of $\chi_g$ is unbounded along $(y_i)_{i\in \mathbb{Z}_{>0}}$. By \cref{prop-holoconvchar}, we conclude that $Y$ is holomorphically convex.

    Let $T$ be an analytic set in $Y$. Then so is $f^{-1}(T)$. As $X$ is Stein, $f^{-1}(T)$ is finite, hence so is $T$.
\end{proof}
\begin{corollary}\label{cor-finitemorphismStein2}
    Let $f:X\rightarrow Y$ be a finite surjective morphism of normal complex analytic spaces. Then the following are equivalent:
    \begin{enumerate}
        \item $X$ is Stein;
        \item $Y$ is Stein.
    \end{enumerate}
\end{corollary}
\begin{proof}
    By \cref{lma-paracompactpropersurjimage}, $X$ is paracompact and Hausdorff if and only if $Y$ is paracompact and Hausdorff.
    We may assume that $Y$ is connected. 

    (2) $\implies$ (1): This follows from Leray's spectral sequence.

    (1) $\implies$ (2): Observe that $Y$ is irreducible, so there is a connected component $X'$ of $X$ so that the restriction $X'\rightarrow Y$ is surjective. Then $X'\rightarrow Y$ is a branched covering by \cref{Morphisms-cor-branchedcovcondition} in  \nameref{Morphisms-chap-morphismscomplex}. But $X'$ is Stein as it is a connected component of a Stein space. We conclude using \cref{lma-branchedcovstein}.
\end{proof}

\begin{lemma}\label{lma-normalizationsteinanalyticsubset}
    Let $X$ be a reduced complex analytic space whose normalization $\bar{X}$ is Stein. Then for any reduced closed analytic subspace $Y$ of $X$, $\bar{Y}$ is also Stein.
\end{lemma}
\begin{proof}
    By \cref{lma-paracompactpropersurjimage}, $X$ is paracompact and Hausdorff.
    We write $\pi:\bar{X}\rightarrow X$ for the normalization morphism. Let $Y^1=\pi^{-1}(Y)$, the preimage is endowed with a structure of a closed analytic subspace of $X$. It follows that $Y^1$ is Stein. Its normalization $\overline{Y^1}$ is then Stein, as the normalization morphism is finite. 
    We have commutative diagram induced by the universal property of the normalization:
    \[
        \begin{tikzcd}
            \overline{Y^1} \arrow[d] \arrow[r] & \overline{Y} \arrow[ld] \\
            Y                                  &                        
        \end{tikzcd}.  
    \]
    The natural morphism $\overline{Y^1}\rightarrow Y$ is a finite as it is the composition of two finite coverings. Then morphism $\bar{Y}\rightarrow Y$ is finite, so $\overline{Y^1}\rightarrow \overline{Y}$ is finite. But its image contains a dense open subset of $\bar{Y}$, so $\overline{Y^1}\rightarrow \bar{Y}$ is surjective.  
    Observe that $\bar{Y}$ is paracompact and Hausdorff by the same arguments as in \cref{lma-branchedcovstein}.
    Now we can apply \cref{cor-finitemorphismStein2} to conclude that $\bar{Y}$ is Stein.
\end{proof}

\begin{corollary}\label{cor-Steinnorm}
    Let $X$ be a complex analytic space. Then the following are equivalent:
    \begin{enumerate}
        \item $X$ is Stein;
        \item $X^{\Red}$ is Stein;
        \item The normalization $\overline{X^{\Red}}$ is Stein.
    \end{enumerate}
\end{corollary}
The equivalence of (1) and  (2) is due to Grauert \cite{Gra60}. Here we follow the simplified approach in  \cite{GR77}.
The difficult direction (3) implies  (2) is claimed in \cite{GR77}, where the proof is nonsense. We follow the argument of Narasimhan \cite{Nar62}. We remind the readers that the statements and the arguments in \cite{Nar62} contain several (fixable) mistakes.

\begin{proof}
    By \cref{lma-paracompactpropersurjimage}, $X$ is paracompact and Hausdorff if and only if $\overline{X^{\Red}}$ is.

    (1) $\implies$ (2): This follows from Leray's spectral sequence.

    (2) $\implies$ (1): By \cref{thm-Steinchar}(3), it suffices to show that the restriction map $H^0(X,\mathcal{O}_X)\rightarrow H^0(X^{\Red},\mathcal{O}_{X^{\Red}})$ is surjective.

    Let $\mathcal{I}$ be the nilradical of $\mathcal{O}_X$. It is coherent by Cartan--Oka theorem.  For each $i\in \mathbb{Z}_{>0}$, we have a short exact sequence
    \[
        0\rightarrow \mathcal{I}^i/\mathcal{I}^{i+1}\rightarrow \mathcal{O}_X/\mathcal{I}^{i+1}\rightarrow \mathcal{O}_X/\mathcal{I}^{i}\rightarrow 0.
    \]
    As $\mathcal{I}^i/\mathcal{I}^{i+1}$ is a coherent $\mathcal{O}_{X^{\Red}}$-module, we conclude that 
    \[
        \varphi_i: H^0(X,\mathcal{O}_X/\mathcal{I}^{i+1})\rightarrow H^0(X,\mathcal{O}_X/\mathcal{I}^{i})  
    \]
    is surjective for each  $i\in \mathbb{Z}_{>0}$. Let $h_1\in H^0(X,\mathcal{O}_X/\mathcal{I})=H^0(X^{\Red},\mathcal{O}_{X^{\Red}})$. We want to lift it to $h\in H^0(X,\mathcal{O}_X)$.

    We successively lift $h_1$ to $h_i\in H^0(X,\mathcal{O}_X/\mathcal{I}^i)$ for each $i\in \mathbb{Z}_{>0}$. Let $X_i=X\setminus \Supp \mathcal{I}^i$ of each $i\in \mathbb{Z}_{>0}$. Then clearly
    \[
        X=\bigcup_{i=1}^{\infty}X_i.  
    \] 
    It is easy to see that 
    \[
        h_{i+1}|_{X_i}=h_i|_{X_i}  
    \]
    for each $i\in \mathbb{Z}_{>0}$. It follows that we can glue the $h_i|_{X_i}$'s
    to $h\in H^0(X,\mathcal{O}_X)$ which restricts to $h_1$.

    (2) $\implies$ (3): This follows from Leray's spectral sequence as $\overline{X^{\Red}}\rightarrow X^{\Red}$ is finite by \cref{PropertyComplex-prop-reducedspacenormalizationchar} in \nameref{PropertyComplex-chap-propcomplex}.

    (3) $\implies$ (2): We may assume that $X$ is reduced. 
    
    \textbf{Step~1}.
    We first observe that it suffices to prove in the case where $\dim X<\infty$.
    For each $k\in \mathbb{Z}_{>0}$, we let $X_k$ denote the union of the irreducible components of dimension $\leq k$. Then clearly, $X_k$ is an analytic set in $X$. We endow it with the reduced induced structure. Then $\dim X_k\leq k$.
    The normalization $\overline{X_k}$ of $X_k$ is a disjoint union of certain connected components of $\bar{X}$ and hence Stein for each $k\in \mathbb{Z}_{>0}$. It follows that $X_k$ is Stein if the special case is established.

    Let $D\subseteq X$ be a countable infinite set without accumulation points. For each $k\in \mathbb{Z}_{>0}$, we set $D_k=D\cap X_k$ and $E_{k+1}=D_{k+1}\setminus D_k$. Further we let $E_1=D_1$. We write the points of $D$ as $(x_i\in X)_{i\in \mathbb{Z}_{>0}}$. Let $h:D\rightarrow \mathbb{C}$ be the map sending $x_i$ to $i$ for each $i\in \mathbb{Z}_{>0}$. For each $k\in \mathbb{Z}_{>0}$, $h_k$ denotes the restriction of $h$ to $D_k$.

    As $X_1$ is Stein, we can construct $f_1\in \mathcal{O}_{X_1}(X_1)$ with $f_1|_{E_1}=h_1$ by \cref{prop-assignvalue}. As $E_2\cup X_1$ is an analytic subset in $X_2$, we can find $f_2\in \mathcal{O}_{X_2}(X_2)$ extending $f_1$ and such that $f_2|_{E_2}=h_2$. We continue in the obvious way and construct $f_k\in \mathcal{O}_{X_k}(X_k)$ for each $k\in \mathbb{Z}_{>0}$ compatible with each other. Then the $f_k$'s glue to give $f\in \mathcal{O}_{X}(X)$ unbounded on $D$. We conclude that $X$ is Stein by \cref{prop-holoconvchar}.

    \textbf{Step~2}. We assume that $\dim X<\infty$.

    Let $\mathcal{I}$ be a coherent ideal sheaf on $X$. By \cref{thm-Steinchar}, it suffices to show that 
    \[
        H^1(X,\mathcal{I})=0.  
    \]
    We may assume that $X$ is connected.
    We make an induction on $\dim X$. There is nothing to prove if $\dim X=0$. Assume that $\dim X>0$.

    We write $\pi:\bar{X}\rightarrow X$ for the normalization morphism.
    Let $\mathcal{W}$ be the conductor ideal of $\mathcal{O}_X$. Let $\mathcal{F}:=\pi^*(\mathcal{W}\mathcal{I})$. Observe that $\mathcal{F}$ is a coherent $\mathcal{O}_{\bar{X}}$-module.  By Leray spectral sequence,
    \[
        H^1(X,\pi_*\mathcal{F})\cong H^1(\bar{X},\mathcal{F})=0.  
    \]
    
    Let $Y:=\Supp \mathcal{O}_X/\mathcal{W}\subseteq X^{\Sing}$. Then $Y$ is an analytic set in $X$. We endow $Y$ with the reduced induced structure, then $Y$ is Stein by \cref{lma-normalizationsteinanalyticsubset} and our inductive hypothesis. 
    
    Observe that $\pi_*\mathcal{F}$ can be identified with a subsheaf of $\mathcal{W}\cdot \overline{\mathcal{O}_X}\subseteq \mathcal{I}$.
    Let $\mathcal{S}=(\mathcal{I}/\pi_*\mathcal{F})|_Y$. Then we have
    \[
        H^1(X,\mathcal{I}/\pi_*\mathcal{F})\cong H^1(Y,\mathcal{S})=0.  
    \]
    Consider the short exact sequence
    \[
        0\rightarrow \pi_*\mathcal{F}\rightarrow \mathcal{I}\rightarrow \mathcal{I}/\pi_*\mathcal{F}  \rightarrow 0.
    \]
    We conclude that 
    \[
        H^1(X,\mathcal{I})=0.  
    \]
\end{proof}

\begin{corollary}\label{cor-SteinirrcompoiStein}
    Let $X$ be a complex analytic space. Then the following are equivalent:
    \begin{enumerate}
        \item $X$ is Stein;
        \item Each irreducible component of $X^{\Red}$ is Stein if we endow it with the reduced induced structure.
    \end{enumerate}
\end{corollary}
\begin{proof}
    This follows immediately from \cref{cor-Steinnorm}.
\end{proof}

\begin{corollary}
    Let $f:X\rightarrow Y$ be a finite morphism between complex analytic spaces. Then 
    \begin{enumerate}
        \item if $Y$ is Stein, so is $X$;
        \item if $f$ is surjective and $X$ is Stein, then $Y$ is also Stein.
    \end{enumerate}
\end{corollary}
This result is due to Narasimhan \cite{Nar62}, although the statement and the proof in \cite{Nar62} are both incorrect.
\begin{proof}
    Observe that $X$ is paracompact and Hausdorff as in the proof of \cref{lma-branchedcovstein}. By \cref{cor-Steinnorm}, we may assume that $X$ and $Y$ are reduced.

    (1) Observe that $X$ is paracompact and Hausdorff as $f$ is proper. The fact that $X$ is Stein follows from Leray's spectral sequence.

    (2) Observe that $Y$ is by paracompact and Hausdorff by \cref{lma-paracompactpropersurjimage}.
    We may assume that $Y$ is irreducible by \cref{cor-SteinirrcompoiStein}. Up to replacing $X$ by one of its irreducible components whose image under $f$ is $Y$, we may assume that $X$ is also irreducible.
    
    By \cref{Morphisms-cor-liftmorphismtonormalization} in  \nameref{Morphisms-chap-morphismscomplex}, we can find a commutative diagram 
    \[
        \begin{tikzcd}
            \bar{X} \arrow[r, "\bar{f}"] \arrow[d] & \bar{Y} \arrow[d] \\
            X \arrow[r, "f"]                       & Y                
        \end{tikzcd}.  
    \]
    By \cref{cor-Steinnorm}, we are reduced to show that $\bar{X}$ is Stein if and only if $\bar{Y}$ is. But $\bar{f}:\bar{X}\rightarrow \bar{Y}$ is clearly finite and surjective. So it suffices to apply \cref{cor-finitemorphismStein2}.
\end{proof}

\section{Flat locus}


\begin{proposition}\label{prop-previaOX}
    Let $X$ be a reduced complex analytic space, $x\in X$ and $U$ be an open neighbourhood of $x$ in $X$. Consider the following conditions:
    \begin{enumerate}
        \item All irreducible components of $U$ pass through $x$;
        \item $U$ is $\mathcal{O}_X$-previlaged at $x$.
    \end{enumerate}
    Then (1) implies (2). %If moreover $X$ is Stein, then (2) implies (1).
\end{proposition}

\cite{Fri67} also claims that if $U$ is Stein, then (2) implies (1). I cannot figure out a proof. 

\begin{proof}
    (1) $\implies$ (2): Let $s\in H^0(U,\mathcal{F})$ with $s_x=0$. We want to show that $s=0$. By (1), we may assume that $X$ is irreducible. Then $X^{\reg}$ is connected by \cref{Morphisms-cor-irredregularconnected}  in \nameref{Morphisms-chap-morphismscomplex}. 
    As $s_x=0$, $s$ vanishes on a non-empty open subset of $X^{\reg}$ by \cref{PropertyComplex-thm-gensmooth} in \nameref{PropertyComplex-chap-propcomplex}. It follows that $s|_{X^{\reg}}=0$ by IdentitÃ¤tssatz. Hence, $s=0$.

    %(2) $\implies$ (1): We may assume that $X=U$. Let $Y$ be an irreducible component of $X$ such that $x\not\in Y$. Let $\mathcal{I}$ be the coherent ideal sheaf defined by $Y$. By \cref{thm-CartanA}, $H^0(X,\mathcal{I})$ generates $\mathcal{I}_x=\mathcal{O}_{X,x}$. \textcolor{red}{Then???}

\end{proof}

\begin{proposition}\label{prop-previasmallnei}
    Let $X$ be a complex analytic space, $x\in X$ and $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module. There is an open neighbourhood $U$ of $x$ in $X$ and finitely many analytic sets $Y_1,\ldots,Y_m$ in $X$ containing $x$ having the following property: a neighbourhood $V$ of $x$ in $X$ contained in $U$ is $\mathcal{F}$-previlaged at $x$ if $U\cap Y_i$ is $\mathcal{F}|_{Y_i}$-previlaged at $x$ for each $i=1,\ldots,m$. 
\end{proposition}
\begin{proof}
    \textbf{Step~1}. Let 
    \[
        0\rightarrow \mathcal{G}\rightarrow \mathcal{F}\rightarrow \mathcal{H}
    \]
    be an exact sequence of coherent $\mathcal{O}_X$-modules. Suppose that we have proved the proposition with $\mathcal{G}$ and $\mathcal{H}$ in place of $\mathcal{F}$, let us show that the proposition also holds for $\mathcal{F}$. Let $U'$, $Y_1',\ldots,Y_{m'}'$ and $U''$, $Y_1'',\ldots,Y_{m''}''$ be the data in the proposition with respect to $\mathcal{G}$ and $\mathcal{H}$ respectively. We let $U:=U'\cap U''$, $m=m'+m''$ and
    \[
        Y_1=Y_1'\cap U,\ldots,Y_{m'}=Y_{m'}'\cap U, Y_{m'+1}=Y_{1}''\cap U,\ldots,Y_{m'+m''}=Y_{m''}''\cap U.  
    \]
    It follows from \cref{Topology-prop-previalsequence} in \nameref{Topology-chap-topology} that these data have the desired property.

    \textbf{Step~2}. By Jordan--HÃ¶lder theorem, we can find an open neighbourhood $U$ of $x$ in $X$ and a finite chain of coherent $\mathcal{O}_U$-modules 
    \[
        0=\mathcal{F}_0\rightarrow \mathcal{F}_1\rightarrow \cdots \rightarrow \mathcal{F}_n=\mathcal{F}|_U  
    \]
    such that $\mathcal{F}_{i}/\mathcal{F}_{i-1}$ is isomorphic to $\mathcal{O}_{Y_i\cap U}$ for some irreducible reduced closed analytic subspace of $X$ passing through $x$ for $i=1,\ldots,n$. By Step~1, it suffices to handle the case $\mathcal{F}=\mathcal{O}_{Y_i}$ for some $i=1,\ldots,n$. 
    
    \textbf{Step~3}. Let $Y$ be an analytic set in $X$ endowed with the reduced induced structure passing through $x$. Let $V$ be a neighbourhood of $x$ in $X$. We need to show that $V$ is $\mathcal{O}_Y$-previlaged at $x$ if $V\cap Y$ is $\mathcal{O}_{Y}$-previlaged at $x$.
    But both conditions are defined by the injectivity of
    \[
        H^0(V\cap Y,\mathcal{O}_{Y})\cong H^0(V,\mathcal{O}_Y)\rightarrow \mathcal{O}_{Y,x}.     
    \]
    We conclude.
\end{proof}

\begin{proposition}\label{prop-existprenh}
    Let $X$ be a complex analytic space and $A$ be a real semi-analytic set in $X$. Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module. Then any $x\in A$ admits a fundamental system of neighbourhoods in $A$ which are $\mathcal{F}$-previlaged at $x$.
\end{proposition}
\begin{proof}
    Let $U,Y_1,\ldots,Y_m$ be as in \cref{prop-previasmallnei}. Let $\mathcal{B}$ be a fundamental system of neighbourhoods of $x$ in $A$ given by \cref{Topology-prop-fundamentalsysmopnhprevi} in \nameref{Topology-chap-topology}. 
    
    We claim that for any $V\in \mathcal{B}$ contained in $U$, $V$ is $\mathcal{F}$-previlaged at $x$. This claim finishes the proof. In fact, by  \cref{Topology-prop-fundamentalsysmopnhprevi} in \nameref{Topology-chap-topology}, $V$ admits a fundamental system $\mathcal{B}_V$ of neighbourhoods in $X$ such that for $W\in \mathcal{B}_V$, $W\cap Y_i$ is $\mathcal{O}_{Y_i}$-previlaged at $x$ for $i=1,\ldots,m$.  By \cref{prop-previasmallnei}, $W$ is $\mathcal{F}$-previlaged at $x$. But then $V$ is clearly $\mathcal{F}$-previlaged at $x$ as well.
\end{proof}

\begin{proposition}\label{prop-Steinanalyticsetincstable}
    Let $X$ be a complex analytic space and $A$ be a real semi-analytic Stein set in $X$. Let $\mathcal{F}$ be a coherent $\mathcal{O}_A$-module. Consider an increasing net $(\mathcal{F}_j)_{j\in J}$ of coherent $\mathcal{O}_A$-submodules of $\mathcal{F}$, then for any $x\in A$, there is a neighbourhood $W$ of $x$ in $A$ such that $(\mathcal{F}_j|_W)_{j\in J}$ is eventually constant.
\end{proposition}
For us the meaning of Stein set is weaker than in \cite{Fri67}.
\begin{proof}
    As $\mathcal{O}_{X,x}$ is noetherian, the net $(\mathcal{F}_{j,x})_{j\in J}$ is eventually constant. We may assume that it is actually constant. Take $j_0\in J$. Take an open neighbourhood $W$ of $x$ in $A$ which is $\mathcal{F}/\mathcal{F}_{j_0}$-previlaged at $x$. The existence of $W$ follows from \cref{prop-existprenh}.

    We have a commutative diagram
    \[
        \begin{tikzcd}
            0 \arrow[r] & {H^0(W,\mathcal{F}_{j_0})} \arrow[r] \arrow[d] & {H^0(W,\mathcal{F})} \arrow[r] \arrow[d] & {H^0(W,\mathcal{F}/\mathcal{F}_{j_0})} \arrow[d] \\
            0 \arrow[r] & {\mathcal{F}_{j_0,x}} \arrow[r]                & \mathcal{F}_{x} \arrow[r]                & (\mathcal{F}/\mathcal{F}_{j_0})_{x}             
            \end{tikzcd}    
    \]
    with exact rows. We know that the last vertical map is injective. It follows that 
    \[
        H^0(W,\mathcal{F}_{j_0})=H^0(W,\mathcal{F}).
    \]
    So for any $j\geq j_0$,
    \[
        H^0(W,\mathcal{F}_{j_0})=H^0(W,\mathcal{F}_j).
    \]
    So for any $b\in W$, $j\geq j_0$, we have
    \[
        \mathcal{F}_{j,b}=H^0(A,\mathcal{F}_j)\cdot \mathcal{O}_{X,b}=H^0(W,\mathcal{F}_j)\cdot \mathcal{O}_{X,b}=H^0(A,\mathcal{F}_{j_0})\cdot \mathcal{O}_{X,b},
    \]
    where the first equality follows from \cref{thm-CartanA}. That is $(\mathcal{F}_j|_W)_{j\in J}$ is eventually constant.
\end{proof}

\begin{corollary}\label{cor-sheafgeneratedbyseconsascoherent}
    Let $X$ be a complex analytic space and $A$ be a real semi-analytic Stein set in $X$. Let $\mathcal{F}$ be a coherent $\mathcal{O}_A$-module. Consider a subset $E$ of $H^0(A,\mathcal{F})$. The $\mathcal{O}_X$-submodule of $\mathcal{F}$ generated by $E$ is coherent.
\end{corollary}
\begin{proof}
    The result is clear when $E$ is finite. In general, we can write $E$ as the union of all finite subsets of $E$. We then apply \cref{prop-Steinanalyticsetincstable}.
\end{proof}

\begin{thm}\label{thm-cptsteinsetnoetherian}
    Let $X$ be a complex analytic space and $A$ be a quasi-compact real semi-analytic Stein set in $X$. Then $H^0(A,\mathcal{O}_X)$ is noetherian.
\end{thm}
\begin{proof}
    Let $I$ be an ideal of $H^0(A,\mathcal{O}_X)$. By \cref{cor-sheafgeneratedbyseconsascoherent}, the ideal sheaf $\mathcal{I}$ on $A$ generated by $I$ is coherent. As $A$ is quasi-compact, we can find a family of elements $f_1,\ldots,f_n$ in $I$ such that for any $x\in A$, $\mathcal{I}_x$ is generated by $f_{1,x},\ldots,f_{n,x}$ as an $\mathcal{O}_{X,x}$-module. In other words, $\mathcal{O}_A^n\rightarrow \mathcal{I}$ defined by $f_1,\ldots,f_n$ is surjective. It follows that 
    \[
        H^0(A,\mathcal{O}_X)^n\rightarrow H^0(X,\mathcal{I})=I  
    \]
    defined by $f_1,\ldots,f_n$ is surjective. Namely, $I$ is generated by $f_1,\ldots,f_n$ as an $H^0(A,\mathcal{O}_X)$-module.
\end{proof}


\begin{lemma}\label{lma-Steinsetsteinalg}
    Let $X$ be a complex analytic space and $A$ be a quasi-compact real semi-analytic Stein set in $X$. Consider the map
    \[
        A\rightarrow \Spm H^0(A,\mathcal{O}_X)  
    \]
    sending $x\in A$ to the kernel $\mathfrak{n}_x$ of the evaluation map $H^0(A,\mathcal{O}_X) \rightarrow \mathbb{C}$ at $x$.

    If $\mathcal{F}$ is a coherent $\mathcal{O}_A$-module, we have a natural isomorphism
    \[
        H^0(A,\mathcal{F})^{\hat{}}_{\mathfrak{n}_x}\cn \hat{\mathcal{F}}_x.    
    \]
\end{lemma}
\begin{proof}
    \iffalse
    We first show that the map is injective.
    Assume $x,y\in A$, $x\neq y$. As $A$ is Stein, we can find $f\in H^0(A,\mathcal{O}_X)$ with $f(x)=0$ and $f(y)=1$. It follows that the map is injective.

    Next we show that the map is also surjective.\textcolor{red}{To be included}
    \fi

    If suffices to observe that for each $n\in \mathbb{N}$, we have
    \[
        H^0(A,\mathcal{F})/\mathfrak{n}_x^nH^0(A,\mathcal{F})\cn H^0(A,\mathcal{F}/\mathfrak{n}_x^n\mathcal{F})\cn \mathcal{F}/\mathfrak{n}_x^n\mathcal{F}.
    \]  
\end{proof}

\begin{corollary}\label{cor-flatiffalgflat}
    Let $f:X\rightarrow Y$ be a morphism of complex analytic spaces, $x\in X$ and $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module. Let $A$ be a quasi-compact real semi-analytic Stein set in $A$ and $B$ be a quasi-compact  real semi-analytic Stein set in $Y$ such that $f(A)\subseteq B$. Then the following are equivalent:
    \begin{enumerate}
        \item $\mathcal{F}$ is $f$-flat at $x\in X$;
        \item $H^0(A,\mathcal{F})$ is flat at $\mathfrak{n}_x$ with respect to $H^0(B,\mathcal{O}_B)\rightarrow H^0(A,\mathcal{O}_A)$.
    \end{enumerate}
\end{corollary}
\begin{proof}
    By \cref{thm-cptsteinsetnoetherian}, $H^0(A,\mathcal{F})$, $H^0(B,\mathcal{O}_B)$ are both noetherian, so the morphisms 
    \[
        H^0(A,\mathcal{F})_{\mathfrak{n}_x}\rightarrow H^0(A,\mathcal{F})_{\mathfrak{n}_x}^{\hat{}},\quad  H^0(B,\mathcal{O}_Y)_{\mathfrak{n}_y}\rightarrow H^0(B,\mathcal{O}_Y)_{\mathfrak{n}_y}^{\hat{}}
    \]
    are both faithfully flat by \cite[\href{https://stacks.math.columbia.edu/tag/00MC}{Tag 00MC}]{stacks-project}, where $y=f(x)$.
    The assertion now follows from \cref{lma-Steinsetsteinalg}.
\end{proof}



\begin{lemma}\label{lma-existencesteinsemananeigh}
    Let $X$ be a complex analytic space. Then any $x\in X$ has a fundamental system of compact real semi-analytic Stein neighbourhoods.
\end{lemma}
\begin{proof}
    We may assume that $X=\mathbb{C}^n$ for some $n\in \mathbb{N}$. It then suffices to take polycylinders.
\end{proof}

\begin{lemma}\label{lma-standardgenflag}
    Let $Y$ be a reduced complex analytic space, $n\in \mathbb{N}$ and $D\subseteq \mathbb{R}^n$ be an open subset. Set $X=Y\times D$ and $f:X\rightarrow Y$ denotes the projection. Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module, $x=(y,z)\in X$. THen there is an open neighbourhood $V$ of $y$ in $Y$ and a thin analytic set $T$ in $V$ such that $\mathcal{F}$ is $f$-flat at $(y',z)$ for any $y'\not\in V\setminus T$. 
\end{lemma}
\begin{proof}
    Let $L$ be a Stein real semi-analytic compact neighbourhood of $y$ in $Y$. 
    We know that $H^0(L,\mathcal{O}_L)$ is noetherian by \cref{thm-cptsteinsetnoetherian}. Consider the minimal prime ideals $\mathfrak{p}_1,\ldots,\mathfrak{p}_r$ of this ring. Let $Y_1,\ldots,Y_r$ be the analytic sets defined in a neighbourhood of $L$ by these ideals. Discarding the overlaps $Y_i\cap Y_j$ for $i\neq j$, we may assume that $H^0(L,\mathcal{O}_L)$ is integral. Let $\mathcal{I}\subseteq \mathcal{O}_X$ be the ideal sheaf of $Y\times \{z\}$. Let $K=L\times\{z\}$. Then $K$ is a compact real semi-analytic compact subset of $X$. Let $I=H^0(K,\mathcal{I})$, $B=H^0(K,\mathcal{O}_K)$ and $M=H^0(K,\mathcal{F})$. As the comopsition 
    \[
        H^0(L,\mathcal{O}_L)\rightarrow H^0(K,\mathcal{O}_X)  \rightarrow H^0(K,\mathcal{O}_X)/H^0(K,\mathcal{I})
    \]
    is an isomorphism, by \cref{Commutative-lma-flatlocusopenalge} in \nameref{Commutative-chap-commutative}, we can find a non-zero element $h\in H^0(L,\mathcal{O}_L)$ such that $M_{h}$ is $A$-flat in all primes of $V(I_h)$.

    Now consider the analytic set $T$ defined in a neighbourhood of $L$ by $h$. Then for $y'\in L\setminus T$, $\mathcal{F}$ is $f$-flat at $(y',z)$ by \cref{cor-flatiffalgflat}. 
\end{proof}

\begin{thm}\label{thm-flatlocuscoana}
    Let $f:X\rightarrow Y$ be a morphism of complex analytic spaces and $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module, then
    \[
        \left\{ x\in X: \mathcal{F}\text{ is }f\text{-flat at }x   \right\}
    \]  
    is co-analytic in $X$. 
\end{thm}
This theorem was first proved by Frisch in \cite{Fri67}. Here we are following the simplified proof of Kiehl \cite{Kie67}.
\begin{proof}

    The problem is local on $X$. We may assume that $X$ is Hausdorff.
    Fix $x\in X$ and $y=f(x)$. We show that the non-flat locus of $\mathcal{F}$ is analytic at $x$. 

    The problem is local on $X$, we may assume that $X=Y\times \mathbb{C}^n$ for some $n\in \mathbb{N}$.
    Let $B$ be a semi-analytic Stein neighbourhood of $y$ in $Y$, whose existence is guaranteed by \cref{lma-existencesteinsemananeigh}. Take $A=B\times \Delta^n\subseteq X$. Write $D=A\times_B A\subseteq X\times_Y X$.

    Consider the commutative diagram:
    \[
        \begin{tikzcd}
            X\times_Y X \arrow[r,"p_1"] \arrow[d,"p_2"] \arrow[rd, "\square", phantom] & X \arrow[d, "f"] \\
            X \arrow[r, "f"]                                               & Y               
        \end{tikzcd}.    
    \]
    Let $\tilde{F}'=p_1^*\mathcal{F}$.
    By \cref{Morphisms-prop-flatmorphismbasechange}  in \nameref{Morphisms-chap-morphismscomplex}, the non-flat locus of $\mathcal{F}$ is the pull-back of the non-flat locus of $\mathcal{F}'$ with respect to the diagonal morphism. It suffices to prove that the intersection of $\Delta_{X/Y}(X)$ with the non-flat locus of $\mathcal{F}'$ is analytic in $X\times_Y X$. Let $\mathcal{J}$ be the ideal of the diagonal $\Delta_{X/Y}:X\rightarrow X\times_Y X$ of $X\times_Y X$ and $J=H^0(D,\mathcal{J})$. We apply \cref{Commutative-lma-flatlocusopenalge} in \nameref{Commutative-chap-commutative}. It follows that there is an ideal $I$ in $H^0(D,\mathcal{O}_D)$ such that
    \[
        \begin{split}
        \Spec (D/I)\cap \Spec (D/J)=\left\{\mathfrak{m}\in \Spec (D/J): H^0(D,\mathcal{F}')\text{ is not flat at }\mathfrak{m}\right.\\
        \left.\text{ with respect to } H^0(A,\mathcal{O}_A)\rightarrow H^0(D,\mathcal{O}_D) \right\}.  
        \end{split}
    \]
    But by \cref{cor-flatiffalgflat},
    \[
        \left\{x\in \Delta_{X/Y}(B): \mathcal{F}'\text{ is not } p_2\text{-flat at }x  \right\}=\left\{ x\in \Delta_{X/Y}(B): \mathfrak{n}_x\supseteq I\right\}.  
    \]
    The right-hand side is analytic at $x$ since $I$ is finitely generated by \cref{thm-cptsteinsetnoetherian}.
    We conclude.
\end{proof}

\begin{lemma}\label{lma-negliimage}
    Let $f:X\rightarrow Y$ be a morphism of complex analytic spaces. Suppose that $Y$ is reduced and $X$ has a countable basis. Then the following are equivalent:
    \begin{enumerate}
        \item $f(X)$ is negligible in $Y$;
        \item $f$ admits no sections on an open subset $V$ of $Y$.
    \end{enumerate}
\end{lemma}
Here we say a subset of $Y$ is \emph{negligible} if its intersection with $Y^{\reg}$ is an at most countable union of connected locally closed submanifolds with empty interior.

\begin{proof}
   The problem is local on $Y$. We may assume that $Y$ is a complex model space. Then we reduce to the case where $Y$ is a complex manifold. We may also assume that $X$ is reduced. Then $X$ is a locally finite union of locally closed complex manifolds such that $f|_{X_i}$ has constant rank. So we may assume that $f:X\rightarrow Y$ is a morphism of connected complex manifolds of constant rank. Therefore, $f(X)$ is a submanifold of $Y$ and $f$ is a submersion onto $f(X)$. In this case, $f(X)$ is negligible if and only if its interior is empty. In other words, $f$ is nowhere a submersion. The assertion follows.
\end{proof}

\begin{theorem}[Generic flatness]\label{thm-genflatness1}
    Let $f:X\rightarrow Y$ be a morphism of complex analytic spaces and $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module. Assume that $Y$ is reduced and $X$ has countable basis. Then the image of the non-flat locus in $Y$ is negligible.
\end{theorem}
\begin{proof}
    The problem is local on $X$ and $Y$ thanks to the assumption that $X$ has a countable basis. As in the proof of \cref{thm-flatlocuscoana}, we may assume that $X=Y\times D$, where $D$ is a domain in $\mathbb{C}^n$ for some $n\in \mathbb{N}$ and $f:X\rightarrow Y$ is the projection. Let $Z$ be the non-flat locus of $\mathcal{F}$ with respect to $f$.

    By \cref{lma-negliimage}, it suffices to verifty that for any open subset $V\subseteq Y$ and any morphism $g:V\rightarrow D$, the graph of $\varphi$ is not contained in $Z$. Let $D'$ be the image of 
    \[
        V\times D\rightarrow \mathbb{C}^n,\quad (y,z)\mapsto z-g(y).  
    \]
    Then the morphism $V\times D\rightarrow V\times D'$ sending $(y,z)$ to $(y,z-h(y))$ transforms the graph of $g$ into $V\times \{0\}$. We are reduced to the standard situation in \cref{lma-standardgenflag}.
\end{proof}


\section{Grauert's proper image theorem}

In the proof, an open Stein neighbourhood refers to an open neighbourhood which is a Stein space. Namely, we require the paracompactness.

\begin{theorem}[Grauert]\label{thm-properdirectimage}
    Let $f:X\rightarrow Y$ be a morphism of complex analytic spaces and $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module, then $R^if_*\mathcal{F}$ is coherent for $i\in \mathbb{Z}_{\geq 0}$.
\end{theorem}

\textcolor{red}{Consider to reformulate the proof using hypercoverings}
\begin{proof}
    The problem is local on $Y$, so we may assume that $Y$ is a complex model space. Then we reduce immediately to the case where $Y$ is an open subset of $\mathbb{C}^N$ for some $N\in \mathbb{N}$.

    \textbf{Step~1}. We construct a free resolution.

    Let $y_0\in Y$, we can find an open Stein neighbourhood $V_*$ of $y_0$ in $Y$ and finitely many relative charts $U_k\rightarrow \Delta^{n_k} \times V_*$ with $n_k\in \mathbb{N}$ for $k=0,\ldots,k_*$ so that 
    \[
        f^{-1}(V_*)=\bigcup_{k=0}^{k_*}U_k.  
    \]
    For each $r\in (0,1]$ and open subset $V\subseteq V_*$, we write $U_k(r,V)$ for the inverse image of $\Delta^{n_k}(r)\times V$ in $U_k$ for $k=0,\ldots,k_*$. We let $\mathcal{U}(r,V)=\{U_k(r,V)\}_{k=0,\ldots,k_*}$. Take $r_*\in (0,1)$ so that
    \[
        f^{-1}(V)=\bigcup_{k=0}^{k_*} U_k(r,V)  
    \]
    for all $r\in [r_*,1]$. When $V$ is Stein, so are $U_1(r,V),\ldots,U_{k_*}(r,V)$, so $\mathcal{U}(r,V)$ is a Stein covering of $f^{-1}(V)$ for $r\in [r_*,1]$. It follows that 
    \[
        H^q(f^{-1}(V),\mathcal{F})\cong \check{H}^q(\mathcal{U}(r,V),\mathcal{F})
    \]
    for all $q\in \mathbb{Z}_{\geq 0}$ by \cite[\href{https://stacks.math.columbia.edu/tag/03OW}{Tag 03OW}]{stacks-project}.
     
    For each $n\in \mathbb{N}$, we write
    \[
        D_n:=\left\{ (k_0,\ldots,k_n)\in \mathbb{Z}_{\geq 0}^{n+1}: k_0<k_1<\cdots<k_n\leq k_* \right\}
    \]
    and
    \[
        D=\bigcup_{n=0}^{\infty}D_n.  
    \]
    We introduce a partial order on $D$: for $\alpha=(\alpha_0,\ldots,\alpha_n)\in D$, $\beta=(\beta_0,\ldots,\beta_m)\in D$, we write $\alpha\subseteq \beta$ if $\{\alpha_0,\ldots,\alpha_n\}\subseteq \{\beta_0,\ldots,\beta_m\}$. 
    
    For $\alpha=(\alpha_0,\ldots,\alpha_n)\in D$, $r\in [r_*,1]$ and $V$ an open Stein subset of $V$, we write
    \[
        U_{\alpha}(r,V):=\bigcup_{j=0}^n U_{\alpha_j}(r,V),\quad \Delta^{\alpha}(r)=\prod_{j=0}^n \Delta^{\alpha_j}(r).
    \]
    Clearly, we have a morphism
    \[
        U_{\alpha}(r,V)\rightarrow \Delta^{\alpha}(r)\times V.  
    \]
    If $\alpha,\beta\in D$ and $\alpha\subseteq \beta$, we write
    \[
        \pi_{\alpha\beta}: \Delta^{\beta}(r)\times V\rightarrow  \Delta^{\alpha}(r)\times V
    \]
    for the canonical projection. 
    
    Consider the Abelian category $\mathcal{A}(r,V)$ consisting of coherent $\mathcal{O}_{ \Delta^{\alpha}(r)\times V}$-modules $\mathcal{G}_{\alpha}$ for all $\alpha\in D$ and compatible transition morphisms $\varphi_{\beta\alpha}:\mathcal{G}_{\alpha}\rightarrow \pi_{\alpha\beta*}\mathcal{G}_{\beta}$ whenever $\alpha,\beta\in D$ with $\alpha\subseteq \beta$. We will omit $\varphi_{\beta\alpha}$ from our notations if there is no risk of confusion.

    Observe that we have an obvious element $j_*\mathcal{F}\in \mathcal{A}(r,V)$ associated with $\mathcal{F}$ whose components are just the pushforwards of the restrictions of $\mathcal{F}$.
    
    An object $\mathcal{G}=(\mathcal{G}_{\alpha})_{\alpha\in D}\in \mathcal{A}(r,V)$ is free if each $\mathcal{G}_{\alpha}$ is free of finite rank for all $\alpha\in D$.

    Given such an object $\mathcal{G}=(\mathcal{G}_{\alpha})_{\alpha\in D}\in \mathcal{A}(r,V)$ and $n\in \mathbb{N}$, we define
    \[
        \check{C}^n(r,V,\mathcal{G}):=\prod_{\alpha\in D_n} H^0(\Delta^{\alpha}(r)\times V,\mathcal{G}_{\alpha}), 
    \]
    which is an $H^0(V,\mathcal{O}_Y)$-module. We have an obvious differential 
    \[
        \delta:  \check{C}^n(r,V,\mathcal{G})\rightarrow \check{C}^{n+1}(r,V,\mathcal{G})
    \]
    sending $(\xi_{\alpha})_{\alpha\in D_n}$ to $\delta\xi$ with
    \[
        (\delta\xi)_{\beta}=\sum_{i=0}^{n+1}(-1)^i \varphi_{\beta\beta_i}(\xi_{\beta_i}).  
    \]

    Suppose that we are given $\mathcal{G}=(\mathcal{G}_{\alpha},\varphi_{\beta\alpha})\in \mathcal{A}(r,V)$ and $\epsilon_{\alpha}:S_{\alpha}\rightarrow \mathcal{G}_{\alpha}$ for each $\alpha\in D$, where $S_{\alpha}$ is a free $\mathcal{O}_{\Delta^{\alpha}(r)\times V}$-module of finite rank. Then we claim that there is a free system $\mathcal{R}=(\mathcal{R}_{\alpha},\psi_{\beta\alpha})\in \mathcal{A}(r,V)$ and a morphism $\theta:\mathcal{R}\rightarrow \mathcal{G}$ so that
    \[
        \Img \theta_{\alpha}\supseteq \Img \epsilon_{\alpha}  
    \]
    for all $\alpha\in \Delta$.

    To prove this claim, for each $\gamma\in D$, we define $\mathcal{R}^{\gamma}=(\mathcal{R}^{\gamma}_{\alpha},\varphi_{\beta\alpha}^{\gamma})\in \mathcal{A}(r,V)$ as follows:
    \[
        \mathcal{R}^{\gamma}_{\alpha}=\left\{
            \begin{aligned}
                0, & \quad \text{if }\gamma\not\subseteq \alpha;
                \pi_{\gamma\alpha}^*\mathcal{S}_{\gamma},& \quad \text{otherwise}.
            \end{aligned}
        \right.
    \]
    We have an obvious morphism $\mathcal{R}^{\gamma}\rightarrow \mathcal{G}$. We define $\mathcal{R}$ as the componentwise direct sum of $\mathcal{R}^{\gamma}$ for all $\gamma\in \Delta$. Then the natural morphism $\mathcal{R}\rightarrow \mathcal{G}$ satisfies our requirements.

    As a consequence, for any relative compact Stein open subset $V'\subseteq V_*$ and $r'\in [r_*,1)$, we can find a free resolution of $j_*\mathcal{F}$ in $\mathcal{A}(r',V')$.

    Take $r_{**}\in (r_*,1)$. After possibly shrinking $V_*$, we may assume that we have a free resolution of $j_*\mathcal{F}$ in $\mathcal{A}(r_{**},V_*)$:\
    \[
        \cdots\rightarrow \mathcal{R}^2\rightarrow \mathcal{R}^1\rightarrow \mathcal{R}^0\rightarrow j_*\mathcal{F}\rightarrow 0.
    \]
    For any open subset $V\subseteq V_*$, $r\in [r_*,r_**]$, we consider the double complex $(\check{C}^l(r,V;\mathcal{R}^k))_{l,k}$. Let $\check{C}^{\bullet}(r,V)$ be the associated complex. For each $n\in \mathbb{N}$, we regard $V\mapsto \check{C}^n(r,V)$ as an $\mathcal{O}_{V^*}$-module, which is denoted by $\check{C}^n(r)$. Observe that $\check{C}^n(r)=0$ if $n>k_*$.  We have a natural morphism of complexes
    \[
        \check{C}(r)\rightarrow \check{C}(r,j_*\mathcal{F}).
    \]
    We claim that this morphism is a quasi-isomorphism. To see this, let $V$ be a Stein open subset of $V_*$, we need to show that 
    \[
        \check{C}(r,V)\rightarrow \check{C}(r,V,j_*\mathcal{F})
    \]
    is an isomorphism. This follows immediately from Cartan's Theorem~B.

    In particular,
    \[
        (R^qf_*\mathcal{F})|_{V_*}\cong H^q(\check{C}(r))
    \]
    for all $q\in \mathbb{N}$.

    \textbf{Step~2}. The induction scheme.

    We take $r_*,r_{**},V_*$ as in Step~1. Fix $r\in [r_*,r_{**}]$. Fix a compact subset $Q_*$ of $V_*$.
    
    For any $n\in \mathbb{Z}$, $n\in [-1,k_*]$, consider the assertion $A(n)$: there is a Stein open subset $V_n$ of $V_*$ such that $Q_*\subseteq V_n$ and a number $r_n\in (r_*,r_{**}]$, a complex $\mathcal{L}^{\bullet}$ of free $\mathcal{O}_{U_n}$-modules of finite rank whose non-zero terms are in degree $[n,k_*]$, and an $n$-quasi-isomorphism of complexes $\sigma:\mathcal{L}^{\bullet}\rightarrow \check{C}(r_n)$.

    We will by abuse of languages, denote the composition $\mathcal{L}^{\bullet}\rightarrow \check{C}(r_n)\rightarrow \check{C}(r)$ by $\sigma$ as well for any $r\in [r_*,r_n]$. Clearly, this does not affect the validity of $A(n)$.

    Write $K^{\bullet}(r)$ for the mapping cone of $\mathcal{L}^{\bullet}\rightarrow \check{C}(r)$. For each open subset $V\subseteq V_n$, we write $K^m(r,V)=H^0(V,K^m(r))$. We write $Z^{n-1}(r)$ and $Z^{n-1}(r,V)$ for the kernels of $K^{n-1}(r)\rightarrow K^n(r)$ and $K^{n-1}(r,V)\rightarrow K^n(r,V)$ respectively.

    We consider the assertion $B(n-1)$: under the hypothesis of $A(n)$, for any Stein open set $V'\Subset V_n$ and any pair of real numbers $r<r'$, $r,r'\in [r_*,r_n]$, there is a continuous morphism of $\mathcal{O}_{V'}$-modules $\tau:K^{n-1}(r)\rightarrow Z^{n-1}(r')$ such that the following diagram commutes:
    \[
        \begin{tikzcd}
            K^{n-1}(r) \arrow[rd, hook] \arrow[r, "\tau"] & Z^{n-1}(r')          \\
                                                          & Z^{n-1}(r) \arrow[u]
            \end{tikzcd}.
    \]

    We will prove $A(n)+B(n)\implies B(n-1)$ and $A(n)+B(n-1)\implies A(n-1)$ in Step~3.
    
    Here we make some preparations. 

    Let $V$ be an open subset of $V_*$ and $g\in H^0(\Delta^m(r)\times V,\mathcal{O}_{\Delta^m(r)\times V})$. We expand
    \[
        g=\sum_{\alpha\in \mathbb{N}^m} a_{\alpha}z^{\alpha},\quad a_{\alpha}\in H^0(V,\mathcal{O}_V).
    \]
    For each compact subset $Q\subseteq V$ and $\rho\in (0,r)$, we write
    \[
        \|g\|_{\rho Q}:=\sum_{\alpha\in \mathbb{N}^m}\|a_{\alpha}\|_{L^{\infty}(Q)}\rho^{|\alpha|}.
    \]
    The families $\|\bullet\|_{\rho Q}$ for various $\rho$ and $Q$ defines the FrÃ©chet topology on $H^0(\Delta^m(r)\times V,\mathcal{O}_{\Delta^m(r)\times V})$. When $\rho=r$ and $Q=V$, the same deifnition applies, and we get a semi-norm.

    Observe that if $0<r'<r''<r$, then for any $g\in H^0(\Delta^m(r)\times V,\mathcal{O}_{\Delta^m(r)\times V})$, we can uniquely expand it as 
    \[
            g=\sum_{\alpha\in \mathbb{N}^m}a_{\alpha}(z/r'')^\alpha
    \]
    with $\|a_{\alpha}\|_{L^{\infty}(Q)}\leq \|g\|_{r''Q}$ for any compact subset $Q\subseteq V$. Moreover, $\sum_{\alpha\in \mathbb{N}} \|(t/r'')^{\alpha}\|_{r'V}<\infty$.

    Consider a finite number of disks $\Delta^{k_1}(r),\ldots,\Delta^{k_m}(r)$, we write
    \[
            K(r,V):=\prod_{j=1}^m H^0(\Delta^{k_j}(r)\times V,\mathcal{O}_{\Delta^{k_j}(r)\times V}).
    \]
    For $f=(f_j)\in K(r,V)$, we let
    \[
            \|f\|_{\rho Q}:=\max_{j=1,\ldots,m} \|f_j\|_{\rho Q}
    \]
    for each $\rho\in (0,r)$ and a compact set $Q\subseteq V$. We then conclude the following: if $0<r'<r''<r$. Then there is a countable family $(e_i)_{i\in I}$ with the following properties: for any open subset $V'\subseteq V$, any $f\in K(r,V')$ can be uniquely expanded into 
    \[
            f=\sum_{i\in I}a_i e_i
    \]
    with $a_i\in H^0(V',\mathcal{O}_V)$ and $\|a_i\|_{L^{\infty}(Q)}\leq \|f\|_{r'' Q}$ for any compact set $Q\subseteq V'$. Moreover,
    \[
            \sum_{i\in I}\|e_i\|_{r'V}<\infty.
    \]

    We consider another assertion $C(n)$ again under the assumption of $A(n)$: For any Stein open $V'\Subset V_{n+1}$ and any pair $r,r'\in [r_*,r_{n+1}]$ with $r'<r$, there is a continuous $\mathcal{O}_{V'}$-module $\tau:K^n(r)\rightarrow Z^n(r')$ such that
    the following diagram commutes:
    \[
        \begin{tikzcd}
            K^{n-1}(r) \arrow[rd, hook] \arrow[r, "\tau"] & Z^{n-1}(r')          \\
                                                          & Z^{n-1}(r) \arrow[u]
            \end{tikzcd}
    \]  
    and there is acountable family $(e_i)_{i\in I}$ of elements in $K^n(r,V')$ and $\tilde{r}\in (r',r)$ such that
    \begin{enumerate}
        \item for any open subset $V''\subseteq V'$, any $r\in K^n(r,V'')$ can be uniquely expanded into
        \[
            f=\sum_{i\in I}a_i e_i  
        \]
        with $a_i\in H^0(V'',\mathcal{O}_{V'})$ and $\|a_i\|_Q\leq \|f\|_{\tilde{r}Q}$ for any compact set $Q\subseteq V''$;
        \item
        \[
            \sum_{i\in I}\|\tau e_i\|_{r'V'}<\infty.
        \]
    \end{enumerate}

    We observe that $A(n+1)+B(n)\implies C(n)$. In fact, choose a Stein open $\tilde{V}$ so that $V'\Subset 
\tilde{V}\Subset V_{n+1}$ and real numbers $\tilde{r},\rho,\rho'$ so that $r'<\rho'<\rho<\tilde{r}<r$. By B(n), we find $\tilde{\tau}:K^n(\rho)\rightarrow Z^n(\rho')$ over $\tilde{V}$. Consider the commutative diagram
\[
    \begin{tikzcd}
        K^n(r) \arrow[r]           & K^n(\rho) \arrow[r, "\tilde{\tau}"] & Z^n(\rho') \arrow[r] & Z^n(r') \\
        Z^n(r) \arrow[u] \arrow[r] & Z^n(\rho) \arrow[u] \arrow[ru]      &                      &        
        \end{tikzcd}.  
\]
We claim that $\tau:K^n(r)\rightarrow Z^n(r')$ has the required properties. W ehave already shown the first condition. The second condition follows from the fact that $\tilde{\tau}$ is bounded.

\textbf{Step~3}. We prove the induction steps.

\textbf{Step~3.1}. We show that $A(n)+B(n)\implies B(n-1)$. 

Let $r'<r$ be real numbers in $[r_*,r_n]$. Let $V'$ be a realtive compact Stein open subset of $V_n$. Choose a real number $r''\in (r',r)$ and a Stein open set $V''$ such that 
\[
    V'\Subset V''\Subset V_n.
\]
Let $\tau:K^n(r)\rightarrow Z^n(r'')$ and $(e_i\in K^n(r,V''))_{i\in I}$ be obtained by $C(n)$. We have
\[
\sum_{i\in I} \|\tau e_i\|_{r''V''}<\infty.
\]
By $A(n)$, the map $\delta:K^{n-1}(r'',V'')\rightarrow Z^n(r'',V'')$ is continuous and surjective and hence open by Banach's open mapping theorem. We can find $M>0$ and $\xi_i\in K^{n-1}(r'',V'')$ with $\delta\xi_i=\tau e_i$ and $\|\xi_i\|_{r'V'}\leq M\|\tau e_i\|_{r''V''}$. We find that
\[
\sum_{i\in I}\|\xi_i\|_{r'V'}<\infty.    
\]
We have a continuous $\mathcal{O}_{V'}$-morphism
\[
        h:K^n(r)\rightarrow K^{n-1}(r'),\quad \sum_{i\in I}a_i e_i\mapsto \sum_{i\in I}a_i\xi_i
\]
making the following diagram commutative:
\[
    \begin{tikzcd}
        K^n(r) \arrow[d, "h"]           & Z^n(r) \arrow[l] \arrow[d] \\
        K^{n-1}(r') \arrow[r, "\delta"] & Z^n(r')                   
        \end{tikzcd}.    
\]
Now $\tau:=\beta-h\delta:K^{n-1}(r)\rightarrow Z^{n-1}(r')$ satisfies $B(n-1)$, where $\beta:K^{n-1}(r)\rightarrow K^{n-1}(r')$ is the composition of $h$ with $K^{n-1}(r)\rightarrow K^n(r)$.

\textbf{Step~3.2}, We show that $A(n)+B(n-1)\implies A(n-1)$.

Let $V_{n-1}$ be a Stein open subset of $V_*$ so that
\[
    Q_*\subseteq V_{n-1}\Subset V_n.
\]  
Let $r_{n-1}\in (r_*,r_n)$. By $A(n)$, for any $\rho\in [r_{n-1},r_n]$, we have a commutative diagram
\[
    \begin{tikzcd}
        &                                 & \mathcal{L}^n \arrow[d, "\sigma^n"] \arrow[r,"\alpha^n"] & \mathcal{L}^{n+1} \arrow[d] \arrow[r] & \cdots \\
\cdots \arrow[r] & \check{C}^{n-1}(\rho) \arrow[r] & \check{C}^n(\rho) \arrow[r]                   & \check{C}^{n+1}(\rho) \arrow[r]       & \cdots
\end{tikzcd}.    
\]
For each Stein open set $V\subseteq V_n$, we have an epimorphism $H^0(V,\ker \alpha^n)\rightarrow H^n(\check{C}(\rho,V))$. Over $V_{n-1}$, we need to find a free sheaf of finite rank $\mathcal{L}^{n-1}$ and morphisms $\alpha^{n-1}:\mathcal{L}^{n-1}\rightarrow \mathcal{L}^n$ and $\sigma^{n-1}:\mathcal{L}^{n-1}\rightarrow \check{C}^{n-1}(r_{n-1})$ so that 
\begin{enumerate}
    \item $\alpha^{n}\alpha^{n-1}=0$, $\sigma^n\alpha^{n-1}=\delta \sigma^{n-1}$;
    \item for any Stein open $V\subseteq V_{n-1}$, the induced morphism
        \[
            H^0(V,\ker \alpha^n/\Img \alpha^{n-1})\rightarrow H^n(\check{C}(r_{n-1},V))
        \]
        is an isomorphism and
        \[
            H^0(C,\ker \alpha^{n-1}) \rightarrow H^{n-1}(\check{C}(r_{n-1},V)) 
        \]
        is an epimorphism.
\end{enumerate}

It is sufficient to construct $\mathcal{L}^{n-1}$ and a morphism $\mathcal{L}^{n-1}\rightarrow Z^{n-1}(r_{n-1})$ such that for each Stein open subset $V\subseteq V_{n-1}$, the sum of the image of $\omega$ and the image of $\delta:\check{C}(r_{n-1},V)\rightarrow \check{Z}(r_{n-1},V)$ is $\check{Z}(r_{n-1},V)$.

Let $r'\in (r_{n-1},r_n)$. For any Stein open $V\subseteq V_n$, the restriction $\check{C}(r_n,V)\rightarrow \check{C}(r',V)$ is a quasi-isomorphism. Therefore, the sum of the images of $\check{Z}^{n-1}(r_n,V)\rightarrow \check{Z}^{n-1}(r',V)$ and $\check{C}^{n-1}(r',V)\rightarrow \check{Z}^{n-1}(r',V)$ is $\check{Z}^{n-1}(r',V)$.

Consider a Stein open set $V'$ of $V_*$ so that
\[
    V_{n-1}\Subset V'\Subset V_n  
\]
and $r\in (r',r_n)$. By $C(n-1)$, we find a projection $\tau:K^{n-1}(r)\rightarrow Z^{n-1}(r')$ over $V'$, a family $(e_i)_{i\in I}$ of elements in $K^{n-1}(r,V')$ and a real number $\tilde{r}\in (r',r)$ such that $C(n-1)$(1) holds and 
\[
    \sum_{i\in I}\|\tau e_i\|_{r'V'}<\infty.  
\]
As
\[
    \Img (K^{n-1}(r_n)\xrightarrow{\beta}K^{n-1}(r)\xrightarrow{\tau}Z^{n-1}(r))\supseteq \Img(Z^{n-1}(r_n)\xrightarrow Z^{n-1}(r')),    
\]
it follows that the sum of the images of $K^{n-1}(r_n,V')\xrightarrow{\tau\beta} \check{Z}^{n-1}(r',V')$ and $\check{C}^{n-2}(r',V')\rightarrow  \check{Z}^{n-1}(r',V')$ is $ \check{Z}^{n-1}(r',V')$. By open mapping theorem, we cna find $M>0$, $\xi_i\in K^{n-1}(r_n,V')$ and $\eta_i\in \check{C}^{n-2}(r',V')$ so that
\[
    \tau\xi_i+\partial \eta_i=\tau e_i    
\]
and
\[
\max \left\{\|\xi_i\|_{rV_{n-1}},\|\eta_i\|_{r_{n-1}V_{n-1}}\right\}\leq M\|\tau e_i\|_{r'V'}
\]
for each $i\in I$. It follows that 
\[
    \sum_{i\in I} \|\xi_i\|_{rV_{n-1}}<\infty  
\]
and
\[
    \sum_{i\in I}\|\eta_i\|_{r_{n-1}V_{n-1}}=:M_1<\infty.  
\]
Take a finite subset $J\subseteq I$ such that 
\[
    \sum_{i\in I\setminus J}  \|\eta_i\|_{r_{n-1}V_{n-1}}<1/2.
\]
We define $\mathcal{L}^{n-1}=\mathcal{O}_{V_{n-1}}^J$ and $\omega:\mathcal{L}^{n-1}\rightarrow \check{Z}^{n-1}(r_{n-1})$ is the morphism sending the canonical generators $(g_j)_{j\in J}$ of $\mathcal{L}^{n-1}$ to $(\beta' \tau\beta\xi_j)_{j\in J}$, where $\beta':\check{Z}^{n-1}(r')\rightarrow \check{Z}^{n-1}(r_{n-1})$ is the restriction map.

We need to verify that the map $\omega$ satisfies our required properties.

We first show the following: for any open set $V\subseteq V_{n-1}$ and any element $f\in K^{n-1}(r,V)$, there are elements $f_1\in K^{n-1}(r,V)$, $g\in H^0(V,\mathcal{L}^{n-1})$ and $\eta\in \check{C}^{n-1}(r_{n-1},V)$ such that 
\[
    \beta'\tau(f)=\omega(g)+\delta\eta+\beta'\tau(f_1)
\]
and
\[
    \|f_1\|_{rQ}\leq 2^{-1}\|f\|_{\tilde{r}Q},\quad \|g\|_{Q}\leq \|f\|_{\tilde{r}Q} ,\quad \|\eta\|_{r_{n-1}Q}\leq M_1\|f\|_{\tilde{r}Q} 
\]
for any compact subset $Q\subseteq V$.

In fact, expand $f$ as 
\[
    f=\sum_{i\in I}a_i e_i  
\]
with $a_i\in H^0(Vm\mathcal{O}_V)$ and $\|a_1\|_Q\leq \|f\|_{\tilde{r}Q}$ for any compact subset $Q\subseteq V$. We let $f_1=\sum_{i\in I\setminus J}a_i \xi_i$, $g=\sum_{i\in J}a_i g_i$ and $\eta=\sum_{i\in I}a_i\eta_i$, then
\[
    \|f_1\|_{rQ}\leq \sum_{i\in I\setminus J}\|a_i\|_Q\cdot\|\xi_i\|_{rQ}\leq \|f\|_{\tilde{r}Q}\sum_{i\in I\setminus J}\|\xi_i\|_{rQ}\leq 2^{-1}\|f\|_{\tilde{r}Q}
\]
and
\[
\|g\|_Q=\max_{i\in J}\|a_i\|_Q\leq \|f\|_{\tilde{r}Q},\quad \|\eta\|_{r_{n-1}Q}\leq \sum_{i\in I}\|a_i\|_Q\cdot\|\eta_i\|_{r_{n-1}Q}\leq M_1\|f\|_{\tilde{r}Q}.    
\]
Our claim follows.

Finally, let us vefity that $\omega$ satisfies the desired properties. Let $V$ be a Stein open subset of $V_{n-1}$ and $f\in K^{n-1}(r,V)$. By iterating the claim, we find $g\in H^0(V,\mathcal{L}^{n-1})$ and $\eta\in \check{C}^{n-2}(r_{n-1},V)$ so that
\[
    \beta'\tau(f)=\omega(g)+\partial \eta.  
\]
As $\check{C}(r,V)\rightarrow \check{C}(r_{n-1},V)$ is a quasi-isomorphism, we find that 
\[
\check{Z}^{n-1}(r,V)\oplus \check{C}^{n-2}(r_{n-1},V)\rightarrow     \check{Z}^{n-1}(r_{n-1},V)
\]
is surjective. It follows that 
\[
H^0(V,\mathcal{L}^{n-1})\oplus \check{C}^{n-1}(r_{n-1},V)\xrightarrow{\omega\oplus \delta} \check{Z}^{n-1}(r_{n-1},V)
\]
is surjective. So $A(n-1)$ holds.

\textbf{Step~4}. From $A(-1)$, we have a complex of locally free $\mathcal{O}_V$-modules for some open neighbourhood $V$ of $y_0$ in $Y$ and a complex
\[
0\rightarrow \mathcal{L}^{-1}\rightarrow \mathcal{L}^0\rightarrow \cdots\rightarrow \mathcal{L}^{k_*}\rightarrow 0    
\]
such that
\[
    H^q(\mathcal{L}^{\bullet})\cong (R^qf_*\mathcal{F})|_V    
\]
for each $q\in \mathbb{N}$. It follows that $R^qf_*\mathcal{F}$ is coherent.
\end{proof}

\begin{corollary}[Cartan--Serre]
    Let $X$ be a compact complex analytic space and $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module. Then $\dim_{\mathbb{C}}H^n(X,\mathcal{F})<\infty$ for each $n\in \mathbb{N}$.
\end{corollary}
\begin{proof}
    This follows immediately from \cref{thm-properdirectimage} with $Y=\mathbb{C}^0$.
\end{proof}

\begin{corollary}\label{cor-analyticsetpropimage}
    Let $f:X\rightarrow Y$ be a proper morphism. Assume that $Z$ is an analytic set in $X$, then $f(Z)$ is an analytic set in $Y$. 
\end{corollary}
\begin{proof}
    We may assume that $Z=X$. Then $f(X)=\Supp f_*\mathcal{O}_X$. But $f_*\mathcal{O}_X$ is coherent by \cref{thm-properdirectimage}, so $f(X)$ is an analytic set in $Y$.
\end{proof}


\begin{corollary}[Generic flatness]
    Let $f:X\rightarrow Y$ be a proper morphism of complex analytic space and $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module. Assume that $Y$ is reduced. Then the image of the non-flat locus of $\mathcal{F}$ in $Y$ is a nowhere dense analytic subset.
\end{corollary}
\begin{proof}
The problem is local on $Y$, we may assume that $Y$ is a complex model space. In particular, $Y$ has countable basis. After further shrinking $Y$, we may assume that $X$ is covered by finitely many relative charts. In particular, $X$ has countable basis. The image of the flat locus of $\mathcal{F}$ in $Y$ is an analytic set by \cref{cor-analyticsetpropimage} and \cref{thm-flatlocuscoana}. It is nowhere dense by \cref{thm-genflatness1} and the fact that $Y$ is a Baire space. 
\end{proof}



\printbibliography
\end{document}