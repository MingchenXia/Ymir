\input{preamble}
\title{Ymir}
\begin{document}
\maketitle
\tableofcontents

\chapter*{Constructions of complex analytic spaces}\label{chap-constructionComplex}

\section{Introduction}\label{sec-introduction-constructioncomplex}

\section{Analytic spectra}

\begin{proposition}\label{prop-analyticspecrep}
    Let $S$ be a complex analytic space and $\mathcal{A}$ be an $\mathcal{O}_S$-module of finite presentation. Then the presheaf $F_{\mathcal{A}}$ on $\CASCat_{/S}$ defined by
    \[
        F_{\mathcal{A}}(T\xrightarrow{p} S)=\Hom_{\mathcal{O}_T}(p^*\mathcal{A},\mathcal{O}_T)  
    \]
    is representable.
\end{proposition}


\begin{proof}
    By the arguments of \cite[\href{https://stacks.math.columbia.edu/tag/01JJ}{Tag 01JJ}]{stacks-project}, the problem is local in $S$. So we may assume that $\mathcal{A}$ has the following form
    \[
        \mathcal{A}=\mathcal{O}_S[X_1,\ldots,X_n]/\mathcal{I}
    \]   
    for some $n\in \mathbb{N}$ and $\mathcal{I}\subseteq \mathcal{O}_S(S)[X_1,\ldots,X_n]$ an ideal sheaf of finite type. 
    
    \textbf{Step~1}. We first handle the case where $\mathcal{A}=\mathcal{O}_S[X_1,\ldots,X_n]$.

    In this case, we claim that $F_{\mathcal{A}}$ is represented by $S\times \mathbb{C}^n$. In fact, it suffices to observe that 
    \[
        \begin{split}
        F_{\mathcal{A}}(T\xrightarrow{p} S)\cn \Hom_{\mathcal{O}_T}(\mathcal{O}_T[X_1,\ldots,X_n],\mathcal{O}_T)\cn \mathcal{O}_T(T)^n \\
         = \Hom_{\CASCat}(T,\mathbb{C}^n)=\Hom_{\CASCat_{/S}}(T,S\times \mathbb{C}^n).
        \end{split}
    \]
    From this proof, it is easy to see that the universal morphism is 
    \[
        \eta:\mathcal{O}_{S\times \mathbb{C}^n}[X_1,\ldots,X_n]\rightarrow \mathcal{O}_{S\times \mathbb{C}^n}
    \]
    sending $X_i$ to $z_i$, the $i$-th coordinate of $\mathbb{C}^n$.

    \textbf{Step~2}. We handle the general case.
    We have a short exact sequence
    \[
        0\rightarrow \mathcal{I}\rightarrow \mathcal{O}_S[X_1,\ldots,X_n]\rightarrow \mathcal{A}\rightarrow 0.
    \]    
    For any $p:T\rightarrow S$ in $\CASCat$, we have an exact sequence
    \[
        p^*\mathcal{I}\rightarrow \mathcal{O}_T[X_1,\ldots,X_n]\rightarrow p^*\mathcal{A}\rightarrow 0.
    \]
    We then have
    \[
        \begin{aligned}
        F_{\mathcal{A}}(T)\cn & \left\{ h\in \Hom_{\mathcal{O}_T}(\mathcal{O}_T[X_1,\ldots,X_n],\mathcal{O}_T): h|_{p^*\mathcal{I}}=0  \right\}\\
        \cn & \left\{ h\in F_{\mathcal{O}_S[X_1,\ldots,X_n]}(T): h|_{p^*\mathcal{I}}=0  \right\}.
        \end{aligned}
    \]
    Let $\pi:S\times \mathbb{C}^n\rightarrow S$ be the projection. Then $F_{\mathcal{A}}(T)$ is represented by the closed subspace of $S\times \mathbb{C}^n$ defined by the ideal $\eta(\pi^* \mathcal{I})$, which is clearly of finite type.
\end{proof}

\begin{definition}
    Let $S$ be a complex analytic space and $\mathcal{A}$ be an $\mathcal{O}_S$-module of finite presentation. Then the complex analytic space representing the functor $F_{\mathcal{A}}$ in \cref{prop-analyticspecrep} is called the \emph{analytic spectrum} of $\mathcal{A}$. We denote it by $\Spec^{\An}_S \mathcal{A}$. By construction, there is a canonical morphism $\Spec^{\An}_S \mathcal{A}\rightarrow S$.

    By definition, we have a universal morphism $\xi\in F_{\mathcal{A}}(X)=\Hom_{\mathcal{O}_X}(\mathcal{A}_X,\mathcal{O}_X)$ with $X=\Spec^{\An}_S \mathcal{A}$. It defines a morphism of ringed spaces $X\rightarrow (|S|,\mathcal{A})$. The pull-back of an $\mathcal{A}$-module $\mathcal{M}$ is denoted by $\tilde{\mathcal{M}}$. The assignment $\mathcal{M}\mapsto \tilde{\mathcal{M}}$ is functorial in $M$.
\end{definition}
It is easy to see that $\Spec^{\An}_S \mathcal{A}$ is contravaraint in $\mathcal{A}$. 



\begin{proposition}\label{prop-specanbasechange}
    Let $S$ be a complex analytic space and $\mathcal{A}$ be an $\mathcal{O}_S$-module of finite presentation. Consider a morphism $g:S'\rightarrow S$ of complex analytic spaces. Then we have a Cartesian diagram
    \[
        \begin{tikzcd}
            \Spec^{\An}_{S'} g^*\mathcal{A} \arrow[d] \arrow[r] \arrow[rd, "\square", phantom] & \Spec^{\An}_S \mathcal{A} \arrow[d] \\
            S' \arrow[r, "g"]                                                                  & S                                  
        \end{tikzcd}
    \]
\end{proposition}
\begin{proof}
    This is clear at the level of functor of points.
\end{proof}

\begin{corollary}\label{cor-fiberspecan}
    Let $S$ be a complex analytic space and $\mathcal{A}$ be an $\mathcal{O}_S$-module of finite presentation. Take $s\in S$. Then $\Spec^{\An}_{\{s\}} \mathcal{A}_s\cn (\Spec^{\An}_S \mathcal{A})_s$. 
    
    Moreover, the universal morphism $\mathcal{A}_{\Spec^{\An}_{\{s\}} \mathcal{A}_s}\rightarrow \mathcal{O}_{\Spec^{\An}_{\{s\}} \mathcal{A}_s}$ is the reduction of the universal morphism $\mathcal{A}_{\Spec^{\An}_S \mathcal{A}}\rightarrow \mathcal{O}_{\Spec^{\An}_S \mathcal{A}}$ modulo $\mathfrak{m}_s$.
\end{corollary}
\begin{proof}
    This follows from \cref{prop-specanbasechange}.
\end{proof}


\begin{proposition}\label{prop-specanlocalringcompletion}
    Let $S$ be a complex analytic space and $\mathcal{A}$ be an $\mathcal{O}_S$-module of finite presentation. Take $s\in S$.
    Write $X=\Spec^{\An}_S \mathcal{A}$ and $\mathcal{A}_s:=\mathcal{A}\otimes_{\mathcal{O}_S}\mathcal{O}_{S,s}$. Then the map from $X_s$ to 
    \[
        \left\{ \mathfrak{m}\in \Spm_{\mathbb{C}} \mathcal{A}_s : \mathfrak{m}\supseteq\mathfrak{m}_s  \right\}
    \]
    sending $x\in X_s$ to the inverse image of $\mathfrak{m}_x$ with respect to $\mathcal{A}_s\rightarrow \mathcal{O}_{X,x}$ is bijective.

    If $\mathfrak{m}$ corresponds to $x\in X_s$, then the natural homomorphism $\mathcal{A}_s\rightarrow \mathcal{O}_{X,x}$ factorizes through $\mathcal{A}_{s,\mathfrak{m}}\rightarrow  \mathcal{O}_{X,x}$. The completion of the latter
    \[
        \widehat{\mathcal{A}_{s,\mathfrak{m}}}\rightarrow   \widehat{\mathcal{O}_{X,x}}
    \]
    is an isomorphism.
\end{proposition}
\begin{proof}
    By \cref{cor-fiberspecan}, we have natural bijections
    \[
        X_s\cn \Hom_{\{s\}}(\{s\},X_s)\cn \Hom_{\mathbb{C}\text{-}\AlgCat}(\mathcal{A}_s/\mathfrak{m}_s\mathcal{A}_s, \mathbb{C}).
    \]  
    This gives the desired bijection.

    Next we prove the latter part. The problem is local on $S$, we may assume that 
    \[
        \mathcal{A}=\mathcal{O}_S[X_1,\ldots,X_n]/\mathcal{I}
    \]  
    for some $n\in \mathbb{N}$ and some ideal $\mathcal{I}$ of finite type in $\mathcal{O}_S[X_1,\ldots,X_n]$. Recall that the universal morphism
    \[
        \eta:\mathcal{O}_{S\times \mathbb{C}^n}[X_1,\ldots,X_n]\rightarrow \mathcal{O}_{S\times \mathbb{C}^n}
    \]
    sends $X_i$ to $z_i$, the $i$-th coordinate of $\mathbb{C}^n$.

    By construction, we have
    \[
        \mathcal{A}_s\cn \mathcal{O}_{S,s}[X_1,\ldots,X_n]/\mathcal{I}_s  
    \]
    and
    \[
        \mathcal{O}_{X,x}=\mathcal{O}_{S\times \mathbb{C}^n,x}/\mathcal{J}_x,  
    \]
    where
    \[
        \mathcal{J}_x=\eta_x\left( \mathcal{I}_s \mathcal{O}_{S\times \mathbb{C}^n,x}[X_1,\ldots,X_n] \right).   
    \]
    We have a commutative diagram with exact rows
    \[
        \begin{tikzcd}
            0 \arrow[r] & \mathcal{I}_s \arrow[r] \arrow[d] & {\mathcal{O}_{S,s}[X_1,\ldots,X_n]} \arrow[r] \arrow[d] & \mathcal{A}_s \arrow[r] \arrow[d] & 0 \\
            0 \arrow[r] & \mathcal{J}_x \arrow[r]           & {\mathcal{O}_{S\times \mathbb{C}^n,x}} \arrow[r]        & {\mathcal{O}_{X,x}} \arrow[r]     & 0
        \end{tikzcd}.  
    \]
    The middle vertical map is induced by $\eta_x$.
    Let $\mathfrak{p}$ be the inverse image of $\mathfrak{m}_{S\times \mathbb{C}^n,x}$ under the vertical map in the middle. Then $\mathfrak{p}$ is generated by $\mathfrak{m}_s$ and $X_1-x_1,\ldots,X_n-x_n$, where $x_i\in \mathbb{C}$ is the value of $z_i$ at $x$ for $i=1,\ldots,n$.  By localization and completion, we find a commutative diagram with exact rows
    \[
        \begin{tikzcd}
            0 \arrow[r] & \widehat{(\mathcal{I}_s)_{\mathfrak{p}}} \arrow[r] \arrow[d] & {(\mathcal{O}_{S,s}[X_1,\ldots,X_n])^{\hat{}}_{\mathfrak{p}}} \arrow[r] \arrow[d] & \widehat{(\mathcal{A}_s)_{\mathfrak{m}}} \arrow[r] \arrow[d] & 0 \\
            0 \arrow[r] & \widehat{\mathcal{J}_x} \arrow[r]           & \widehat{\mathcal{O}_{S\times \mathbb{C}^n,x}} \arrow[r]        & \widehat{\mathcal{O}_{X,x}} \arrow[r]     & 0
        \end{tikzcd}.  
    \]
    Observe that
    \[
        (\mathcal{O}_{S,s}[X_1,\ldots,X_n])^{\hat{}}_{\mathfrak{p}}  \cong \widehat{\mathcal{O}_{S,s}}[[X_1-x_1,\ldots,X_n-x_n]]
    \]
    and
    \[
        \widehat{\mathcal{O}_{S\times \mathbb{C}^n,x}}\cong \widehat{O_{S,s}}\hat{\otimes}_k  \widehat{\mathcal{O}_{\mathbb{C}^n,(x_1,\ldots,x_n)}}\cong \widehat{\mathcal{O}_{S,s}}[[X_1-x_1,\ldots,X_n-x_n]].
    \]
    It is easy to see that the middle map is an isomorphism. As $\mathcal{J}_x$ is generated by $\mathcal{I}_s$, the first vertical map is also an isomorphism. Our assertion follows. 
\end{proof}


\begin{corollary}\label{cor-finitespectrumidentification}
    Let $S$ be a complex analytic space and $\mathcal{A}$ be a finite $\mathcal{O}_S$-algebra. Write $X=\Spec^{\An}_S\mathcal{A}$.
    Take $s\in S$. Then the fiber $X_s$ is finite and is in bijection with $\Spm_{\mathbb{C}} \mathcal{A}_s=\Spm \mathcal{A}_s$. If $\mathfrak{m}$ corresponds to $x\in X_s$, then we have a natural isomorphism 
    \[
        \mathcal{A}_{s,\mathfrak{m}}\cn \mathcal{O}_{X,x}.  
    \]
\end{corollary}
\begin{proof}
    We first observe that as $\mathcal{A}_s$ is a finite $\mathcal{O}_{S,s}$-algebra, its residue fields at maximal primes are finite extensions of the residue field $\mathbb{C}$ of $\mathcal{O}_{S,s}$. So $\Spm_{\mathbb{C}} \mathcal{A}_s=\Spm \mathcal{A}_s$.

    As $\mathcal{O}_{S,s}\rightarrow \mathcal{A}_s$ is finite, $\mathcal{A}_s$ is semi-local. On the other hand, by \cref{prop-specanlocalringcompletion}, 
    \[
        \mathcal{A}_{s,\mathfrak{m}}\rightarrow   \mathcal{O}_{X,x}
    \]
    is injective and $\mathcal{O}_{X,x}$ is quasi-finite over $\mathcal{O}_{S,s}$. 
    Then $\mathcal{O}_{X,x}$ is finite over $\mathcal{O}_{S,s}$ by \cref{Local-thm-analyticquasifiniteifffinite} in \nameref{Local-chap-local}.
    It follows from Nakayama's lemma that $\mathcal{A}_{s,\mathfrak{m}}\rightarrow   \mathcal{O}_{X,x}$ is also surjective.
\end{proof}

\begin{corollary}\label{cor-suppaffmorphism}
    Let $S$ be a complex analytic space and $\mathcal{A}$ be a finite $\mathcal{O}_S$-algebra. Then the image of $\Spec^{\An}_S\mathcal{A}\rightarrow S$ is $\Supp \mathcal{A}$.
\end{corollary}
\begin{proof}
    This follows from \cref{cor-finitespectrumidentification} and the fact that $\Spm_{\mathbb{C}}\mathcal{A}_s=\Spm\mathcal{A}_s$ for all $s\in S$.
\end{proof}


\begin{proposition}\label{prop-moduletildepush}
    Let $S$ be a complex analytic space and $\mathcal{A}$ be a finite $\mathcal{O}_S$-algebra. Write $f:\Spec^{\An}_S \mathcal{A}$ for the structure map.
    Then we have the following assertions:
    \begin{enumerate}
        \item for all $\mathcal{A}$-module $\mathcal{M}$, the natural morphism 
        \[
            \mathcal{M}\rightarrow f_*\tilde{\mathcal{M}}  
        \]
        is an isomorphism, 
    
        In particular, $\mathcal{A}\cn f_*\mathcal{O}_X$.
        \item for all $\mathcal{O}_X$-module $\mathcal{F}$, the canonical morphism
            \[
                \widehat{f_*\mathcal{F}}\rightarrow \mathcal{F}
            \]
            is an isomorphism.
    \end{enumerate}
    In particular, the category of $\mathcal{A}$-modules is equivalent to the cateogory of $\mathcal{O}_X$-modules.
\end{proposition}
\begin{proof}
    By \cref{cor-specanfinitetopfinite}, $f$ is topologically finite. 
    Take $s\in S$. 
    Let $x_1,\ldots,x_n$ be the distinct points of $f^{-1}(s)$ and $\mathfrak{m}_1,\ldots,\mathfrak{m}_n$ denote the maximal ideals of $\mathcal{A}_s$ corresponding to $x_1,\ldots,x_n$.

    (1)    
    By \cref{Topology-cor-pushforwardsheaffinite} in \nameref{Topology-chap-topology} and \cref{cor-finitespectrumidentification},  
    \[
        (f_*\tilde{\mathcal{M}})_s\cong \prod_{i=1}^n \widehat{M}_{x_i}\cong \prod_{i=1}^n \widehat{\mathcal{M}}_s\otimes_{\mathcal{A}_s}\mathcal{O}_{X,x_i}\cong \mathcal{M}_s \otimes_{\mathcal{A}_s}\prod_{i=1}^n \mathcal{A}_{s,\mathfrak{m}_i}\cn \mathcal{M}_s.
    \]

    (2) By \cref{Topology-cor-pushforwardsheaffinite} in \nameref{Topology-chap-topology},
    \[
        f_*\mathcal{F}_s\cong \prod_{i=1}^n \mathcal{F}_{x_i}.  
    \]
    It follows that 
    \[
        \widetilde{f_*\mathcal{M}}_{x_i}\cong f_*\mathcal{F}_s\otimes_{\mathcal{A}_s} \mathcal{O}_{X,x_i}\cong \prod_{j=1}^n \mathcal{F}_{x_j}\otimes_{\mathcal{A}_s} \mathcal{A}_{s,\mathfrak{m}_i}
    \]
    for $i=1,\ldots,n$. But the only non-zero term is when $j=i$, so 
    \[
        \widetilde{f_*\mathcal{M}}_{x_i}\cong \mathcal{F}_{x_i}  
    \]
    for $i=1,\ldots,n$.
\end{proof}
\begin{corollary}\label{cor-specpushcohiscoh}
    Let $S$ be a complex analytic space and $\mathcal{A}$ be a finite $\mathcal{O}_S$-algebra. Write $f:\Spec^{\An}_S \mathcal{A}$ for the structure map. Then for any coherent $\mathcal{O}_X$-module $\mathcal{M}$, $f_*\mathcal{F}$ is coherent.

    Moreover, $f_*$ is exact from $\CohCat(\mathcal{O}_X)$ to
    $\CohCat(\mathcal{O}_Y)$.
\end{corollary}
\begin{proof}
    The exactness of $f_*$ follows from \cref{prop-moduletildepush}.

    We claim that up to shrinking $S$, we may assume that $\mathcal{M}$ has a global presentation. Fix $s\in S$ and let $x_1,\ldots,x_n$ be the distinct points of $f^{-1}(s)$.
    
    For each $j=1,\ldots,n$, we can find an open neighbourhood $U_j$ of $x_j$ in $X$, pairwise disjoint and an exact sequence 
    \[
        \mathcal{O}_{U_j}^{p_j}\rightarrow \mathcal{O}_{U_j}^{q_j}\rightarrow \mathcal{M}|_{U_j}\rightarrow 0
    \]
    for some $p_j,q_j\in \mathbb{Z}_{>0}$.  We may assume that $p_1=\cdots=p_n$ and $q_1=\cdots=q_n$. We denote the common values by $p$ and $q$. Then $U=U_1\cup\cdots\cup U_n$ is a neighbourhood of $f^{-1}(s)$, and we have an exact sequence 
    \[
        \mathcal{O}_{U}^{p}\rightarrow \mathcal{O}_{U}^{q}\rightarrow \mathcal{M}|_{U}\rightarrow 0.
    \]
    By \cref{Topology-lma-opennhfiberclosedmap} in \nameref{Topology-chap-topology},
    we may assume that $U=\pi^{-1}(V)$ for some open neighbourhood $V$ of $s$ in $S$. The induced map $f':U\rightarrow V$ is finite and by \cref{Topology-cor-pushforwardsheaffinite} in \nameref{Topology-chap-topology}.

    Now let us take a presentation
    \[
        \mathcal{O}^{p}\rightarrow \mathcal{O}^{q}\rightarrow \mathcal{M}\rightarrow 0.
    \]
    By \cref{prop-moduletildepush}, we have an exact sequence
    \[
        f_*  \mathcal{O}^{p}\rightarrow f_* \mathcal{O}^{q}\rightarrow f_* \mathcal{M}\rightarrow 0.
    \]
    By \cref{prop-moduletildepush} again, this can be written as
    \[
        \mathcal{A}^p\rightarrow \mathcal{A}^q\rightarrow   f_* \mathcal{M}\rightarrow 0.
    \]
    It follows that $f_*\mathcal{M}$ is coherent.
\end{proof}

\begin{proposition}\label{prop-morphismrelaffspaces}
    Let $S$ be a complex analytic space and $\mathcal{A}$, $\mathcal{B}$ be $\mathcal{O}_S$-algebras of finite presentation. Assume that $\mathcal{A}$ is finite. Then we have a natural bijection
    \[
        \Hom_{\mathcal{O}_S}(\mathcal{B},\mathcal{A})\cn \Hom_{\CASCat_{/S}}(\Spec^{\An}_S \mathcal{A},\Spec^{\An}_S \mathcal{B}).  
    \]
\end{proposition}
\begin{proof}
    Let $f:X:=\Spec^{\An}_S\mathcal{A}\rightarrow S$ be the natural map.
    We construct the bijection as
    \[
        \Hom_{\mathcal{O}_S}(\mathcal{B},\mathcal{A})\cn \Hom_{\mathcal{O}_S}(\mathcal{B},f_*\mathcal{O}_X)\cn \Hom_{\mathcal{O}_X}(\mathcal{B}_X,\mathcal{O}_X)\cn \Hom_{\CASCat_{/S}}(\Spec^{\An}_S \mathcal{A},\Spec^{\An}_S \mathcal{B}).
    \]
    The first map is a bijection by \cref{prop-moduletildepush}
\end{proof}

\begin{definition}
    Let $S$ be a complex analytic space and $\mathcal{E}$ be an $\mathcal{O}_S$-module of finite presentation. We define the \emph{vector bundle} $\mathbf{V}(\mathcal{E})$ generated by $\mathcal{E}$ as
    \[
        \mathbf{V}(\mathcal{E})=\Spec^{\An}_S \Sym \mathcal{E}.
    \]
    We have a natural projection $\mathbf{V}(\mathcal{E})\rightarrow S$.
\end{definition}
We remind the readers that we are following Grothendieck's convention for $\mathbf{V}(\mathcal{E})$, which is different from Fulton's.



\section{Analytic germs}

\begin{definition}\label{def-complexgerm}
    A \emph{pointed complex analytic space} is a pair $(X,x)$ consisting of a complex analytic space $X$ and a point $x\in X$. A morphism between pointed complex analytic spaces $(X,x)$ and $(Y,y)$ is a morphism $f:X\rightarrow Y$ of complex analytic spaces such that $f(x)=y$. The category of pointed complex analytic spaces is denoted by $\CASCat_*$. 
    

    The category of \emph{complex analytic germs} $\AnaGerCat$ is the right category of fractions of $\CASCat$ with respect to the system of morphisms $f:(X,x)\rightarrow (Y,y)$ such that $f:X\rightarrow Y$ is an open immersion. An element in $\AnaGerCat$ is called a \emph{complex analytic germ}. A complex analytic germ represented by $(X,x)$ is denoted by $X_x$.

    Given a complex analytic germ $X_x$, we write $\mathcal{O}_{X,x}$ for the local ring of $X$ at $x$. Clearly, it does not depend on the choice of $(X,x)$. Given any morphism $f:X_x\rightarrow Y_y$ of complex analytic germs, we have an obvious local homomorphism $f^{\#}:\mathcal{O}_{Y,y}\rightarrow \mathcal{O}_{X,x}$.
\end{definition}


\begin{definition}\label{def-closedsubgerm}
    Given a complex analytic germ $X_x$, a \emph{closed subgerm} of $X_x$ is an isomorphism class in $\AnaGerCat_{/X_x}$ of $Y_x$ represented by a closed analytic subspace of $X$ containing $x$ for any representation $(X,x)$ of $X_x$.

    In particular, $X_x$ is a closed subgerm of $X_x$. A closed subgerm $Y_y$ of $X_x$ is \emph{proper} if $Y_y$ is different from $X_x$ as subgerms. 

    Given a closed subgerm $Y_x$ of $X_x$, we have an induced surjective homomorphism $\mathcal{O}_{X,x}\rightarrow \mathcal{O}_{Y,y}$. The kernel is denoted by $I(Y,x)$ or $I_X(Y,x)$.
\end{definition}

\begin{thm}\label{thm-germlocalringequivalence}
    The functor $\AnaGerCat^{\mathrm{op}}\rightarrow \CLA$ defined in \cref{def-complexgerm} is an equivalence.
\end{thm}
\begin{proof}
    \textbf{Step~1}. We show that the functor is faithfully. 
    
    In order words, let $(X,x)$ and $(Y,y)$ be two pointed complex analytic spaces and $f,g:(X,x)\rightarrow (Y,y)$ be two morphsims inducing the same map $\mathcal{O}_{Y,y}\rightarrow  \mathcal{O}_{X,x}$, then $f$ and $g$ coincide on a neighbourhood of $x$ in $X$.

    The question is open on $Y$, so we may reduce to the case where $Y$ is a complex model space.  We then further reduce to the case where $Y$ is a domain in $\mathbb{C}^n$ for some $n\in \mathbb{N}$ and then to $Y=\mathbb{C}^n$.

    By \cref{Complex-thm-hCnidentification} in \nameref{Complex-chap-complex}, $f$ and $g$ can be identified with systems $(f_1,\ldots,f_n)\in \mathcal{O}_X(X)^n$ and $(g_1,\ldots,g_n)\in \mathcal{O}_X(X)^n$. The assumption $f_x^{\#}=g_x^{\#}$ menas $f_{i,x}=g_{i,x}$ for $i=1,\ldots,n$. So $f_i=g_i$ after shrinking $X$. We conclude by  \cref{Complex-thm-hCnidentification} in \nameref{Complex-chap-complex} again.

    \textbf{Step~2}. We show that the functor is fully faithful. 
    
    In other words, let $(X,x)$ and $(Y,y)$ be two pointed complex analytic spaces and $\varphi:\mathcal{O}_{Y,y}\rightarrow \mathcal{O}_{X,x}$ be a morphism in $\CLA$. Then we can find an open neighbourhood $U$ of $x$ in $X$ and a morphism $(U,x)\rightarrow (Y,y)$ inducing $\varphi$.

    The problem is local on $Y$, so we may assuem that $Y$ is a complex model space, say $Y$ is a closed subspace of a domain $V$ in $\mathbb{C}^n$ defined by a coherent ideal $\mathcal{I}$. We write $\psi:\mathcal{O}_{V,y}\rightarrow \mathcal{O}_{X,x}$ the homomorphism induced by $\varphi$, we have a commutative diagram
    \[
        \begin{tikzcd}
            {\mathcal{O}_{V,y}} \arrow[d, two heads] \arrow[r, "\psi"] & {\mathcal{O}_{Y,y}} \\
            {\mathcal{O}_{X,x}} \arrow[ru, "\varphi"]                  &                    
        \end{tikzcd}.  
    \]
    Let $z_1,\ldots,z_n$ be the coordinates on $V$.
    Let $f_{i,x}$ be the image of $z_{i,x}$ under $\psi$ for $i=1,\ldots,n$. Take an open neighbourhood $U$ of $x$ in $X$ so that $f_{i,x}$ lifts to $f_i\in \mathcal{O}_X(U)$ for $i=1,\ldots,n$. By \cref{Complex-thm-hCnidentification} in \nameref{Complex-chap-complex}, $f_1,\ldots,f_n$ then defines a morphism $g:U\rightarrow \mathbb{C}^n$. Clearly $g(x)=y$. But $g_x^{\#}$ and $\psi$ coincide on $z_{i,y}$ so $g_x^{\#}=\psi$ as $\mathcal{O}_{V,y}=\mathbb{C}\{z_{1,y}-a_1,\ldots,z_{n,y}-a_n\}$ with $a_i=\epsilon(z_{i,y})$ for $i=1,\ldots,n$. Therefore, $g_x^{\#}(\mathcal{I}_y)=0$. Up to shrinking $U$, we may guarantee that $g(U)\subseteq V$ and $g^*(\mathcal{I})=0$ on $U$. Namely, $g$ factorizes through $f:U\rightarrow Y$ and $f^*_x=\varphi$.

    \textbf{Step~3}. We show that the functor is essentially surjective.

    In other words, let $A$ be a complex analytic local algebra, then there is a pointed complex analytic space $(X,x)$ with $\mathcal{O}_{X,x}\cong A$ in $\CLA$.

    We may assume that $A=\mathbb{C}\{z_1,\ldots,z_n\}/I$ for some $n\in \mathbb{N}$ and ideal $I$ in $\mathbb{C}\{z_1,\ldots,z_n\}$. Then $I$ is finitely generated as $\mathbb{C}\{z_1,\ldots,z_n\}$ is noetherian. Take finitely many generators $f_1,\ldots,f_m\in I$. We extend $f_1,\ldots,f_m$ to $g_1,\ldots,g_m\in \mathcal{O}_{\mathbb{C}^n}(U)$ for some open neighbourhood $U$ of $0$ in $\mathbb{C}^n$. Then the closed subspace $X$ of $U$ defined by $f_1,\ldots,f_m$ satisfies the required conditions.
\end{proof}

\begin{corollary}\label{cor-localisocondition}
    Let $f:X\rightarrow Y$ be a morphism of complex analytic spaces and $x\in X$. Then the following are equivalent:
    \begin{enumerate}
        \item $f$ is a local isomorphism;
        \item $f^{\#}_x:\mathcal{O}_{Y,f(x)}\rightarrow \mathcal{O}_{X,x}$ is an isomorphism;
        \item $\widehat{f^{\#}_x}:\hat{O}_{Y,f(x)}\rightarrow \hat{O}_{X,x}$ is an isomorphism.
    \end{enumerate}
\end{corollary}
Later on, we will see that Condition~(3) means $f$ is étale at $x$.
\begin{proof}
    (1) $\Leftrightarrow$  (2): This follows from \cref{thm-germlocalringequivalence}.

    (2) $\implies$ (3): This is clear.

    (3) $\implies$ (2): As $f^{\#}_x$ is quasi-finite, the $\mathfrak{m}_x$-adic topology on $\mathcal{O}_{X,x}$ coincides with the $\mathfrak{m}_{f(x)}$-adic topology on it regarded as an $\mathcal{O}_{Y,f(x)}$-module.
    By \cref{Local-thm-analyticquasifiniteifffinite} in 
    \nameref{Local-chap-local}, $f^{\#}_x$ is finite. 
    So
    \[
        \hat{\mathcal{O}}_{X,x}\cn \mathcal{O}_{X,x}\otimes_{\mathcal{O}_{Y,f(x)}}\hat{\mathcal{O}}_{Y,f(x)}.
    \]
    So (2) follows from the fact that $\hat{\mathcal{O}}_{Y,f(x)}$ is faithfully flat over $\mathcal{O}_{Y,f(x)}$, see \cite[\href{https://stacks.math.columbia.edu/tag/00MC}{Tag 00MC}]{stacks-project}.
\end{proof}

\begin{corollary}\label{cor-localimmersioncond}
    Let $f:X\rightarrow Y$ be a morphism of complex analytic spaces and $x\in X$. Then the following are equivalent:
    \begin{enumerate}
        \item $f$ is a local immersion at $x$;
        \item $f^{\#}_x:\mathcal{O}_{Y,f(x)}\rightarrow \mathcal{O}_{X,x}$ is surjective;
        \item $\widehat{f^{\#}_x}:\hat{O}_{Y,f(x)}\rightarrow \hat{O}_{X,x}$ is surjective;
        \item $\mathcal{O}_{X,x}/\mathfrak{m}_{f(x)}\mathcal{O}_{X,x}\cn \mathbb{C}$.
    \end{enumerate}
\end{corollary}
\begin{proof}
    (1) $\implies$ (2): This is clear.

    (2) $\implies$ (1): Let $I$ be the kernel of $f^{\#}_x$. Up to shrinking $X$, we may assume that $I$ spreads to a coherent ideal sheaf $\mathcal{I}$ on $Y$. Let $Y'$ be the closed analytic subspace of $Y$ defined by $\mathcal{I}$. Up to shrinking $X$, we may assume that $f$ factorizes through $f':X\rightarrow Y'$ by \cref{thm-germlocalringequivalence}. But $f'^{\#}_x$ is an isomorphism, so $f'$ is a local isomorphism by \cref{cor-localisocondition}.

    (2) $\Leftrightarrow$ (3): This follows from the same arguments as in \cref{cor-localisocondition}.

    (2) $\Leftrightarrow$ (4): This follows from Nakayama's lemma.
\end{proof}

\begin{corollary}\label{cor-immersiongeneralnotion}
    Let $f:X\rightarrow Y$ be a morphism of complex analytic spaces. Then the following are equivalent:
    \begin{enumerate}
        \item $f$ is an immersion;
        \item $|f|$ induces a homeomorphism of $|X|$ with a locally closed subset of $|Y|$ and for all $x\in X$, the homomorphism $f^{\#}_c:\mathcal{O}_{Y,f(x)}\rightarrow \mathcal{O}_{X,x}$ is surjective.
    \end{enumerate}
\end{corollary}
The condition in (2) is the usual definition of an immersion of ringed spaces. Our notion of immersion is usually called a locally closed immersion. 
\begin{proof}
    (1) $\implies$ (2): This is clear by definition.

    (2) $\implies$ (1): We may clearly assume that $f(X)$ is closed in $Y$. We need to show that the kernel of $\mathcal{O}_Y\rightarrow f_*\mathcal{O}_X$ is of finite type. This follows from \cref{cor-localimmersioncond}.
\end{proof}


\begin{lemma}\label{lma-spreadfinitelag}
    Let $S$ be a complex analytic space and $s\in S$. For any finite $\mathcal{O}_{S,s}$-algebra $A$, there is an open neighbourhood $U$ of $s$ in $S$ and a finite $\mathcal{O}_U$-algebra such that $\mathcal{A}_s\cong A$.
\end{lemma}
\begin{proof}
    Let $s\in S$, as $\mathcal{A}_s$ is a finite $\mathcal{O}_{S,s}$-algebra, we can find finitely many generators $\sigma_{1,s},\ldots,\sigma_{n,s}$. As $\mathcal{A}_s$ is integral over $\mathcal{O}_{S,s}$, we can find unitary polynomials $F_{i,s}\in \mathcal{O}_{S,s}[X_i]$ such that $F_{i,s}(\sigma_{i,s})=0$ for $i=1,\ldots,n$. Take a sufficient small neighbourhood $U$ of $s$ so that $\sigma_{i,s}$ lifts to $\sigma_i\in \mathcal{O}_S(U)$ and $F_{i,s}$ lifts to a unitary polynomial $F_i\in H^0(U,\mathcal{O}_S[X_i])$ for $i=1,\ldots,n$. Up to shrinking $U$, we may guarantee that $\sigma_1,\ldots,\sigma_n$ generate $\mathcal{A}|_U$ at all points and $F_i(\sigma_i)=0$ for $i=1,\ldots,n$. Then $\mathcal{B}:=\mathcal{O}_U[X_1,\ldots,X_n]/(F_1,\ldots,F_n)$ is coherent and we have a surjective homomorphism $\mathcal{B}\rightarrow \mathcal{A}|_U$ sneding $X_i$ to $\sigma_i$ for $i=1,\ldots,n$. As the kenrel of this homomorphism is of finite ytpe, up to shrinking $U$, we may take finitely many $G_1,\ldots,G_m\in \mathcal{B}(U)$ that generate the kernel. Lift $G_1,\ldots,G_m$ to $H_1,\ldots,H_m\in H^0(U,\mathcal{O}_S[X_1,\ldots,X_m])$, then
    \[
        \mathcal{A}|_U\cong \mathcal{O}_U[X_1,\ldots,X_n]/(F_1,\ldots,F_n,G_1,\ldots,G_m).  
    \]


   This follows from the same arguments of the proof of \cref{thm-germlocalringequivalence} Step~3.
\end{proof}
\begin{corollary}\label{cor-specanfinitetopfinite}
    Let $S$ be a complex analytic space and $\mathcal{A}$ be a finite $\mathcal{O}_S$-algebra, then the map $\Spec^{\An}_S \mathcal{A}\rightarrow S$ is topologically finite.
\end{corollary}
\begin{proof}
    By \cref{cor-finitespectrumidentification}, the fibers of $\Spec^{\An}_S \mathcal{A}\rightarrow S$ is finite. The map $\Spec^{\An}_S \mathcal{A}\rightarrow S$ is separated by construction. It remains to show that the map is closed.

    The problem is local on $S$.
    By the proof of \cref{lma-spreadfinitelag}, we can find a closed immersion over $S$: $\Spec^{\An}_S \mathcal{A}\rightarrow \Spec^{\An}_S\mathcal{B}$, where $\mathcal{B}=\mathcal{O}_S[X_1,\ldots,X_n]/(F_1,\ldots,F_n)$ for some $n\in \mathbb{N}$, where $F_i$ is a unitary polynomial in $\mathcal{O}_S(S)[X_i]$ for $i=1,\ldots,n$. It suffices to show that $\Spec^{\An}_S \mathcal{B}\rightarrow S$ is closed.

    Observe that
    \[
        \Spec^{\An}_S \mathcal{B}\cong \Spec^{\An}_S \prod_{j=1}^n \mathcal{O}_S[X_j]/(F_j)
    \]
    in $\AnaCat_{/S}$ as can be seen from the functor of points. So the problem reduces to showing that 
    \[
        \Spec_S^{\An} \mathcal{O}_S[X]/(F)\rightarrow S  
    \]
    for a unitary polynomial is closed. This is the classical continuity of roots.
\end{proof}


Next we describe the local structure of a complex analytic germ.
\begin{thm}\label{thm-morphismdefinedbygeneratorlocal}
    Let $X_x$ be a complex analytic germ, $n\in \mathbb{Z}_{>0}$ and $f_1,\ldots,f_n\in \mathcal{O}_{X,x}$ be a system of parameters. We have a morphism $X_x\rightarrow \mathbb{C}^n_0$ induced by $f_1,\ldots,f_n$. Then there is an open neighbourhood $U$ of $0$ in $\mathbb{C}^n$ and a finite $\mathcal{O}_U$-algebra $\mathcal{A}$ such that $\mathcal{A}_0\cong \mathcal{O}_{X,x}$. The space $\Spec^{\An}_{U}(\mathcal{A})$ admits a unique point $x'$ over $0$ and $X_x$ is isomorphic to $\Spec^{\An}_{U}(\mathcal{A})_{x'}$ in $\AnaGerCat_{/\mathbb{C}^n_0}$.
\end{thm}
\begin{proof}
    As $f_1,\ldots,f_n$ is a system of parameters, $\mathcal{O}_{X,x}\rightarrow \mathcal{O}_{\mathbb{C}^n,0}$ is finite. By \cref{lma-spreadfinitelag}, we can spread $\mathcal{O}_{X,x}$ to a finite $\mathcal{O}_U$-algebra on an open neighbourhood $U$ of $0$ in $\mathbb{C}^n$. Let $Y=\Spec^{\An}_{U}(\mathcal{A})$. 
    It follows from \cref{cor-finitespectrumidentification} that $Y$ has a unique point $x'$ over $0$. By \cref{thm-germlocalringequivalence}, up to shrinking $U$, we may guarantee that $X_x$ and $Y_{x'}$ are isomorphic over $\mathbb{C}^n_0$.
\end{proof}


\begin{proposition}\label{prop-bijsubgermideal}
    Let $X_x$ be a complex analytic germ.
    The map $Y_x\mapsto I_X(Y,x)$ defines a bijection between the set of closed subgerms of $X_x$ and the set of ideals of $\mathcal{O}_{X,x}$.
\end{proposition}
In particular, we can view a germ $Y_x$ as a closed subscheme $\Spec \mathcal{O}_{X,x}/I_X(Y,x)$ of $\Spec \mathcal{O}_{X,x}$.
\begin{proof}
    We construct a reverse map. Given an ideal $I$ of $\mathcal{O}_{X,x}$, as $\mathcal{O}_{X,x}$ is noetherian, $I$ is finitely generated. We can find an open neighbourhood $U$ of $x$ in $X$ and an ideal sheaf of finite type $\mathcal{I}$ of $U$ with $\mathcal{I}_x=I$. Let $Y$ be the closed analytic subspace of $X$ defined by $\mathcal{I}$. We associated $Y_x$ with $I$. 
    
    It is easy to verify that this map is the inverse of the given map.
\end{proof}

\begin{definition}
    Let $X_x$ be a complex analytic germ and $Y_x, Z_x$ be two closed subgerms of $X_x$. We say $Y_x$ is contained in $Z_x$ and write
    $Y_x\subseteq Z_x$ if $I(Y,x)\supseteq I_X(Z,x)$. This defines a partial order on the set of closed subgerms of $X_x$.
\end{definition}

\begin{definition}\label{def-integralgerm}
    A complex analytic germ $X_x$ is \emph{integral} if $\mathcal{O}_{X,x}$ is integral.

    We also say $(X,x)$ is \emph{integral}.
\end{definition}

\begin{thm}[Nullstellensatz]\label{thm-Nullstellensatz}
    Let $X_x$ be an integral complex analytic germ and $Y_y$ be a closed subgerm of $X_x$. Then the following are equivalent:
    \begin{enumerate}
        \item $Y_x$ is a proper closed subgerm of $X_x$;
        \item $|Y|_x$ is a proper closed subgerm of $|X|_x$. 
    \end{enumerate}
\end{thm}
\begin{proof}
    (2) $\implies$ (1): This is obvious.

    (1) $\implies$ (2): Consider a proper closed subgerm $Y_x$ of $X_x$. By \cref{prop-bijsubgermideal}, $I(Y,x)\neq 0$. 
    
    \textbf{Step~1}. We reduce to the case $I(Y,x)=(f)$ for some non-zero element $f\in \mathcal{O}_{X,x}$.

    Take a non-zero element $f\in I(Y,x)$. Let $Y'_x$ be the subgerm of $X_x$ corresponding to the ideal $(f)$ of $\mathcal{O}_{X,x}$. Then $Y_x\subseteq Y'_x$.  It suffices to show that $|Y'|_x\neq |X|_x$. We may replace $Y$ by $Y'$.

    \textbf{Step~2}. We prove that $|Y|_x\neq |X|_x$. 

    Note that $f$ is not a zero-divisor as $\mathcal{O}_{X,x}$ is integral. Write $n=\dim \mathcal{O}_{X,x}$.
    By Krulls Hauptidealsatz, $\dim \mathcal{O}_{X,x}/(f)=n-1$.
    Let $\overline{f_1},\ldots,\overline{f_{n-1}}$ be a system of parameters (\cite[\href{https://stacks.math.columbia.edu/tag/00KU}{Tag 00KU}]{stacks-project}) of $\mathcal{O}_{X,x}/(f)$. Lift them to $f_1,\ldots,f_{n-1}\in \mathcal{O}_{X,x}$. Then $(f_1,\ldots,f_{n-1},f)$ is a system of parameters of $\mathcal{O}_{X,x}$. Let $\varphi:X_x\rightarrow \mathbb{C}^n_0$ and $\psi:Y_x\rightarrow \mathbb{C}^{n-1}_0$ be the morphisms defined by these systems of parameters. We then have a commutative diagram in $\AnaGerCat$:
    \[
        \begin{tikzcd}
            Y_x \arrow[r, hook] \arrow[d, "\psi"] & X_x \arrow[d, "\varphi"] \\
            \mathbb{C}^{n-1}_0 \arrow[r, hook]    & \mathbb{C}^{n}_0        
        \end{tikzcd}
    \]
    It induces a commutative diagram of topological germs:
    \[
        \begin{tikzcd}
            {|Y|_x} \arrow[r, hook] \arrow[d, "|\psi|"] & {|X|_x} \arrow[d, "|\varphi|"] \\
            \mathbb{C}^{n-1}_0 \arrow[r, hook]    & \mathbb{C}^{n}_0        
        \end{tikzcd}
    \]
The morphism of topological germs of $\mathbb{C}^{n-1}_0\rightarrow \mathbb{C}^{n}_0$ is clearly not an isomorphism, so it suffices to show that $|\varphi|:|X|_x\rightarrow \mathbb{C}^{n}_0   $ is surjective, in the sense that if we represent $|\varphi|$ by a morphism $(U,x)\rightarrow (\mathbb{C}^n,0)$ from an open neighbourhood $U$ of $x$ in $X$ to $\mathbb{C}^n$, then its image contains an open neighbourhood of $0$ in $\mathbb{C}^n$.

By \cref{thm-morphismdefinedbygeneratorlocal}, we may assume that $X=\Spec^{\An}_X \mathcal{A}$ for some finite $\mathcal{O}_X$-algebra $\mathcal{A}$ and $X$ has a unique point over $0$. Then by \cref{cor-finitespectrumidentification}, we have $\mathcal{A}_0\cn \mathcal{O}_{X,x}$. By \cref{Local-cor-morphismpowertolocalsurinj} in \nameref{Local-chap-local}, the natural homomorphism
\[
    \varphi^{\#}:\mathcal{O}_{\mathbb{C}^n,0}=\mathbb{C}\{X_1,\ldots,X_n\}\rightarrow \mathcal{A}_0
\]
is injective. 

By \cref{cor-suppaffmorphism}, it remains to show that $\Supp \mathcal{A}$ is a neighbourhood of $s$ in $S$. But the kernel of $\mathcal{O}_S\rightarrow \mathcal{A}$ is $0$ at $s$ hence $0$ in a neighbourhood of $s$ since both $\mathcal{O}_S$ and $\mathcal{A}$ are coherent by \cref{Complex-cor-cohsheaffinitepre} in \nameref{Complex-chap-complex}.
\end{proof}


\begin{corollary}\label{cor-orderrelationsubgermideal}
    Let $X_x$ be a complex analytic germ and $I,J$ be two ideals in $\mathcal{O}_{X,x}$. We let $W(I)$, $W(J)$ denote the topological germs of the closed analytic subgerms of $X_x$ defined by $I$ and $J$ respectively.
    Then the following are equivalent:
    \begin{enumerate}
        \item $W(I)\subseteq W(J)$;
        \item $J\subseteq \sqrt{I}$.
    \end{enumerate}
\end{corollary}
\begin{proof}
    If (2) is true, as $\mathcal{O}_{X,x}$ is noetherian, we can find $n\in \mathbb{Z}_{>0}$ such that $J^n\subseteq I$. Extend $I,J$ to coherent ideals $\mathcal{I},\mathcal{J}$ on $X$ up to shrinking $X$.
    Then $\Supp \mathcal{O}_X/\mathcal{J}\subseteq \Supp \mathcal{O}_X/\mathcal{I}$. Hence, (1) holds.

    Suppose that (1) holds. In order to prove (2), we may assume that $I$ is prime. Then the closed analytic subgerm  $Y_x$ of $X_x$ defined by $I$ is integral. Let $Z_x$ denote the closed analytic subgerm of $X_x$ defined by $J$. The intersection $Y_x\cap Z_x$ of the germs $Y_x$ and $Z_x$ is by definition the closed analytic subgerm of $X_x$ defined by $I+J$. Then
    \[
        |Y_x\cap Z_x|=|Y|_x\cap |Z|_x= W(I).  
    \]
    By \cref{thm-Nullstellensatz}, $Y_x\subseteq Z_x$. Namely, (2) holds.
\end{proof}
\begin{corollary}\label{cor-topgermqunilpotent}
    Let $X_x$ be a complex analytic germ and $Y_x$ be a closed analytic subgerm. Then the following are equivalent:
    \begin{enumerate}
        \item $|X|_x=|Y|_x$;
        \item $I_X(Y,x)$ is nilpotent.
    \end{enumerate}
    In particular, if these conditions hold, $\dim \mathcal{O}_{Y,x}=\dim \mathcal{O}_{X,x}$. 
\end{corollary}
\begin{proof}
    This follows immediately from \cref{cor-orderrelationsubgermideal}.
\end{proof}

\begin{corollary}\label{cor-isolatedpointartin}
    Let $X$ be a complex analytic space and $x\in X$. Then the following are equvalent:
    \begin{enumerate}
        \item $x$ is isolated in $X$;
        \item $\mathcal{O}_{X,x}$ is artinian.
    \end{enumerate}
\end{corollary}
\begin{proof}
    (1) simply means that $X_x=\{x\}_x$. By \cref{cor-topgermqunilpotent}, this holds if and only if $\mathfrak{m}_x$ is nilpotent. As $\mathcal{O}_{X,x}$ is noetherian, the latter is equivalent to that $\mathcal{O}_{X,x}$ is artinian.
\end{proof}

\begin{corollary}\label{cor-analyticsubspacesamesupp}
    Let $X$ be a complex analytic space and $Y$ be a closed analytic subspace defined by a coherent ideal $\mathcal{I}$. Then the following are equivalent:
    \begin{enumerate}
        \item $|X|=|Y|$;
        \item $\mathcal{I}$ is locally nilpotent.
    \end{enumerate} 
\end{corollary}
\begin{proof}
    This follows immediately from \cref{cor-topgermqunilpotent}.
\end{proof}

\begin{corollary}\label{cor-nullversionfunction}
    Let $X$ be a complex analytic space and $f\in \mathcal{O}_X(X)$. Then the following are equivalent:
    \begin{enumerate}
        \item $f(x)=0$ for all $x\in X$;
        \item $f$ is locally nilpotent.
    \end{enumerate}
\end{corollary}
\begin{proof}
    This follows from \cref{cor-analyticsubspacesamesupp}, where we take $\mathcal{I}$ as the coherent ideal generated by $f$.
\end{proof}

\begin{corollary}[Rückert Nullstellensatz]\label{cor-Rucnull}
    Let $X$ be a complex analytic space and $\mathcal{F}$ be a coherent sheaf of $\mathcal{O}_X$-modules. Let $f\in \mathcal{O}_X(X)$ be a function that vanishes on $\Supp \mathcal{F}$. Then for any $x\in X$, there is an open neighbourhood $U\subseteq X$ of $x$ and $m\in \mathbb{Z}_{>0}$ such that $f^m\mathcal{F}|_U=0$.
\end{corollary}
\begin{proof}
    Let $\mathcal{G}$ be the annihilator sheaf of $\mathcal{F}$: 
    \[
       \mathcal{G}:=\ker \left(\mathcal{O}_X\rightarrow \Homint_{\mathcal{O}_X}(\mathcal{F},\mathcal{F})\right),
    \]
    where the map $\mathcal{O}_X\rightarrow \Homint_{\mathcal{O}_X}(\mathcal{F},\mathcal{F})$ sends a local section $f$ of $\mathcal{O}_X$ to the endohomomorphism of multiplying by $f$ of $\mathcal{F}$.
    Then $\mathcal{G}$ is a coherent sheaf by Oka's coherence theorem \cref{Complex-thm-Okacoh} in \nameref{Complex-chap-complex}. Let $Y$ be the closed analytic subspace defined by $\mathcal{G}$. By our assumption, $f$ is everywhere zero on $Y$, so $f$ is locally nilpotent in $\mathcal{O}_X/\mathcal{G}\subseteq \Homint_{\mathcal{O}_X}(\mathcal{F},\mathcal{F})$. 
\end{proof}

\begin{corollary}
    Let $X$ be a complex analytic space and $\mathcal{I}$ and $\mathcal{J}$ be coherent ideal sheaves on $X$. Then the following are equivalent:
    \begin{enumerate}
        \item $\Supp \mathcal{O}_X/\mathcal{I}\subseteq \Supp \mathcal{O}_X/\mathcal{J}$;
        \item For any $x\in X$, there is an open neighbourhood $U$ of $x$ in $X$ and $n\in \mathbb{Z}_{>0}$ such that
            \[
                J^n|_U\subseteq I|_U.
            \]
    \end{enumerate}
\end{corollary}
\begin{proof}
    This follows immediately from \cref{cor-orderrelationsubgermideal}.
\end{proof}


\section{Analytic subsets}

\begin{definition}
    Let $X$ be a complex analytic space. A subset $A\subseteq X$ is \emph{analytic at $x\in X$} if there is an open neighbourhood $U$ of $x$ in $X$ and finitely many $f_1,\ldots,f_m\in \mathcal{O}_X(U)$ such that 
    \[
        A\cap U=\left\{ x\in U: f_1(x)=\cdots=f_m(x)=0 \right\}.  
    \]
    We will denote the set on the right-hand side as $N_U(f_1,\ldots,f_m)$.
    A subset $A\subseteq X$ is \emph{analytic} in $X$ if it is analytic at all $x\in X$.

    A subset $B\subseteq X$ is \emph{co-analytic} in $X$ if $X\setminus B$ is analytic in $X$.
\end{definition}
We observe that given $A\subseteq X$, the set of points $x\in X$ such that $A$ is analytic at $x$ is open. Also observe that an analytic set is necessarily closed.
Analytic sets are clearly closed under finite intersection and finite unions.

\begin{example}\label{ex-closedanalyticspaceanalyt}
    Let $X$ be a complex analytic space. 
    The underlying set of a closed analytic subspace of $X$ is an analytic set in $X$.

    In particular, the support of a coherent sheaf of $\mathcal{O}_X$-modules is an analytic set in $X$.
\end{example}

\begin{proposition}\label{prop-analyticsettrans}
    Let $X$ be a complex analytic space and $Y$ be a closed analytic subspace of $X$. Then each analytic set $A$ in $Y$ is also an analytic set in $X$. 

    Conversely, if $A$ is an analytic subset of $X$, then $A\cap Y$ is an analytic set in $Y$.
\end{proposition}
\begin{proof}
    We prove the first part. Let $A$ be an analytic set in $Y$. Then $A$ is closed in $Y$. It follows that $A$ is closed in $X$. Let $a\in A$, we can find an open neighbourhood $V$ of $a$ in $Y$ and finitely many $g_1,\ldots,g_k\in \mathcal{O}_Y(V)$ such that 
    \[
        A\cap V=N_V(g_1,\ldots,g_k).  
    \]
    Up to shrinking $V$, we may find a neighbourhood $U$ of $a$ in $X$ with $V=Y\cap U$ and $f_1,\ldots,f_k\in \mathcal{O}_X(U)$ lifting $g_1,\ldots,g_k$. Then 
    \[
        A\cap U=N_U(f_1,\ldots,f_k)\cap Y.  
    \]
    So by \cref{ex-closedanalyticspaceanalyt}, $A\cap U$ is analytic at $a$ as a subset of $X$.

    The second part is obvious.
\end{proof}

\begin{definition}\label{def-sheafidealanaset}
    Let $X$ be a complex analytic space and $A\subseteq X$ be an analytic set. We define the \emph{sheaf of ideals} $\mathcal{J}_A$ of $A$ as the sheafification of the presheaf of ideals on $X$ defined by 
    \[
        U\mapsto \left\{ f\in \mathcal{O}_X(U): N_U(f)\supseteq M\cap U \right\}
    \]
    for any open subset $U\subseteq X$.
\end{definition}
Observe that $\mathcal{J}_A$ is reduced.

\begin{lemma}\label{lma-germidealanalyticsetcont}
    Let $X$ be a complex analytic space and $A,B\subseteq X$ be analytic sets. Take $x\in X$. Then the following are equivalent:
    \begin{enumerate}
        \item $\mathcal{J}_{A,x}\subseteq \mathcal{J}_{B,x}$;
        \item $A\cap U\supseteq B\cap U$ for some neighbourhood $U$ of $x$ in $X$.
    \end{enumerate}
\end{lemma}
\begin{proof}
    (2) $\implies$ (1): This is trivial.

    (1) $\implies$ (2): Choose a neighbourhood $U$ of $x$ and finitely many $f_1,\ldots,f_k\in \mathcal{O}_X(U)$ such that $A\cap U=N_U(f_1,\ldots,f_k)$. Then $f_{1,x},\ldots,f_{k,x}\in \mathcal{J}_{A,x}\subseteq \mathcal{J}_{B,x}$. Up to shrinking $U$, we may assume that $f_1,\ldots,f_k\in \mathcal{J}_B(U)$. It follows that $A\cap U\supseteq B\cap U$.
\end{proof}


\begin{lemma}\label{lma-analyticsetlocallyidealsheaf}
    Let $X$ be a complex analytic space and $A$ be an analytic set in $X$. Take $a\in A$.
    Let $\mathcal{I}$ be a coherent ideal sheaf on $X$ with $\mathcal{I}_a=\mathcal{J}_{A,a}$. Then there is an open neighbourhood $U$ of $a$ in $X$ such that
    \[
        W(\mathcal{I}|_U)=A\cap U.  
    \]
\end{lemma}

The lemma tells that an analytic set can always be locally wrtten in the form $W(\mathcal{I})$ for some open set $U\subseteq X$ and a coherent ideal $\mathcal{I}$ on $U$.

\begin{proof}
    Choose an open neighbourhood $U$ of $x$ in $X$ and finitely many sections $f_1,\ldots,f_k\in \mathcal{J}_A(U)$ such that 
    \[
        \mathcal{I}|_U=\mathcal{O}_Uf_1+\cdots+\mathcal{O}_U f_k.  
    \]
    After shrinking $U$, we may assume that 
    \[
        A\cap U=N_U(g_1,\ldots,g_l)  
    \]
    for finitely many $g_1,\ldots,g_l\in \mathcal{J}_A(U)$. Then $g_{1,a},\ldots,g_{l,a}\in \mathcal{J}_{A,a}=\mathcal{I}_a$. So up to shrinking $U$, we can find equations for all $j=1,\ldots,l$:
    \[
        g_j=\sum_{i=1}^k a_{ij}f_i  
    \]
    for some $a_{ij}\in \mathcal{O}_X(U)$ with $i=1,\ldots,k$, $j=1,\ldots,l$. This implies that $W(\mathcal{I}|_U)\subseteq A\cap U$. The reverse inclusion is clear.
\end{proof}



\section{Lasker--Noether decomposition}
\begin{definition}
    Let $X$ be a complex analytic space.
    An analytic set $A$ in $X$ is \emph{irreducible} at $a\in A$ if $\mathcal{J}_{A,a}$ is a prime ideal in $\mathcal{O}_{X,a}$.
\end{definition}

\begin{definition}
    Let $X$ be a complex analytic space, $A$ be an analytic set in $X$ and $a\in A$. A \emph{local decomposition} of $A$ at $a$ consists of an open neighbourhood $U$ of $a$ in $X$ and finitely many analytic sets $A_1,\ldots,A_s$ in $U$ such that
    \begin{enumerate}
        \item 
        \[
            A\cap U=A_1\cup\cdots\cup A_s;  
        \]
        \item $A_i$ is irreducible at $a$ for $i=1,\ldots,s$;
        \item for any open neighbourhood $V$ of $a$ in $U$, $A_j\cap V\not\subset A_k\cap V$ for $j,k=1,\ldots,s$, $j\neq k$.
    \end{enumerate}
    We also say $A_1\cup\cdots \cup A_s$ is a \emph{local decomposition} of $A\cap U$.
\end{definition}

\begin{proposition}\label{prop-primedecunique}
    Let $X$ be a complex analytic space, $A$ be an analytic set in $X$ and $a\in A$. 
    Let 
    \[
        \mathcal{J}_{A,a}=\bigcap_{j=1}^s \mathfrak{p}_j
    \]
    be the Lasker--Noether decomposition. Then there is a local decompose of $A$ at $a$:
    \[
        A\cap U=A_1  \cup\cdots\cup A_s
    \] 
    with $\mathcal{J}_{A_j,a}=\mathfrak{p}_j$ for $j=1,\ldots,s$.

    Let $A\cap U'=A_1'\cup\cdots\cup A_r'$ be another local decomposition of $A$ at $a$. Then $r=s$ and we can find an open neighbourhood $W\subseteq U\cap U'$ and a bijection $\sigma:\{1,\ldots,s\}\rightarrow \{1,\ldots,s\}$ such that 
    \[
        A_j'\cap W=A_{\sigma(j)}\cap W  
    \]
    for $j=1,\ldots,s$.
\end{proposition}

\begin{proof}
    We first prove the existence part. Take an open neighbourhood $U$ of $a$ in $X$ and coherent ideal sheaves $\mathcal{I}_1,\ldots,\mathcal{I}_s$ on $U$ such that 
    \[
        \mathcal{I}_{j,a}=\mathfrak{p}_j  
    \]
    for $j=1,\ldots,s$. Define
    \[
        \mathcal{I}=\bigcap_{j=1}^s\mathcal{I}_{j}.
    \]
    Then $\mathcal{I}_a=\mathcal{J}_{A,a}$. By \cref{lma-analyticsetlocallyidealsheaf}, up to shrinking $U$, we may guarantee that 
    \[
        W(\mathcal{I})=A\cap U.  
    \]
    We set $A_j=W(\mathcal{I}_j)$ for $j=1,\ldots,s$. Then $A_j$ is an analytic set in $U$ and 
    \[
        A\cap U=W(\mathcal{I})=\bigcup_{j=1}^s W(\mathcal{I}_j)=A_1\cup\cdots\cup A_s. 
    \]
    Observe that $\mathfrak{p}_j=\mathcal{I}_{j,a}\subseteq \mathcal{J}_{A_j,a}$ for all $j=1,\ldots,s$. We need to prove the reverse inclusion. Assume that this is not true, say it fails for $j=1$.
    Then there is $g_1\in \mathcal{J}_{A_1,a}\setminus \mathfrak{p}_1$. As $\mathfrak{p}_j\not\subset \mathfrak{p}_1$ for $j=2,\ldots,s$, we can find $g_j\in \mathfrak{p}_j\setminus \mathfrak{p}_1$ for $j=2,\ldots,s$. Then
    \[
        g_1\cdots g_s\in \mathcal{J}_{A_1,a}\cap  \cdots \cap \mathcal{J}_{A_s,a}=\mathcal{J}_{A,a}\subseteq \mathfrak{p}_1. 
    \]
    This is a contradiction. So $\mathcal{J}_{A_j,a}=\mathfrak{p}_j$ for $j=1,\ldots,s$. We conclude that $A\cap U=A_1  \cup\cdots\cup A_s$ is a local decomposition by \cref{lma-germidealanalyticsetcont}.

    Next we prove the uniqueness statement. We take $U'$ and $A_1',\ldots,A_r'$ as in the statement of the theorem. Then
    \[
        \mathcal{J}_{A,a}=\mathcal{J}_{A'_1,a}\cap \cdots \cap   \mathcal{J}_{A'_r,a}.
    \]
    By \cref{lma-germidealanalyticsetcont}, we find that this is the Lasker--Noether decomposition of $\mathcal{J}_{A,a}$. The uniqueness follows from the uniqueness of Lasker--Noether decomposition and \cref{lma-germidealanalyticsetcont}.
\end{proof}

\begin{definition}
    Let $X$ be a complex analytic space, $A$ be an analytic set in $X$ and $a\in A$. Let 
    \[
        A\cap U=A_1  \cup\cdots\cup A_s
    \] 
    be a local decomposition of $A$ at $a$. We call $A_{1,a},\ldots,A_{s,a}$ the \emph{prime components} of $A$ at $a$. 
\end{definition}
By \cref{prop-primedecunique}, the prime compoments are uniquely determined by the germ of $X$ at $x$.

\begin{lemma}\label{lma-localprimeavoidance}
    Let $X$ be a complex analytic space, $A$ be an analytic set in $X$ and $a\in A$. Let $A_1,\ldots,A_s$ be the prime components of $A$ at $a$. Then $A_1$ is not contained in $A_{2}\cup\cdots\cup A_s$.
\end{lemma}
\begin{proof}
    If not, we have 
    \[
        \mathcal{J}_{A_1,a}\supseteq  \bigcap_{j=2}^s \mathcal{J}_{A_j,a}.
    \]
    So
    \[
        \mathcal{J}_{A,a}=  \bigcap_{j=2}^s \mathcal{J}_{A_j,a}.
    \]
    This contradicts the uniqueness of the Lasker--Noether decomposition.
\end{proof}

\begin{proposition}
    Let $X$ be a complex analytic space, $A$ be an analytic set in $X$ and $a\in A$. The following are equivalent:
    \begin{enumerate}
        \item $A$ is not irreducible at $a$;
        \item there is an open neighbourhood $U$ of $a$ in $X$ and a decomposition
            \[
                A\cap U=A'\cup A'',    
            \]
            where $A'$ and $A''$ are analytic sets in $U$ such that $A'_a\neq A_a$ and $A''_a\neq A_a$.
    \end{enumerate}
\end{proposition}
\begin{proof}
    (1) $\implies$ (2): Let $A_{1,x},\ldots,A_{s,x}$ be the prime components of $A$ at $a$. Then $s\geq 2$.
    Take an open neighbourhood $U$ of $a$ in $X$ such that $A_{1,x},\ldots,A_{s,x}$ lifts to analytic subsets $A_1,\ldots,A_s$ of $U$. It suffices to let $A'=A_1$ and $A''=A_2\cup\cdots\cup A_s$. By \cref{lma-localprimeavoidance}, $A'$ and $A''$ satisfies the conditions in (2).

    (2) $\implies$ (1): We have $\mathcal{J}_{A,a}\neq \mathcal{J}_{A',a}$ and $\mathcal{J}_{A,a}\neq \mathcal{J}_{A'',a}$. Take $f\in \mathcal{J}_{A',a}\setminus \mathcal{J}_{A,a}$ and $g\in \mathcal{J}_{A'',a}\setminus \mathcal{J}_{A,a}$. Then $fg\in \mathcal{J}_{A',a}\cap \mathcal{J}_{A'',a}=\mathcal{J}_{A,a}$. So $\mathcal{J}_{A,a}$ is not a prime ideal.
\end{proof}

\section{Diagonal morphism}

\begin{definition}
    Let $f:X\rightarrow Y$ be a morphism of complex analytic space. The \emph{diagonal} of $f$ is by definition the morphism:
    \[
        \Delta_f=\Delta_{X/Y}: X\rightarrow X\times_Y X
    \]  
    induced by the identity maps $X\rightarrow X$ and $X\rightarrow X$.

    When $Y=\mathbb{C}^0$, we write $\Delta_X$ instead of $\Delta_{X/\mathbb{C}^0}$.
\end{definition}

\begin{example}\label{ex-Cndiagonalcloim}
    Let $n\in \mathbb{N}$.
    The diagonal morphism $\mathbb{C}^n\rightarrow \mathbb{C}^n\times \mathbb{C}^n$ is a closed immersion corresponding to the ideal generated by $p_1^*z_1-p_2^*z_1,\ldots,p_1^*z_n-p_2^*z_n$, where $p_1,p_2:\mathbb{C}^n\times \mathbb{C}^n\rightarrow \mathbb{C}^n$ are the two projections and $z_1,\ldots,z_n$ are the coordinates on $\mathbb{C}^n$. 

    This can be seen through the functor of points by \cref{Complex-thm-hCnidentification} in \nameref{Complex-chap-complex}.
\end{example}

\begin{proposition}\label{prop-diagoimm}
    Let $f:X\rightarrow Y$ be a morphism of complex analytic space. Then $\Delta_{X/Y}$ is an immersion.
\end{proposition}
\begin{proof}
    \textbf{Step~1}.    We first reduce to the case $Y=\mathbb{C}^0$.

    By general abstract nonsense, we have a commutative diagram
    \[
        \begin{tikzcd}
            X \arrow[r, "\Delta_{X/Y}"'] \arrow[rr, "\Delta_X", bend left] & X\times_Y X \arrow[d] \arrow[r] \arrow[rd, "\square", phantom] & X\times X \arrow[d] \\
                                                                           & Y \arrow[r, "\Delta_Y"]                                        & Y\times Y          
        \end{tikzcd}  
    \]
    So in order to show that $\Delta_{X/Y}$ is an immersion, it suffices to show that $X$ and $Y$ are.

    \textbf{Step~2}. We reduce to the case $X=\mathbb{C}^n$ for some $n\in \mathbb{N}$.
    
    We want to show that $\Delta_X:X\rightarrow X\times X$ is an immersion.

    The problem is local on $X$, so we may assume that $X$ is a complex model space, say $X$ is a closed analytic subspace of an open set $U$ in $\mathbb{C}^n$ for some $n\in \mathbb{N}$.
    Consider the commutative diagram
    \[
        \begin{tikzcd}
            X \arrow[r, "\Delta_X"] \arrow[d] & X\times X \arrow[d] \\
            U \arrow[r, "\Delta_U"]           & U\times U          
        \end{tikzcd}.  
    \]
    It suffices to show that $\Delta_U$ is an immersion. 
    As the problem is local, it suffices to show that $\Delta_{\mathbb{C}^n}$ is an immersion.

    \textbf{Step~3}. We show that $\Delta_{\mathbb{C}^n}$ is a closed immersion.

    This is exactly \cref{ex-Cndiagonalcloim}.
\end{proof}


\section{Conormal sheaf}
\begin{definition}
    Let $i:X\rightarrow Y$ be an immersion of complex analytic spaces. The \emph{conormal sheaf} of $f$ is a sheaf of $\mathcal{O}_X$-modules $\mathcal{C}_f=\mathcal{C}_{X/Y}$ with $i_*\mathcal{C}_{X/Y}\cong \mathcal{I}/\mathcal{I}^2$, where $\mathcal{I}$ is the kernel of $i^{-1}\mathcal{O}_Y\rightarrow \mathcal{O}_X$.
\end{definition}
The conormal sheaf is defined up to a unique isomorphism. A choice of a factorization of $i$ into a closed immersion $i':X\rightarrow Z$ followed by an open immersion $j:Z\rightarrow Y$ determines a realization of $\mathcal{C}_{X/Y}$. Namely, if $\mathcal{J}$ is the ideal sheaf of $i'$, then $\mathcal{C}_{X/Y}$ is (isomorphic to) $i'^{*}\mathcal{J}$.

\begin{proposition}\label{prop-conormalcoherent}
    Let $i:X\rightarrow Y$ be an immersion of complex analytic spaces. Then $\mathcal{C}_{X/Y}$ is coherent.
\end{proposition}
\begin{proof}
    We may assume that $i$ is a closed immersion defined by a coherent ideal $\mathcal{J}$. Then $\mathcal{C}_{X/Y}\cong i^*\mathcal{J}$ is coherent by \cref{Complex-cor-pullbackcoh} in \nameref{Complex-chap-complex}.
\end{proof}


\section{Kähler differentials}

We will make free use of results and notations in \cite[\href{https://stacks.math.columbia.edu/tag/08RL}{Tag 08RL}]{stacks-project}. In particular, for a morphism $f:X\rightarrow S$ of complex analytic spaces, $\Omega_{X/S}$ denotes the sheaf of Kähler differentials and $\mathrm{d}_{X/S}:\mathcal{O}_X\rightarrow \Omega_{X/S}$ denotes the universal $S$-derivation.

\textcolor{red}{Include principal parts etc. here}
\begin{proposition}\label{prop-Kahlerdiffconormal}
    Let $f:X\rightarrow S$ be a morphism of complex analytic spaces. Then there is a canonical isomorphism
    \[
        \Omega_{X/S}\cn  \mathcal{C}_{\Delta_{X/S}}.
    \]
\end{proposition}
\begin{proof}
    We first define the map in question.
    Factorize $\Delta_{X/S}$ as $X\rightarrow W\rightarrow X\times_S X$, where $X\rightarrow W$ is a closed immersion define by a coherent ideal $\mathcal{I}$ and $W\rightarrow X\times_S X$ is an open immersion.  We have a short exact sequence
    \[
        0\rightarrow \mathcal{C}_{X/X\times_S X}\rightarrow \Delta_{X/S}^{-1}(\mathcal{O}_W/\mathcal{I}^2)\rightarrow \mathcal{O}_X\rightarrow 0.  
    \]
    Let $p_1,p_2:X\times_S X\rightarrow X$ be the two projection maps. Then the natural maps $p_i^{\#}:p_i^{-1}\mathcal{O}_X\rightarrow \mathcal{O}_{X\times_S X}$ induce $p_i^{-1}\mathcal{O}_X\rightarrow \mathcal{O}_W/\mathcal{I}^2$ for $i=1,2$. Take $\Delta^{-1}$, we find natural maps
    \[
        s_i:\mathcal{O}_X\rightarrow \Delta^{-1}(\mathcal{O}_W/\mathcal{J}^2).  
    \]
    The difference $\mathrm{d}=s_2-s_1$ is clearly an $S$-derivation. By the universal property of $\Omega_{X/S}$, we get a unique $\mathcal{O}_{X}$-linear map $\Omega_{X/S}\rightarrow \mathcal{C}_{X/X\times_S X}$.

    Now in order to verify 
    \[
        \Omega_{X/S}\cn  \mathcal{C}_{\Delta_{X/S}}
    \]
    is an isomorphism, it suffices to work on each stalk. This reduces the problem to the corresponding problem of local rings, which is handled in \cite[\href{https://stacks.math.columbia.edu/tag/08S2}{Tag 08S2}]{stacks-project}.
\end{proof}
We will write $\mathcal{P}^{(1)}_{X/S}$ for $\Delta^{-1}(\mathcal{O}_W/\mathcal{J}^2)$ introduced in the proof.

\begin{corollary}\label{cor-Kahdiffcoh}
    Let $f:X\rightarrow S$ be a morphism of complex analytic spaces.  Then $\Omega_{X/S}$ is coherent.
\end{corollary}
\begin{proof}
    This follows from \cref{prop-Kahlerdiffconormal} and \cref{prop-conormalcoherent}.
\end{proof}

\begin{proposition}\label{prop-Omegafirstseq}
    Let $f:X\rightarrow Y$, $g:Y\rightarrow S$ be morphisms of complex analytic spaces. Then there is a canonical exact sequence
    \[
        f^*\Omega_{Y/S}\rightarrow \Omega_{X/S}\rightarrow \Omega_{X/Y}\rightarrow 0.  
    \]
\end{proposition}
\begin{proof}
    The existence of the morphisms is obvious. To prove that the sequence is exact, it suffices to localize along each $x\in X$. The result then follows from the algebraic case \cite[\href{https://stacks.math.columbia.edu/tag/01UX}{Tag 01UX}]{stacks-project}.
\end{proof}

\begin{proposition}\label{prop-Omegasecondseq}
    Let $X\rightarrow S$ be a morphism of complex analytic spaces and $i:Z\rightarrow X$ be an immersion. Then we have a canonical exact sequence
    \[
        \mathcal{C}_{Z/X}\rightarrow i^*\Omega_{X/S}\rightarrow \Omega_{Z/S}\rightarrow 0.  
    \]
\end{proposition}
\begin{proof}
    The existence of the morphisms is obvious. To prove that the sequence is exact, it suffices to localize along each $x\in X$. The result then follows from the algebraic case \cite[\href{https://stacks.math.columbia.edu/tag/01UZ}{Tag 01UZ}]{stacks-project}.
\end{proof}

\begin{proposition}\label{prop-Omegachangebase}
    Let $f:X\rightarrow S$, $g:S'\rightarrow S$ be morphisms of complex analytic spaces. Consider the Cartesian diagram
    \[
        \begin{tikzcd}
            X' \arrow[r, "g'"] \arrow[d, "f'"] \arrow[rd, "\square", phantom] & X \arrow[d, "f"] \\
            S' \arrow[r, "f"]                                                 & S               
        \end{tikzcd}.  
    \]
    Then we have a canonical isomorphism
    \[
        g'^*\Omega_{X/S}\rightarrow \Omega_{X'/S'}.  
    \]
\end{proposition}
\begin{proof}
    It suffices to show that the canonical morphism $g'^*\mathcal{P}^{(1)}_{X/S}\rightarrow \mathcal{P}^{(1)}_{X'/S'}$ is an isomorphism. For this purpose, it suffices to prove it after localizing around $x'\in X'$. But observe that the local rings of $\mathcal{P}^{(1)}_{X/S}$ are finite over the corresponding local rings of $X$, so the analytic tensor products reduce to usual tensor products. The result then follows from the corresponding algebraic results.
\end{proof}

\begin{corollary}\label{cor-Omega1sum}
    Let $f:X\rightarrow S$, $g:X\rightarrow S$ be morphisms of complex analytic spaces. Consider the Cartesian diagram
    \[
        \begin{tikzcd}
            X\times_S Y \arrow[r, "p"] \arrow[d, "q"] \arrow[rd, "\square", phantom] & X \arrow[d, "f"] \\
            Y \arrow[r, "g"]                                                         & S               
        \end{tikzcd}.  
    \]
    Then we  have a canonical isomorphism
    \[
        p^*\Omega_{X/S}\oplus q^*\Omega_{Y/S}\rightarrow \Omega_{X\times_S Y/S}.  
    \]
\end{corollary}
\begin{proof}
    The existence of the morphism follows from \cite[\href{https://stacks.math.columbia.edu/tag/08RU}{Tag 08RU}]{stacks-project}. By \cref{prop-Omegachangebase}, the composition 
    \[
        p^*\Omega_{X/S}\rightarrow \Omega_{X\times_S Y/S}\rightarrow \Omega_{X\times_S Y/Y}  
    \]
    is an isomorphism. In particular, $p^*\Omega_{X/S}\rightarrow \Omega_{X\times_S Y/Y}$ is injective. Similarly, we have a natural isomorphism
    \[
          q^*\Omega_{Y/S}\cn \Omega_{X\times_S Y/X}  
    \]
    By \cref{prop-Omegafirstseq}, we have a short exact sequence
    \[
        0\rightarrow p^*\Omega_{X/S}\rightarrow \Omega_{X\times_S Y/S} \rightarrow q^*\Omega_{Y/S}\rightarrow 0, 
    \]
    which clearly splits.
\end{proof}


\begin{example}\label{ex-OmegaCn}
    Let $n\in \mathbb{N}$. We claim that $\Omega_{\mathbb{C}^n}$ is the free $\mathcal{O}_{\mathbb{C}^n}$-module generated by $\mathrm{d}z_1,\ldots,\mathrm{d}z_n$, where $z_1,\ldots,z_n\in \mathcal{O}_{\mathbb{C}^n}(\mathbb{C}^n)$ are the coordinates on $\mathbb{C}^n$.
    
    By \cref{ex-Cndiagonalcloim}, we know that $\Omega_{\mathbb{C}^n}$ is generated by $\mathrm{d}z_1,\ldots,\mathrm{d}z_n$ as an $\mathcal{O}_{\mathbb{C}^n}$-module. Assume that there is $x\in \mathbb{C}^n$, $f_{1,x},\ldots,f_{n,x}\in \mathcal{O}_{X,x}$ such that 
    \[
        \sum_{i=1}^n f_{i,x}\,\mathrm{d}z_i=0.
    \]
        We need to show that $f_{i,x}=0$ for all $i=1,\ldots,n$. We may assume that $x=0$. Observe that 
    \[
        \Omega^1_{\mathbb{C}^n,0}\otimes_{\mathcal{O}_{\mathbb{C}^n,0}} \mathbb{C}\cn \mathfrak{m}_{0}/\mathfrak{m}_{0}^2  
    \]
    by the algebraic results. Taking the residue of our linear relation at $0$, we find
    \[
        \sum_{i=1}^n f_{i,0} z_{i,0}\in \mathfrak{m}_0^2.  
    \]
    As $z_{i,0},\ldots,z_{n,0}$ form a basis of $\mathfrak{m}_0/\mathfrak{m}_0^2$, we have $f_{i,0}=0$ for $i=1,\ldots,n$.
\end{example}

\iffalse

\textcolor{red}{This notion should be placed elsewhere, defined for a general ringed space}
\begin{definition}
    Let $i:Y\rightarrow X$ be an immersion. Then we have a natural surjective morphism
    \[
        i^{-1}\mathcal{O}_X\rightarrow \mathcal{O}_Y.  
    \]
    Write $\mathcal{J}$ for the kernel of this map. For any $n\in \mathbb{N}$, we introduce the \emph{$n$-th infinitesimal neighbourhood} of $Y$ in $X$ is the ringed space 
    \[
        Y^{(n)}=(Y,i^{-1}\mathcal{O}_X/\mathcal{J}^{n+1}). 
    \] 
    There is a canonical closed immersion $Y\rightarrow Y^{(n)}$. The structure sheaf $\mathcal{O}_{Y^{(n)}}$ is called the \emph{$n$-th conormal invariant} of $Y$ in $X$.

    The kernel of the canonical map $\mathcal{O}_{Y^{(1)}}\rightarrow \mathcal{O}_Y$ is canonically isomorphic to the \emph{conormal sheaf} $\mathcal{N}^{\vee}_{Y/X}:=i^*(\mathcal{J}/\mathcal{J}^2)$.
\end{definition}
When $i:Y\rightarrow X$ is an immersion of complex analytic spaces, we find immediately that $Y^{(n)}$ is also a complex analytic space. The sheaf $\mathcal{N}^{\vee}_{Y/X}$ is coherent. The sheaves $\mathcal{O}_{Y^{(n)}}$ are coherent as the successive quoteints are.

\begin{definition}
    Let $f:X\rightarrow Y$ be a morphism of complex analytic spaces. Then $\Delta_{X/Y}:X\rightarrow X\times_Y X$ is an immersion. For each $n\in \mathbb{N}$, let $\Delta_f^{(n)}$ or $\Delta_{X/Y}^{(n)}$ denote the $n$-th infinitesimal neighbourhood of $\Delta$. The corresponding structure sheaf is called the \emph{$n$-th different invariant} of $f$.
\end{definition}
We regard $\mathcal{O}_{\Delta_{X/Y}^{(n)}}$ as an $\mathcal{O}_X$-algebra via the projection $X\times_Y X\rightarrow X$ onto the first factor. 

\begin{definition}
    Let $f:X\rightarrow Y$ be a morphism of complex analytic spaces. The \emph{sheaf of Kähler differentials} $\Omega^1_{X/Y}$ or $\Omega^1_{f}$ is the conormal sheaf of $\Delta_{X/Y}$. The difference of the two projections 
\end{definition}
Observe that $\Omega^1_{X/Y}$ is a coherent sheaf on $X$.

\fi

\printbibliography
\end{document}