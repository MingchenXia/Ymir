\input{preamble}



%\usepackage[color]{showkeys}
%\definecolor{refkey}{rgb}{0,0,1}

\title{Ymir}

\begin{document}







\maketitle


\tableofcontents

\chapter*{The notion of complex analytic spaces}\label{chap-complex}

\section{Introduction}\label{sec-introduction-Complexanalyticspaces}
We introduce the notion of complex analytic spaces in this section.

\section{\texorpdfstring{$\mathbb{C}$}{C}-ringed space}

\begin{definition}
    A \emph{$\mathbb{C}$-ringed space} is a pair $(X,\mathcal{O}_X)$ consisting of a topological space $X$ and a sheaf $\mathcal{O}_X$ of $\mathbb{C}$-algebras on $X$.

    A \emph{morphism of $\mathbb{C}$-ringed spaces $f:(Y,\mathcal{O}_Y)\rightarrow (X,\mathcal{O}_X)$} is a pair consisting of a continuous map $f:Y\rightarrow X$ and a morphism of sheaves of $\mathbb{C}$-algebras $f^{\#}:f^{-1}\mathcal{O}_X\rightarrow \mathcal{O}_Y$.

    Given two morphisms of $\mathbb{C}$-ringed spaces $f:(Y,\mathcal{O}_Y)\rightarrow (X,\mathcal{O}_X)$ and $g:(Z,\mathcal{O}_Z)\rightarrow (Y,\mathcal{O}_Y)$, their \emph{composition} is the morphism $f\circ g:(Z,\mathcal{O}_Z)\rightarrow (X,\mathcal{O}_X)$ consisting of the continuous map $f\circ g:Z\rightarrow X$ and a morphism of sheaves $(f\circ g)^{\#}=g^{\#}\circ g^{-1}f^{\#}:(f\circ g)^{-1}\mathcal{O}_X\cn g^{-1}f^{-1}\mathcal{O}_X\rightarrow \mathcal{O}_Z$.

    When there is no risk of confusion, we say $X$ is a $\mathbb{C}$-ringed space. In this case, we write $|X|$ for the topological space underlying $X$.
\end{definition}
It is straightforward to verify that $\mathbb{C}$-ringed spaces form a category, which we denote by $\CRSCat$.
Similarly, we denote by $\RSCat$ the category of ringed spaces defined in \cite[\href{https://stacks.math.columbia.edu/tag/0090}{Tag 0090}]{stacks-project}.

In fact, by definition a $\mathbb{C}$-ringed space is nothing but a morphism in the category of ringed spaces $X\rightarrow \mathbb{C}^0$, where $\mathbb{C}^0$ is a single point $*$ endowed with the sheaf of rings $\mathcal{O}_{\mathbb{C}^0}$ with $\mathcal{O}_{\mathbb{C}^0}(*)=\mathbb{C}$. In terms of slice categories, we have a canonical equivalence of categories 
\[
    \CRSCat\approx\RSCat/\mathbb{C}^0. 
\]
From this identification, most of the basic results above $\CRSCat$ follows, which we will use freely.

There is an obvious faithful forget functor $\CRSCat\rightarrow \RSCat$.


\begin{definition}
    A \emph{locally $\mathbb{C}$-ringed space} is a $\mathbb{C}$-ringed space $(X,\mathcal{O}_X)$ which when regarded as a ringed space is a locally ringed space.

    A \emph{morphism} between two locally $\mathbb{C}$-ringed spaces is a morphism between the underlying $\mathbb{C}$-ringed spaces which is a morphism of locally ringed spaces at the same time.

    The category of locally $\mathbb{C}$-ringed spaces is denoted by $\CLRSCat$.
\end{definition}
We refer to \cite[\href{https://stacks.math.columbia.edu/tag/01HA}{Tag 01HA}]{stacks-project} for the notion of locally ringed spaces. Similar to the case of $\mathbb{C}$-ringed space, we have a canonical equivalence of categories
\[
    \CLRSCat\approx\LRSCat/\mathbb{C}^0. 
\]

\begin{example}\label{ex-Cnringed}
    Let $n\in \mathbb{N}$, we define a sheaf of $\mathbb{C}$-algebras $\mathcal{O}_{\mathbb{C}^n}$ on $\mathbb{C}^n$ as follows: for any open subset $U\subseteq \mathbb{C}^n$, $\mathcal{O}_{\mathbb{C}^n}(U)$ is the $\mathbb{C}$-algebra of holomorphic functions on $U$. It is easy to see that $\mathcal{O}_{\mathbb{C}^n}$ is a sheaf and $(\mathbb{C}^n,\mathcal{O}_{\mathbb{C}^n})$ is a $\mathbb{C}$-ringed space. Moreover, it is easy to show that $(\mathbb{C}^n,\mathcal{O}_{\mathbb{C}^n})$ is a locally $\mathbb{C}$-ringed space.
\end{example}

\begin{proposition}\label{prop-Cnlocalring}
    Let $n\in \mathbb{N}$, $w\in \mathbb{C}^n$, then there is a natural isomorphism $\mathcal{O}_{\mathbb{C}^n,w}\cong \mathbb{C}\{ z_1,\ldots,z_n\}$.
\end{proposition}
The ring on the right-hand side is defined  in 
\cref{Local-def-ringconvpowerseries} in the Complex Analytic Local Algebras.
\begin{proof}
    This is a well-known result from classical complex analysis. \textcolor{red}{Include details later}.
\end{proof}


\section{Complex model spaces and complex analytic spaces}



\begin{definition}\label{def-sheafondomain}
Given any domain $D$ in $\mathbb{C}^n$, we can define a sheaf of $\mathbb{C}$-algebras $\mathcal{O}_D$ on $D$ as the restriction of $\mathcal{O}_{\mathbb{C}^n}$ defined in \cref{ex-Cnringed} to $D$. Observe that $(D,\mathcal{O}_D)$ is a locally $\mathbb{C}$-ringed space. 
\end{definition}


\begin{definition}\label{def-complexmodelspace}
    A \emph{complex model space} is a $\mathbb{C}$-ringed space $(X,\mathcal{O}_X)$ such that there exist
    \begin{enumerate}
        \item a domain $D$ in $\mathbb{C}^n$ for some $n\in \mathbb{N}$ and
        \item an ideal sheaf $\mathcal{I}$ in $\mathcal{O}_D$ of finite type
    \end{enumerate}
    such that thre is an isomorphism
    \[
        (X,\mathcal{O}_X)\cong (\Supp \mathcal{O}_D/\mathcal{I},i^{-1}(\mathcal{O}_D/\mathcal{I}))
    \]
    in the category of $\CRSCat$, where $i:\Supp \mathcal{O}_D/\mathcal{I}\rightarrow D$ is the inclusion map. Here $\mathcal{O}_D$ is the sheaf of $\mathbb{C}$-algebras defined in \cref{def-sheafondomain}.

    Clearly, $(X,\mathcal{O}_X)$ is a locally $\mathbb{C}$-ringed space.
\end{definition}
Observe that $X$ is always a Hausdorff space.

\begin{definition}\label{def-complexanalyticspace}
    A \emph{complex analytic space} is a locally $\mathbb{C}$-ringed space $(X,\mathcal{O}_X)$ such that 
    \begin{enumerate}
        \item $X$ is a Hausdorff space.
        \item For any $x\in X$, there is an open neighbourhood $U\subseteq X$ of $x$ such that $(U,\mathcal{O}_U:=\mathcal{O}_X|_U)$ is isomorphic to a complex model space in the sense of \cref{def-complexmodelspace} in the category $\CLRSCat$.
    \end{enumerate}
    When there is no risk of confusion, we also omit $\mathcal{O}_X$ from the notation say $X$ is a complex analytic space.

    A morphism between complex analytic spaces is a morphism of the underlying locally $\mathbb{C}$-ringed spaces. Such a morphism is also known as a \emph{holomorphic map}.

    The category of complex analytic spaces is denoted as $\CASCat$.
\end{definition}
\begin{remark}
    It seems that all authors on this subject requires that complex analytic spaces be Hausdorff, which may seem unnatural from the eyes of an algebro-geometrist. Morally, Hausdorffness corresponds to separatedness in the scheme world. However, non-Hausdorff analytic spaces do not seem to play a major role, in contrast to non-separated schemes, so we stick to the current definition.
\end{remark}
\begin{remark}
    Most of the authors require extra conditions in the definition of a complex analytic space: $\sigma$-compactness, paracompactness, having countable basis etc. We will not put these constraints in the definition, instead, we choose to include them into the assumptions of the theorems.
\end{remark}

\begin{proposition}
    Let $X$ be a complex analytic space, $x\in X$. Then $\mathcal{O}_{X,x}$ is a complex analytic local algebra.
\end{proposition}
Recall that complex analytic local algebras are defined in \cref{Local-def-complexanalylocaalg} in the Complex Analytic Local Algebras.

\begin{proof}
    The problem is local, so we may assume that $X$ is a complex model space. In this case, the result follows easily from \cref{prop-Cnlocalring}.
\end{proof}

\section{Open and closed immersions}

\begin{definition}
    A morphism $f:X\rightarrow Y$ of complex analytic spaces is an \emph{open immersion} if it is an open immersion of locally ringed spaces.
\end{definition}
Recall that an open immersion of locally ringed spaces is defined in \cite[\href{https://stacks.math.columbia.edu/tag/01HE}{Tag 01HE}]{stacks-project}.

\begin{example}
    Let $X$ be a complex analytic space and $U$ be an open subset of $U$. Then $U$ has a structure of complex anlaytic space induced from $X$. The inclusion $U\hookrightarrow X$ is an open immersion. We say $U$ is an \emph{open subspace} of $X$.
\end{example}

\begin{definition}
    A morphism $f:X\rightarrow Y$ of complex analytic spaces is a \emph{closed immersion} if it is a closed immersion of locally ringed spaces.

    The kenrel of the canonical morphism $\mathcal{O}_Y\rightarrow f_*\mathcal{O}_X$ is called the \emph{ideal} of $X$ in $Y$.
\end{definition}
Recall that a closed immersion of locally ringed spaces is defined in \cite[\href{https://stacks.math.columbia.edu/tag/01HK}{Tag 01HK}]{stacks-project}. Note that we have a short exact sequence
\[
    0\rightarrow \mathcal{I} \rightarrow \mathcal{O}_Y\rightarrow f_*\mathcal{O}_X\rightarrow 0.
\]
Later on, we will show that $\mathcal{I}$ is coherent after proving Oka's coherence theorem.

\begin{example}
    Let $X$ be a complex analytic space and $\mathcal{I}$ be a subsheaf of $\mathcal{O}_X$ locally generated by sections as a sheaf of $\mathcal{O}_X$-modules in the sense of \cite[\href{https://stacks.math.columbia.edu/tag/01B2}{Tag 01B2}]{stacks-project}. Set $Z=\Supp\mathcal{O}_X/\mathcal{I}$ and let $i:Z\rightarrow X$ be the inclusion map. Let $\mathcal{O}_Z$ be the unique sheaf of rings on $Z$ such that $i_*\mathcal{O}_Z=\mathcal{O}_X/\mathcal{I}$, whose existence and uniqueness is guaranteed by \cite[\href{https://stacks.math.columbia.edu/tag/01AX}{Tag 01AX}]{stacks-project}. Then $(Z,\mathcal{O}_Z)$ is a complex analytic space and $i:Z\rightarrow X$ is a closed immersion of complex analytic spaces. We say $Z$ is the \emph{closed subspace} of $X$ defined by $\mathcal{I}$.
\end{example}

\begin{definition}
    A morphism $f:X\rightarrow Y$ of complex analytic spaces is an \emph{immersion} if it can be factorized aas $j\circ i$ where $i$ is a closed immersion and $j$ is an open immersion. 
\end{definition}



\section{Weierstrass map}

\begin{definition}
    Let $d\in \mathbb{N}$ and $B$ be a domain (non-empty open subset) in $\mathbb{C}^d$. Let $\omega_j \in \mathcal{O}_B(B)[w_j]\subseteq \mathcal{O}_B(B)[w_1,\ldots,w_k]$ be monic polynomials for $j=1,\ldots,k$ for some $k\in \mathbb{N}$. We let $A$ be the closed subspace of $B\times \mathbb{C}^k$ defined by the ideal generated by $\omega_1,\ldots,\omega_k$. The projection map $B\times \mathbb{C}^k\rightarrow B$ induces a map $\pi:A\rightarrow B$. The map $\pi$ is called the \emph{Weierstrass} map defined by $\omega_1,\ldots,\omega_k$ over $B$.
\end{definition}


\begin{thm}\label{thm-Weiemapfiniteandopen}
    Let $d\in \mathbb{N}$ and $B$ be a domain in $\mathbb{C}^d$. Let $\omega_j \in \mathcal{O}_B(B)[w_j]\subseteq \mathcal{O}_B(B)[w_1,\ldots,w_k]$ be monic polynomials of degree $b_j$ for $j=1,\ldots,k$ for some $k\in \mathbb{N}$. Then the Weierstrass map $\pi:A\rightarrow B$ defined by $\omega_1,\ldots,\omega_k$ over $B$ is topologically finite and open.
\end{thm}


\begin{proof}
    We first prove that $\pi:A\rightarrow B$ is topologically finite. The only non-trivial point is to show that $\pi$ is closed. Let $M$ be a closed subset in $A$ and $y$ be a point in the closure of $\pi(M)$ in $B$.  Then we can find a sequence $(y_i,c_{1i},\ldots,c_{ki})\in M$ with $y_i\in B$ and $(c_{1i},\ldots,c_{ki})\in \mathbb{C}^k$
    for $i\in \mathbb{N}$ such that $y_i\to y$ in $B$ as $i\to\infty$. Then for each $i\in \mathbb{N}$ and $j=1,\ldots,k$, $(y_i,c_{ji})$ is a solution to $\omega_j(y_i,\bullet)$. By continuity of roots, up to extracting a subsequence, we can find $c_j\in \mathbb{C}$ such that $c_{ji}\to c_j$ when $i\to\infty$  for $j=1,\ldots,k$. It follows that $y=\pi(y,c_1,\ldots,c_k)\in \pi(M)$.

    It remains to show that $\pi$ is open. Take $p=(q,c)\in A$ with $q\in B$ and $c=(c_1,\ldots,c_k)\in \mathbb{C}^k$.  Let $U$ be an open neighbourhood of $p$ in $A$. We need to show that $\pi(U)$ contains an open neighbourhood of $\pi(p)$. We may assume that $U=A\cap (D\times W)$, where $D$ is an open neighbourhood of $q$ in $B$ and $W$ is an open neighbourhood of  $c$ in $\mathbb{C}^k$.

    By the proof of \cref{Local-thm-convpowerstrictHen} in \nameref{Local-chap-local}, chossing $D$ small enough, we may guarantee that there are monic polynomials $\omega_j',\omega_j''\in \mathcal{O}(B)[w_j]$ and $n_j\in \mathbb{Z}_{>0}$ such that 
    \[
        \omega_j|_{D\times \mathbb{C}^k}=\omega_j'\omega_j'',\quad \omega_j'(q,w)=(w-c_j)^{n_j}
    \]
    for $j=1,\ldots,k$. Let $A'$ be the closed subspace of $D\times \mathbb{C}^k$ defined by $\omega_1',\ldots,\omega_k'$. Then $A'\subseteq A$ by construction.  Let $\pi':A'\rightarrow D$ be the natural projection. Then $p$ is the only point on $\pi'^{-1}(q)$. We claim that there is an open neighbourhood $V\subseteq D$ of $q$ such that
    \[
        A'\cap (V\times \mathbb{C}^k)\subseteq V\times W.
    \]
    In fact, by \cref{Topology-lma-opennhfiberclosedmap} in \nameref{Topology-chap-topology}, we can find an open neighbourhood $V\subseteq D$ of $q$ such that
    \[
        \pi'^{-1}(V)\subseteq A'\cap (D\times W).
    \]
    But $\pi'^{-1}(V)=A'\cap (V\times \mathbb{C}^k)$. So our claim follows.

    It follows that $V\subseteq \pi(U)$ and our assertion follows.
\end{proof}

\begin{lemma}\label{lma-Weidivgeneralized}
    Let $d\in \mathbb{N}$, $B$ be a domain in $\mathbb{C}^d$  and 
    \[
        \omega=w^b+ a_1 w^{b-1}+\cdots+a_b \in \mathcal{O}_B(B)[w]
    \] 
    be a monic polynomial. Let $\pi:A\rightarrow B$ be the Weierstrass map  defined by $\omega$ over $B$.
    For any $y\in B$ and $x_1,\ldots,x_n$ be the distinct points in the fiber $\pi^{-1}(y)$. Then for any $f_j\in \mathcal{O}_{x_j}$ for $j=1,\ldots,n$, there exist germs $q_j\in \mathcal{O}_{x_j}$  for $j=1,\ldots,n$ and a polynomial $r\in \mathcal{O}_y[w]$ with $\deg r<b$ such that 
    \[
        f_j=\omega_{x_j}q_j+r_{x_j}
    \]
    for $j=1,\ldots,n$. The polynomial $r$ and the germs $q_1,\ldots,q_n$ are uniquely determined.
\end{lemma}
\begin{proof}
    We write 
    \[
        \omega(y,w)=(w-c_1)^{b_1}\cdots (w-c_n)^{b_n}   
    \]
    with $c_1,\ldots,c_n$ with $x_i=(y,c_i)$ for $i=1,\ldots,n$ and $b_1,\ldots,b_n\in \mathbb{Z}_{>0}$.

    By \cref{Local-thm-convpowerstrictHen} in \nameref{Local-chap-local}, we can find $\omega_1,\ldots,\omega_n\in \mathcal{O}_y[w]$ such that 
    \[
        \omega_{x_j}=\omega_{1x_j}\cdots\omega_{nx_j},\quad \omega_j(y,w)=(w-c_j)^{b_j}
    \]
    for $j=1,\ldots,n$. We define
    \[
        e_j:=\prod_{i\neq j}\omega_i\in \mathcal{O}_y[w]
    \]
    for $j=1,\ldots,n$. Then $e_{jx_j}$ is a unit in $\mathcal{O}_{x_j}$ for $j=1,\ldots,n$ as $e_j(x_j)=\prod_{i\neq j}(c_j-c_i)^{b_i}\neq 0$.

    By \cref{Local-thm-Weierstrassdiv} in \nameref{Local-chap-local}, each germ $f_je_{jx_j}^{-1}\in \mathcal{O}_{x_j}$ can be written as
    \[
        f_je_{jx_j}^{-1}=\omega_{jx_j} q_j'+r_{jx_j},
    \]
    where $q_j'\in \mathcal{O}_{x_j}$ and $r_j\in \mathcal{O}_y[w-c_j]$ with $\deg r_j<b_j$ for $j=1,\ldots,n$.
    Set $e_{ij}:=\prod_{k\neq i,j}\omega_k\in \mathcal{O}_y[w]$ for any $i,j=1,\ldots,n$ with $i\neq j$.  For $j=1,\ldots,n$, we define
    \[
        q_j:=q_j'-\sum_{i\neq j} r_{ix_j}e_{ijx_{j}} 
    \]
    and
    \[
        r=r_1e_1+\cdots+r_te_t\in \mathcal{O}_y[w].
    \]
    Then $f_j=\omega_{x_j}q_j+r_{x_j}$ for $j=1,\ldots,n$. This proves the uniqueness part.

    Next we show the uniqueness. Assume that
    \[
        0=\omega_{x_j}q_j+r_{x_j}
    \]
    with $q_j\in \mathcal{O}_{x_j}$ for $j=1,\ldots,n$ and $r\in \mathcal{O}_y[w]$ with degree less than $b$. We need to show that $r=0$. Assume by contrary that $r\neq 0$, then $p_j:=r(\omega_1\cdots\omega_j)^{-1}\neq 0$ for $j=1,\ldots,n$. Now $-r_{x_j}=(\omega_1\cdots\omega_n)_{x_j}q_j$ implies that $p_{jx_j}=-q_j(\omega_{j+1}\cdots \omega_n)_{x_j}\in \mathcal{O}_{x_j}$ for $j=1,\ldots,n$. Since $\omega_{jx_j}\in \mathcal{O}_y[w-c_j]$ is a Weierstrass polynomial, it follows from \cref{Local-lma-Weierstrasspolycancel} in \nameref{Local-chap-local} and
    \[
        r=p_1\omega_1,\quad p_{j-1}=p_j\omega_j\text{ for }j=2,\ldots,n
    \]
    that $p_1,\ldots,p_n$ are all polynomials in $w$. As $r=p_n\omega$, we have a contradiction as $\deg r<b$.
\end{proof}


\begin{thm}\label{thm-Weierstrassiso}
    Let $d\in \mathbb{N}$, $B$ be a domain in $\mathbb{C}^d$ and 
    \[
        \omega=w^b+ a_1 w^{b-1}+\cdots+a_b \in \mathcal{O}_B(B)[w]
    \] 
    be a monic polynomial. Let $\pi:A\rightarrow B$ be the Weierstrass map  defined by $\omega$ over $B$. Then we have a natural isomorphism of $\mathcal{O}_B$-modules
    \[
        \mathcal{O}_B^b\cn \pi_*\mathcal{O}_A.
    \]
\end{thm}
\begin{proof}
    We first define the map. Let $V\subseteq B$ be an open subset and $s=(s_0,\ldots,s_{b-1})\in \mathcal{O}_B(V)^b$. The polynomial $\sum_{j=0}^{b-1}s_j w^j$ determines a section $s'\in \mathcal{O}_A(\pi^{-1}(V))=\pi_*\mathcal{O}_A(V)$. The map $s\mapsto s'$ is clearly defines a map of $\mathcal{O}_B$-modules $\mathcal{O}_B^b\cn \pi_*\mathcal{O}_A$. In order to prove that this map is an isomorphism, it suffices to do so for each germ. Let $y\in B$ and $x_1,\ldots,x_n$ denote the points in the fiber $\pi^{-1}(b)$. By \cref{thm-Weiemapfiniteandopen} and \cref{Topology-cor-pushforwardsheaffinite} in \nameref{Topology-chap-topology}, we have a natural identification
    \[
        (\pi_*\mathcal{O}_A)_y\cn \prod_{j=1}^n \mathcal{O}_{A,x_j}.
    \]
    A germ $g\in (\pi_*\mathcal{O}_A)_y$ corresponds to $(g_1,\ldots,g_n)\in \prod_{j=1}^n \mathcal{O}_{A,x_j}$. By \cref{lma-Weidivgeneralized}, the latter can be uniquely lifted to $f_j\in \mathcal{O}_{x_j}$ for $j=1,\ldots,n$ such that if we define
    \[
        r:=\sum_{j=0}^{b-1}r_j w^j\in \mathcal{O}_y[w],
    \]   
    then $r_{x_j}$ restricts to $g_j$ for $j=1,\ldots,n$. This shows that the map of germs
    \[
        \mathcal{O}_{y}^b \rightarrow (\pi_*\mathcal{O}_A)_y 
    \]
    is bijective.
\end{proof}

\section{Oka's coherence theorem}

\textcolor{red}{This lemma needs to be placed elsewhere. Proof at CAS p58 needs to be included}
\begin{lemma}\label{lma-formalcoherencecriterion}
    Let $X$ be a topological space and $\mathcal{A}$ be a Hausdorff sheaf of rings on $X$ (in the sense that the espace étalé of $\mathcal{A}$ is Hausdorff) such that all stalks of $\mathcal{A}$ are integral domains. Then $\mathcal{A}$ is coherent if and only if for any open set $V\subseteq X$ and any section $s\in \mathcal{A}(X)$, $\mathcal{A}_V/s\mathcal{A}_V$ is coherent at every $x\in V$ where $s_x\neq 0$.
\end{lemma}

\begin{lemma}[Oka]\label{lma-Okacoh}
    For any $n\in \mathbb{N}$, $\mathcal{O}_{\mathcal{C}^n}$ is coherent.
\end{lemma}
\begin{proof}
    As a preparation, observe that $\mathcal{O}_{\mathbb{C}^n}$ is a Hausdorff sheaf.
    
    For any two germs $s_i\in \mathcal{O}_{\mathbb{C}^n,a_i}$ ($i=1,2$), we need to construct disjoint open neighbourhoods $U_i$ in the espace étalé of $\mathcal{O}_{\mathbb{C}^n}$ of $s_i$. If $a_1\neq a_2$, the assertion is clear. So assume that $a_1=a_2=0$. We extend $s_i$ to $f_i\in \mathcal{O}_{\mathbb{C}^n}(U)$ for a connected open neighbourhood $U\subseteq \mathbb{C}^n$ of $0$. Then $\{f_x:x\in U\}$ and $\{g_x:x\in U\}$ are disjoint: if for some $z\in U$, $f_z=g_z$, then the same holds in a neighbourhood of $z$ and so $f=g$ on $U$ by Identitätssatz. \textcolor{red}{Include the proof}

    We will prove the coherence of $\mathcal{O}_{\mathcal{C}^n}$ by induction on $n$. The case $n=0$ is trivial. Assume that $n>0$ and the theorem has been proved for all smaller $n$. We will apply \cref{lma-formalcoherencecriterion}. Take an open set $U\subseteq \mathbb{C}^n$ and $g\in \mathcal{O}_{\mathbb{C}^n}(U)$. We need to show that $\mathcal{O}_U/g\mathcal{O}_U$ is coherent at all $x\in U$ with $g_x\neq 0$.

    Fix such a point $x$, which may be assumed to be $0$. We may assume that $g(0)=0$ as otherwise, the stalk of $\mathcal{O}_U/g\mathcal{O}_U$ at $0$ is trivial. By perturbing the coordinates, we may guarantee that $g_0(0,w)$ is not identically $0$ for $w\in \mathbb{C}$. By Weierstrass preparation theorem \cref{Commutative-thm-Weierstrassprep}, there is a Weierstrass polynomial $\omega_0\in \mathcal{O}_{\mathbb{C}^{n-1},0}[w]$ such that $g_0\mathcal{O}_{\mathbb{C}^n,0}=\omega_0\mathcal{O}_{\mathbb{C}^n,0}$. Lift $\omega_0$ to $\omega\in \mathcal{O}_{\mathbb{C}^{n-1}}(B)$ for some neighbourhood $B\subseteq \mathbb{C}^{n-1}$ of $0$. In order to show the coherence of $\mathcal{O}_U/g\mathcal{O}_U$ near $0$, it suffices to show that $\mathcal{O}_{B\times \mathbb{C}}/\omega \mathcal{O}_{B\times \mathbb{C}}$ near $0$. Let $A\subseteq B\times \mathbb{C}$ be the closed subspace defined by $\omega$ and $\pi:A\rightarrow B$ be the Weierstrass map, then it suffices to show that $\mathcal{O}_{A}$ is coherent near $0$. By our inductive hypothesis, $\mathcal{O}_B$ is coherent. We claim that $\mathcal{O}_A$ is also coherent. Let $b$ be the degree of $\omega$. We recall that $\pi$ is topologically finite by \cref{thm-Weiemapfiniteandopen}.

    We first prove a special case: let $p\in \mathbb{N}$ and $\varphi:\mathcal{O}_A^p\rightarrow \mathcal{O}_A$ be an $\mathcal{O}_A$-homomorphism. We show that $\ker \varphi$ is of finite type. By  \cref{thm-Weierstrassiso}, $\pi_*\mathcal{O}_A^p$ is coherent. So $\pi_*\ker \varphi$ is coherent by \cref{Topology-cor-pushforwardsheaffinite} in \nameref{Topology-chap-topology}. It follows that $\ker \varphi$ is of finite type.

    Next let $U\subseteq A$ be an open subset and $s_1,\ldots,s_p\in \mathcal{O}_A(U)$. We need to show that the kernel of the assocaited map
    \[
        \mathcal{O}_U^p\rightarrow \mathcal{O}_A|_U
    \]
    is of finite type. By \cref{Topology-thm-localstructuretopfinitemap} in \nameref{Topology-chap-topology}, for each $x\in U$, we can find an open neighbourhood $V$ of $x$ in $U$ such that $\pi^{-1}(V)$ is the disjoint union of open neighbourhoods $U_1,\ldots,U_n$ of the points in $\pi^{-1}(\pi(x))$. We may assume that $x\in U_1$. Extend $s_j|_{U_1}$ to $s_j'\in \mathcal{O}_A(\pi^{-1}(V))$ by setting its values to be $0$ on $U_2,\ldots,U_n$ for $j=1,\ldots,p$. Then $\varphi$ extends to $\varphi':\mathcal{O}_{\pi^{-1}(V)}^p\rightarrow \mathcal{O}_{\pi^{-1}(V)}$ with the same kernel over $U_1$. By what we have proved, $\ker \varphi'$ is of finite type. Hence so is $\ker \varphi$.
\end{proof}
As a corollary, we have the important Oka's coherence theorem.
\begin{thm}\label{thm-Okacoh}
    Let $X$ be a complex analytic space, then $\mathcal{O}_X$ is coherent.
\end{thm}
\begin{proof}
    The problem is local on $X$, so we may assume that $X$ is a complex model space, say there is a closed immersion into a domain $D$ in $\mathbb{C}^n$ defined by an ideal of finite type $\mathcal{I}$. By \cref{lma-Okacoh}, $\mathcal{O}_D$ is coherent and hence $\mathcal{I}$ is coherent. It follows that $\mathcal{O}_D/\mathcal{I}$ is coherent and hence $\mathcal{O}_X$ is coherent.
\end{proof}

\begin{definition}
    Let $f:X\rightarrow Y$ be a morphism of complex analytic spaces such that $f_*\mathcal{O}_X$ is coherent. We define the \emph{complex image space} $f(X)$ of $f$ as the closed subspace of $Y$ defined by $\Ann_{\mathcal{O}_Y}(f_*\mathcal{O}_X)$.
\end{definition}
Here we need \cref{thm-Okacoh} to guarantee that $\Ann_{\mathcal{O}_Y}(f_*\mathcal{O}_X)$ is coherent. Observe that the support of $\mathcal{O}_Y/\Ann_{\mathcal{O}_Y}(f_*\mathcal{O}_X)$ is exactly $f(X)$ in the set-theoretic sense. Moreover, we have $f$ factorizes canonically through a morphism $X\rightarrow Z$.

\section{Finite mapping theorem}

\begin{definition}
    A morphism of complex analytic spaces $f:X\rightarrow Y$ is \emph{finite} if its underlying map of topological spaces is topologically finite.
\end{definition}
\begin{definition}
    A morphism of complex analytic spaces $f:X\rightarrow Y$ is \emph{quasi-finite at $x\in X$} if $x$ is an isolated point in $f^{-1}(f(x))$.

    A morphism of complex analytic spaces $f:X\rightarrow Y$ is \emph{quasi-finite} if it is quasi-finite at all $x\in X$.
\end{definition}

\begin{proposition}\label{prop-projlemma}
    Let $n\in \mathbb{N}$ and $D$ be an open neighbourhood of $0$ in $\mathbb{C}^n$. 
    Let $X$ be a closed subspace of $D$ which intersections $\{(0,\ldots,0)\}\times \mathbb{C}$ at and only at $0$. Then there is a connected open product neighbourhood $B\times W\subseteq \mathbb{C}^{n-1}\times \mathbb{C}$ of $0$ in $D$ such that 
    \begin{enumerate}
        \item the projection $B\times W\rightarrow B$ induces a finite morphism $h:X'\rightarrow B$ with $X'=X\cap (B\times W)$;
        \item for any coherent sheaf $\mathcal{M}$ of $\mathcal{O}_{X'}$-modules, $h_*\mathcal{M}$ is coherent.
    \end{enumerate}
\end{proposition}
\begin{proof}
    We will denote the coordinates on $\mathbb{C}^{n-1}\times \mathbb{C}$ as $(z,w)$.

    Let $\mathcal{I}$ be the ideal of $X$ in $D$. By our assumption, we can choose $f_0\in \mathcal{I}_0$ such that $\deg_w f_0<\infty$ and $f_0(0)=0$. By \cref{Local-thm-Weierstrassprep} in \nameref{Local-chap-local}, we can find a Weierstrass polynomial $\omega_0=w^b+a_1w^{b-1}+\cdots+a_b\in \mathbb{C}\{ z_1,\ldots,z_{n-1} \}[w]$ such that $f_0=e\omega_0$ for some unit $e$ in $\mathbb{C}\{ z_1,\ldots,z_{n} \}$. We choose a product neighbourhood $B\times W\subseteq \mathbb{C}^{n-1}\times \mathbb{C}$ of $0$ in $D$ such that $\omega_0$ can be represented by $\omega\in \mathcal{O}_{\mathbb{C}^{n-1}}(B)[w]$ with $\omega|_{B\times W}\in \mathcal{I}(B\times W)$. Let $\pi:A\rightarrow B$ be the Weierstrass map defined by $\omega$. Then $\pi$ is finite by \cref{thm-Weiemapfiniteandopen}. 
    Up to shrinking $B$ and $W$, we may assume that $A\cap (B\times W)\rightarrow B$ is finite as well. Set $X':=X\cap (B\times W)$. The restriction $h:X'\rightarrow B$ of $\pi$ is then finite. This proves (1).

    Let $\mathcal{I}'$ be the zero-extension of $\mathcal{I}$ to $A$. Then $\mathcal{I}'$ is coherent. It suffices to show that $\pi_*\mathcal{I}'$ is coherent. Let $y\in B$ be a point and $x_1,\ldots,x_n$ be the distinct points in $\pi^{-1}(y)$.  FOr each $j=1,\ldots,n$, we can find an open neighbourhood $U_j$ of $x_j$ in $A$, pairwise disjoint and an exact sequence 
    \[
        \mathcal{O}_{U_j}^{p_j}\rightarrow \mathcal{O}_{U_j}^{q_j}\rightarrow \mathcal{I}'|_{U_j}\rightarrow 0
    \]
    for some $p_j,q_j\in \mathbb{Z}_{>0}$.  We may assume that $p_1=\cdots=p_n$ and $q_1=\cdots=q_n$. We denote the common values by $p$ and $q$. Then $U=U_1\cup\cdots\cup U_n$ is a neighbourhood of $\pi^{-1}(y)$, and we have an exact sequence 
    \[
        \mathcal{O}_{U}^{p}\rightarrow \mathcal{O}_{U}^{q}\rightarrow \mathcal{I}'|_{U}\rightarrow 0.
    \]
    By \cref{Topology-lma-opennhfiberclosedmap} in \nameref{Topology-chap-topology}, we may assume that $U=\pi^{-1}(V)$ for some open neighbourhood $V$ of $y$ in $B$. The induced map $\pi':U\rightarrow V$ is finite and by \cref{Topology-cor-pushforwardsheaffinite} in \nameref{Topology-chap-topology}, we have an exact sequence
    \[
        \pi'_*\mathcal{O}_{U}^{p}\rightarrow \pi'_*\mathcal{O}_{U}^{q}\rightarrow \pi'_*\left(\mathcal{I}'|_{U}\right)=(\pi_*\mathcal{I}')|_V\rightarrow 0.
    \]
    By \cref{thm-Okacoh} and \cref{thm-Weierstrassiso}, the first two terms are both coherent, hence so is $(\pi_*\mathcal{I}')|_V$.
\end{proof}

\begin{corollary}\label{cor-projlemma}
    Let $n,k\in \mathbb{N}$ and $D$ be an open neighbourhood of $0$ in $\mathbb{C}^n$. 
    Let $X$ be a closed subspace of $D$ which intersections $\{(0,\ldots,0)\}\times \mathbb{C}^k$ at and only at $0$. Then there is a connected open product neighbourhood $B\times W\subseteq \mathbb{C}^{n-k}\times \mathbb{C}^k$ of $0$ in $D$ such that 
    \begin{enumerate}
        \item the projection $B\times W\rightarrow B$ induces a finite morphism $h:X'\rightarrow B$ with $X'=X\cap (B\times W)$;
        \item for any coherent sheaf $\mathcal{M}$ of $\mathcal{O}_{X'}$-modules, $h_*\mathcal{M}$ is coherent.
    \end{enumerate}
\end{corollary}
\begin{proof}
    This follows from a repeted application of \cref{prop-projlemma}
\end{proof}

\begin{proposition}\label{prop-quasifinitefinite}
    Let $f:X\rightarrow Y$ be a morphism of complex analytic spaces. Assume that $f$ is quasi-finite at $x\in X$. Then there is an open neighbourhood $U$ of $x$ in $X$ and an open neighbourhood of $f(x)$ in $Y$ with $f(U)\subseteq V$ such that 
    \begin{enumerate}
        \item the induced map $f':U\rightarrow V$ is finite;
        \item for any coherent sheaf $\mathcal{F}$ of $\mathcal{O}_U$-modules, $f'_*\mathcal{F}$ is coherent. 
    \end{enumerate}
\end{proposition}
\begin{proof}
    The assertion is local on both $X$ and $Y$. So we may assume that $U$ and $V$ are complex model spaces in domains $W\subseteq \mathbb{C}^k$ and $B\subseteq \mathbb{C}^d$ respectively with $x=0$ and $y=0$. Moreover, we may assume that $\{x\}=f'^{-1}(y)$. We have the following commutative diagram:
    \[
        \begin{tikzcd}
            &                                & U\times V \arrow[dd] \arrow[r, hook] & W\times B \arrow[dd] \\
U \arrow[r] \arrow[rrd,"f'"] & \Gamma_f \arrow[rd] \arrow[ru] &                                      &                      \\
            &                                & V \arrow[r, hook]                    & B                   
\end{tikzcd},
    \]
    where $\Gamma_{f'}$ denotes the graph of $f':U\rightarrow V$. As $\{x\}=f'^{-1}(y)$, we have $\mathbb{C}^k\times\{0\}$ intersects $\Gamma_f$ only at the origin. By \cref{cor-projlemma}, up to shrinking $W$ and $B$, we may guarantee that the projection $W\times B\rightarrow B$ induces a finite morphism $\Gamma_f\rightarrow B$ and the pushforward under this map preserves coherence. Observe that $U\rightarrow \Gamma_f$ is a biholomorphism, we conclude that $f'$ is finite. This proves (1). Moroever, observe that the zero-extension of $f'_*\mathcal{I}$ is the successive pushforward of $\mathcal{I}$ along $U\rightarrow U_f$ and then along $U_f\rightarrow B$. It follows that  $f'_*\mathcal{I}$ is coherent.
\end{proof}


\begin{theorem}\label{thm-finitepushcoherent}
    Let $f:X\rightarrow Y$ be a finite morphism of complex analytic spaces, then for any coherent sheaf $\mathcal{M}$ of $\mathcal{O}_X$-modules, $f_*\mathcal{M}$ is also coherent.
\end{theorem}
\begin{proof}
    Let $y\in Y$ and $x_1,\ldots,x_n$ be the distinct points in $f^{-1}(y)$. By \cref{prop-quasifinitefinite}, we can find an open neighbourhood $W_j$ of $x_j$ in $X$ and open neighbourhoods $V_j$ of $y$ in $Y$ with $f(W_j)\subseteq V_j$ for $j=1,\ldots,n$ such that the induced maps $W_j\rightarrow V_j$ are all finite and pushforwards along these maps preserve coherence. We may assume that $W_1,\ldots,W_n$ are pairwise disjoint.
    Let $V=V_1\cap \cdots\cap V_n$. For each $j=1,\ldots,n$, define $U_j:=f^{-1}(V)\cap W_j$. By \cref{Topology-thm-localstructuretopfinitemap} in \nameref{Topology-chap-topology}, up to shrinking $V$ and $W$, we may guarantee that
    \[
        (f_*\mathcal{I})|_V\cong \prod_{j=1}^n f_{j*}(\mathcal{I}|_{U_j}),
    \]
    where $f_j:U_j\rightarrow V$ is the morphism induced by $f$. Now it is clear that $(f_*\mathcal{I})|_V$ is coherent.
\end{proof}
\begin{corollary}
    Let $i:X\rightarrow Y$ be a closed immersion. Then the ideal $\mathcal{I}$ of $i$ is coherent.
\end{corollary}
\begin{proof}
    Recall that we have a short exact sequence 
    \[
        0\rightarrow \mathcal{I} \rightarrow \mathcal{O}_Y\rightarrow i_*\mathcal{O}_X\rightarrow 0.
    \]
    The terms $\mathcal{O}_Y$ and $i_*\mathcal{O}_X$ are coherent by \cref{thm-Okacoh} and \cref{thm-finitepushcoherent}, hence so is $\mathcal{I}$.
\end{proof}

\section{Rückert Nullstellensatz}

Let $X$ be a complex analytic space. It is a sheaf of $\mathbb{C}$-algebras.
For any sheaf of local $\mathbb{C}$-algebras $\mathcal{A}$ on $X$, any open set $U\subseteq X$ and any $s\in \mathcal{A}_X(U)$. We want to construct a function $[s]:U\rightarrow \mathbb{C}$.

Take $x\in U$, there is a canonical splitting
\begin{equation}\label{eq:Axdecomp}
  \mathcal{A}_{x}\cong \mathbb{C}\oplus \mathfrak{m}_{x}, 
\end{equation}
where $\mathfrak{m}_x$ is the maximal ideal of $\mathcal{A}_{x}$. Then we define $[s](x)$ as the image of $s_x$ in the $\mathbb{C}$-factor in \eqref{eq:Axdecomp}.

\begin{definition}\label{def-valuesectionatapoint}
    Let $X,\mathcal{A},U,x,s$ be as above. The value $[s](x)\in \mathbb{C}$ is called the \emph{value} of $s$ at $x$. We sometimes denote it by $s(x)$ as well.
\end{definition}

\begin{lemma}
    Let $X$ be a complex analytic space. We denote by $\mathcal{C}_X$ the sheaf of continuous functions on $X$. 
    The association $s\mapsto [s]$ in \cref{def-valuesectionatapoint} defines a homomorphism of sheaves of $\mathbb{C}$-algebras $\mathcal{O}_X\rightarrow \mathcal{C}_X$. 
\end{lemma}
When there is no risk of confusion, we also write $s$ instead of $[s]$.
\begin{proof}
    We need to show that for any open set $U\subseteq X$ and any $s\in \mathcal{O}_X(U)$, $[s]$ is a continuous function on $U$. 
    
    We may clearly assume that $U=X$. The problem is local on $X$, so we may assume that $X$ is a complex model space in the sense of \cref{def-complexmodelspace} defined by a coherent ideal $\mathcal{I}$ in a domain $D$ in $\mathbb{C}^n$. By further localizing, we may assume that $s$ can be lifted to a section $f\in\mathcal{O}_D(D)$. Then $[s]=f|_X$ by definition. So the assertion follows from the fact that a holomorphic function on a domain is continuous.
\end{proof}

\begin{thm}[Rückert Nullstellensatz]
    Let $X$ be a complex analytic space and $\mathcal{F}$ be a coherent sheaf of $\mathcal{O}_X$-modules. Let $f\in \mathcal{O}_X(X)$ be a function that vanishes on $\Supp \mathcal{F}$. Then for any $x\in X$, there is an open neighbourhood $U\subseteq X$ of $x$ and $m\in \mathbb{Z}_{>0}$ such that $f^m\mathcal{F}|_U=0$.
\end{thm}
\begin{proof}
    We may assume that $x\in \Supp \mathcal{F}$ as otherwise there is nothing to prove. In particular, $f(x)=0$.

    \textbf{Step~1}. We first reduce the problem to a relatively simple situation.

    The problem is local on $X$, so we may assume that there is a domain $D$ containing $0$ in $\mathbb{C}^n$ and a closed immersion $\iota:X\rightarrow D$ sending $x$ to $0$. Consider the closed immersion $g:V\rightarrow D\times \mathbb{C}$ induced by $\iota$ and $f$. Assume that this theorem has been proved for $w$, $B\times \mathbb{C}$, $g_*\mathcal{F}$ in place of $f$, $X$, $\mathcal{F}$ respectively, then we would find an integer $m\in \mathbb{Z}_{>0}$ such that $w^m(g_*\mathcal{F})_0=0$. In particular, $f^m\mathcal{F}_x=0$. As $\mathcal{F}$ is coherent, there is an open neighbourhood $U\subseteq X$ of $x$ such that $f^t\mathcal{F}|_U=0$.

    \textbf{Step~2}. We are reduced to prove the following special case: let $D$ be a domain in $\mathbb{C}^n$ containing $0$, $\mathcal{F}$ is a coherent sheaf on $D$ whose support is contained in $\{(z,w)\in \mathbb{C}^{n-1}\times \mathbb{C}:(z,w)\in D,w=0\}$. Then there is $m\in \mathbb{Z}_{>0}$ such that $w^m\mathcal{F}_0=0$.

    Let $\mathcal{G}$ be the annihilator sheaf of $\mathcal{F}$: 
    \[
       \mathcal{G}:=\ker \left(\mathcal{O}_D\rightarrow \Homint_{\mathcal{O}_D}(\mathcal{F},\mathcal{F})\right),
    \]
    where the map $\mathcal{O}_D\rightarrow \Homint_{\mathcal{O}_D}(\mathcal{F},\mathcal{F})$ sends a local section $f$ of $\mathcal{O}_D$ to the endohomomorphism of multiplying by $f$ of $\mathcal{F}$.
    Then $\mathcal{G}$ is a coherent sheaf by Oka's coherence theorem \cref{thm-Okacoh}. So it has closed supports. But by our assumtion, the support of $\mathcal{G}$ contains all $w\neq 0$, so $\Supp \mathcal{G}=D$.

    Let $f\in \mathcal{G}_0$ be a non-zero element. Write
    \[
      f=\sum_{j=b}^{\infty}a_jw^j,\quad a_j\in \mathcal{O}_{\mathbb{C}^{n-1},0},a_b\neq 0
    \]
    for some $b\in \mathbb{N}$.
    We may assume that $b=0$ by replacing $f$ and $\mathcal{F}$ with $w^{-b}f$ and  $w^b\mathcal{F}$ respectively. We want to show that $w^m\mathcal{F}_0=0$ for some positive integer $m$. 
    
    When $a_0$ is a unit, namely when $a_0(0)\neq 0$, then $f$ is a unit, so $\mathcal{F}_0=0$. We make an induction on $n$. The case $n=1$ is trivial, as $a_0$ is always a unit.
    So we may assume that $a_0(0)=0$ and $n>1$. By perturbing the coordinates in $\mathbb{C}^{n-1}$, we may assume that $a_0$ is not identically zero in the variable $z_1$. 
    
    Shrinking $D$, we may assume that $f$ can be lifted to a holomorphic function $g\in \mathcal{O}_D(D)$ with $g\mathcal{F}=0$. By our assumption on $a_0$, we may assume that $Z(g)\cap \{(z_1,0,\ldots,0)\in D\}=\{0\}$. Hence, $D\cap \Supp \mathcal{F}$, which is a subset of $Z(g)$ also intersects the $z_1$-axis only at the origin.

    By \textcolor{red}{To be included}, we can find a product domain $B\times W\subseteq D$ with $B\subseteq \mathbb{C}$ and $W\subseteq \mathbb{C}^{n-1}$ containing $0$ such that the projection $h:(B\times W)\cap \Supp \mathcal{F}\rightarrow B$ is finite and $\mathcal{F}':=h_*(\mathcal{F}|_{B\times W})$ is a coherent sheaf of $\mathcal{O}_B$-modules. Observe that $\Supp \mathcal{F}'\subseteq \{(z_2,\ldots,z_{n-1},w)\in B:w=0\}$, we can apply the induction hypothesis to obtain $m\in \mathbb{Z}_{>0}$ such that $w^{m}\mathcal{F}'_0=0$. It follows that $w^{m}\mathcal{F}_0=0$.
\end{proof}

\section{Finite limits in the category of complex analytic spaces}

The goal of this section is to show that the category of complex analytic spaces admits finite limits.

As the category $\CASCat$ admits a final object, namely $\mathbb{C}^0$, the existence of finite limits is the same as the existence of fiber products by general abstract nonsense \cite[\href{https://stacks.math.columbia.edu/tag/002O}{Tag 002O}]{stacks-project}.

We begin by considering direct products, namely fiber products over $\mathbb{C}^0$. 

\begin{lemma}\label{lma-CmCnproductexist}
Let $m,n\in \mathbb{N}$. Then 
\[
    \mathbb{C}^m\times \mathbb{C}^n\cong \mathbb{C}^{m+n}. 
\]    
Here $\times$ denotes the product in $\CASCat$.
\end{lemma}
\begin{proof}
    By Yoneda lemma \cite[\href{https://stacks.math.columbia.edu/tag/001P}{Tag 001P}]{stacks-project}, it suffices to establish
    \[
        h_{\mathbb{C}^m\times \mathbb{C}^n}\cong h_{\mathbb{C}^{m+n}},
    \]
    where $h_{\bullet}$ denotes the functor of points \cite[\href{https://stacks.math.columbia.edu/tag/001O}{Tag 001O}]{stacks-project}. Take $T\in \CASCat$, then there are isomorphisms
    \[
        h_{\mathbb{C}^m\times \mathbb{C}^n}(T)\cn h_{\mathbb{C}^m}(T)\times h_{\mathbb{C}^m}(T)\cn (\mathcal{O}_{T}(T))^{m+n}\cn   h_{\mathbb{C}^{m+n}}(T),
    \]
    which are all functorial in $T$. We conclude.
\end{proof}

\begin{lemma}\label{lma-existfiberproductimmersion}
    Let $f:X\rightarrow Y$ be a morphism in $\CASCat$. Let $i:Z\rightarrow Y$ be a closed (resp. an open) immersion. Then the fiber product $X\times_Y Z$ exists. Moreover, $X\times_Y Z\rightarrow X$ is a closed (resp. an open) immersion and there is a natural identification $|X\times_Y Z|\cong |X|\times_{|Y|}|Z|$.
\end{lemma}
We can draw a Cartesian diagram
\[
    \begin{tikzcd}
        & X\times_Y Z \arrow[r]\arrow[d]\arrow[rd,"\square",phantom] & X \arrow[d,"f"]\\
        & Z  \arrow[r,"i"] & Y
    \end{tikzcd}
\]
\begin{proof}
    When $i$ is an open immersion, it suffices to take $X\times_Y Z$ as the open subspace of $X$ defined by $f^{-1}(i(Z))$.

    Let us consider the case where $i$ is a closed immersion defined by a coherent ideal sheaf $\mathcal{I}$. It is a general result that $X\times_Y Z$ in the category $\LRSCat$ exists \cite[\href{https://stacks.math.columbia.edu/tag/01HQ}{Tag 01HQ}]{stacks-project}. Let us show that $X\times_Y Z$ is a closed complex analytic subspace of $X$ and conclude. To do so, recall that $X\times_Y Z$ is by construction a closed subspace of $X$ defined by $\mathcal{J}:=\Img \left(f^*\mathcal{I}\rightarrow f^*\mathcal{O}_Y=\mathcal{O}_X\right)$. It suffices to show that $\mathcal{J}$ is of finite type. By this is clear as $\mathcal{I}$ is of finite type.

    The identification of the underlying topological space is obvious.
\end{proof}

\begin{lemma}\label{lma-existproductimplyexistimm}
    Let $X$, $Y$ be complex analytic spaces. Consider open (resp. closed) immersions $X'\rightarrow X$ and $Y'\rightarrow Y$. If $X\times Y$ exists, then so is $X'\times Y'$ and the natural morphism $X'\times Y'\rightarrow X\times Y$ is an open (resp. a closed) immersion.
\end{lemma}
\begin{proof}
    We form the following large Cartesian diagram
    \[
        \begin{tikzcd}
            Z \arrow[r] \arrow[d] \arrow[rd, "\square", phantom]   & X'' \arrow[r] \arrow[d] \arrow[rd, "\square", phantom]       & X' \arrow[d] \\
            Y'' \arrow[d] \arrow[r] \arrow[rd, "\square", phantom] & X\times Y \arrow[d] \arrow[r] \arrow[rd, "\square", phantom] & X \arrow[d]  \\
            Y' \arrow[r]                                           & Y \arrow[r]                                                  & \mathbb{C}^0
        \end{tikzcd}
    \]
    The existences of all but the lower right square are guaranteed by \cref{lma-existfiberproductimmersion}. More precisely, we first define the upper right square and the lower left square by \cref{lma-existfiberproductimmersion}. It follows from \cref{lma-existfiberproductimmersion} that $X''\rightarrow X\times Y$ is an open (resp. a closed) immersion. So we can apply \cref{lma-existfiberproductimmersion} again to construct the upper left square.

    It follows from general abstract nonsense that the big square is also Cartesian. Moreover, by \cref{lma-existfiberproductimmersion} again, $Z\rightarrow Y''$ and $Y''\rightarrow X\times Y$ are both open (resp. closed) immersions. It follows that $Z\rightarrow X\times Y$ is also an open (resp. a closed) immersion.
\end{proof}

\begin{corollary}\label{cor-existproductmodel}
    Let $X$, $Y$ be complex model spaces. Then $X\times Y$ exists.
\end{corollary}
\begin{proof}
    By \cref{lma-existproductimplyexistimm}, we may assume that $X$ and $Y$ are both domains in some $\mathbb{C}^m$ and $\mathbb{C}^n$ respectively. Then applying \cref{lma-existproductimplyexistimm} again, we reduce to the case where $X=\mathbb{C}^m$ and $Y=\mathbb{C}^n$. This case is handled in \cref{lma-CmCnproductexist}.
\end{proof}

\begin{corollary}\label{cor-finitedirectproductexist}
    Let $X$, $Y$ be complex analytic spaces. Then $X\times Y$ exists in $\CASCat$. Moreover, there is a natural identification $|X\times Y|\cong |X|\times |Y|$.
\end{corollary}
\begin{proof}
    Let 
    \[
        X=\bigcup_{i\in I_X} X_i,\quad   X=\bigcup_{j\in I_Y} Y_j
    \]
    be open coverings of $X$ by complex model spaces. Let $K=I_X\times I_Y$. For each $k=(i,j)\in K$, we let $Z_k=X_i\times Y_j$, whose existence is guaranteed by \cref{cor-existproductmodel}. Take another $k'=(i',j')\in K$, then 
    \[
        Z_{kk'}:=Z_k\cap Z_{k'}=(X_i\times X_{i'})\cap (Y_{j}\times Y_{j'})
    \]
    is an open subspace of $Z_k$. It is clear that $Z_{kk'}$ forms a glueing data. From the general result \cite[\href{https://stacks.math.columbia.edu/tag/01JB}{Tag 01JB}]{stacks-project}, we can glue $Z_k$'s into a locally ringed space $Z$. From the construction, $|Z|=|X|\times |Y|$ in the category of topological spaces, so $|Z|$ is Hausdorff. On the other hand, from the construction, locally $Z$ is isomorphic to some $Z_k$, so $Z$ is a complex analytic space. As $Z$ is clearly the product in the category of locally $\mathbb{C}$-ringed spaces, we conclude that $Z=X\times Y$ in  $\CASCat$.
\end{proof}

\begin{corollary}
    The category $\CASCat$ admits all finite limits. Moreover, finite limits commute with the forgetful functor $\CASCat\rightarrow \TopCat$.
\end{corollary}
\begin{proof}
    By \cite[\href{https://stacks.math.columbia.edu/tag/002O}{Tag 002O}]{stacks-project}, \cref{cor-finitedirectproductexist} and the existence of a final object in $\CASCat$ (namely, $\mathbb{C}^0$), it suffices to show the existence of fiber products. In other words, suppose that we are given three complex analytic spaces $Z,X,Y$ and morphisms $X\rightarrow Z$ and $Y\rightarrow Z$ in $\CASCat$, we need to prove the existence of $X\times_Z Y$. From the general abstract nonsense, we can define $X\times_Z Y=(X\times Z)_{Y\times Y,\Delta_Y}Y$:
    \[ 
    \begin{tikzcd}
        & X\times_Y Z \arrow[r]\arrow[d]\arrow[rd,"\square",phantom] & X\times Z \arrow[d]\\
        & Y  \arrow[r,"\Delta_Y"] & Y\times Y
    \end{tikzcd},
    \]
    where $\Delta_Y:Y\rightarrow Y\times Y$ is the diagonal morphism, which is a closed immersion, the existence of $X\times Z$ is guaranteed by \cref{cor-finitedirectproductexist} and the existence of the fiber product is guaranteed by \cref{lma-existfiberproductimmersion}.

    In order to verify that finite limits commute with the forgetful functor $\CASCat\rightarrow \TopCat$, it suffices to consider fiber products. By \cref{lma-existfiberproductimmersion}, we reduced to the case of finite products. In this case, the result is proved in \cref{cor-finitedirectproductexist}.
\end{proof}
\begin{remark}
    It is important to remember that the forgetful functor $\CASCat\rightarrow \CLRSCat$ does \emph{not} commute with finite limits, in contrast to the case of schemes \cite[\href{https://stacks.math.columbia.edu/tag/01JN}{Tag 01JN}]{stacks-project}. While the forgetful functor from the category of schemes $\SchCat$ to $\TopCat$ does not commute with finite limits.
    
    These facts indicate that there are essential differences between the theory of analytic spaces and the theory of schemes.
\end{remark}

Next we study the local rings of fiber products.
\begin{theorem}
    Let $Y$ be an object in $\CASCat$ and $X_1,X_2\in \CASCat_{/Y}$. Let $(x_1,x_2)$ be a point of $X_1\times_Y X_2$, namely, $x_i\in X_i$ for $i=1,2$ and the images of $x_1$ and $x_2$ in $Y$ coincide, say $y\in Y$. 
    Then there is a caonical isomorphism
    \[
        \mathcal{O}_{X_1\times_Y X_2, (x_1,x_2)}\cong \mathcal{O}_{X_1,x_1}\overline{\otimes}_{\mathcal{O}_{Y,y}}  \mathcal{O}_{X_2,x_2}.     
    \]
\end{theorem}
The analytic tensor product here is defined \cref{Local-def-analytictensor} in the Complex Analytic Local Algebras. We have shown its existence in \cref{Local-thm-relanalytictensorexist} in the same chapter.

\begin{proof}
    Comparing the constructions of both sides, we see that it suffices to prove the theorem in two special cases: when $Y=\mathbb{C}^0$ and when $X_2\rightarrow Y$ is a closed immersion. 

    We first consider the case where $Y=\mathbb{C}^0$. As our problem is local, we may assume that $X_1$ and $X_2$ are both complex model spaces. From the constructions, we easily reduce to the case where $X_1$ and $X_2$ are both domains in $\mathbb{C}^m$ and $\mathbb{C}^n$ respectively. In this case, the result is proved in \cref{Local-lma-Cmexistencetensor} in the Complex Analytic Local Algebras and \cref{prop-Cnlocalring}.
    
    Next we handle the case where $X_2\rightarrow Y$ is a closed immersion. This case is immediately clear from the constructions of both sides.
\end{proof}
 
\section{Complex analytic topos}

\printbibliography
\end{document}